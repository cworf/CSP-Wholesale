/* 
* jqGrid  4.6.0 - jQuery Grid 
* Copyright (c) 2008, Tony Tomov, tony@trirand.com 
* Dual licensed under the MIT or GPL licenses 
* http://www.opensource.org/licenses/mit-license.php 
* http://www.gnu.org/licenses/gpl-2.0.html 
* Date:2014-02-20 
* Modules: grid.base.js; jquery.fmatter.js; grid.custom.js; grid.common.js; grid.formedit.js; grid.filter.js; grid.inlinedit.js; grid.celledit.js; jqModal.js; jqDnR.js; grid.subgrid.js; grid.grouping.js; grid.treegrid.js; grid.pivot.js; grid.import.js; JsonXml.js; grid.tbltogrid.js; grid.jqueryui.js; 
*/
!function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){"use strict";function _pivotfilter(fn,context){var i,value,length,result=[];if(!this||"function"!=typeof fn||fn instanceof RegExp)throw new TypeError;for(length=this.length,i=0;length>i;i++)if(this.hasOwnProperty(i)&&(value=this[i],fn.call(context,value,i,this))){result.push(value);break}return result}$.jgrid=$.jgrid||{},$.jgrid.hasOwnProperty("defaults")||($.jgrid.defaults={}),$.extend($.jgrid,{version:"4.8.2",htmlDecode:function(value){return value&&("&nbsp;"===value||"&#160;"===value||1===value.length&&160===value.charCodeAt(0))?"":value?String(value).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&"):value},htmlEncode:function(value){return value?String(value).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):value},template:function(format){var j,args=$.makeArray(arguments).slice(1),al=args.length;return null==format&&(format=""),format.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(m,i){if(!isNaN(parseInt(i,10)))return args[parseInt(i,10)];for(j=0;al>j;j++)if($.isArray(args[j]))for(var nmarr=args[j],k=nmarr.length;k--;)if(i===nmarr[k].nm)return nmarr[k].v})},msie:"Microsoft Internet Explorer"===navigator.appName,msiever:function(){var rv=-1,ua=navigator.userAgent,re=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");return null!=re.exec(ua)&&(rv=parseFloat(RegExp.$1)),rv},getCellIndex:function(cell){var c=$(cell);return c.is("tr")?-1:(c=(c.is("td")||c.is("th")?c:c.closest("td,th"))[0],$.jgrid.msie?$.inArray(c,c.parentNode.cells):c.cellIndex)},stripHtml:function(v){v=String(v);var regexp=/<("[^"]*"|'[^']*'|[^'">])*>/gi;return v?(v=v.replace(regexp,""),v&&"&nbsp;"!==v&&"&#160;"!==v?v.replace(/\"/g,"'"):""):v},stripPref:function(pref,id){var obj=$.type(pref);return("string"===obj||"number"===obj)&&(pref=String(pref),id=""!==pref?String(id).replace(String(pref),""):id),id},parse:function(jsonString){var js=jsonString;return"while(1);"===js.substr(0,9)&&(js=js.substr(9)),"/*"===js.substr(0,2)&&(js=js.substr(2,js.length-4)),js||(js="{}"),$.jgrid.useJSON===!0&&"object"==typeof JSON&&"function"==typeof JSON.parse?JSON.parse(js):eval("("+js+")")},parseDate:function(format,date,newformat,opts){var dM,k,hl,token=/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,msDateRegExp=new RegExp("^/Date\\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\\)/$"),msMatch="string"==typeof date?date.match(msDateRegExp):null,pad=function(value,length){for(value=String(value),length=parseInt(length,10)||2;value.length<length;)value="0"+value;return value},ts={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},timestamp=0,h12to24=function(ampm,h){return 0===ampm?12===h&&(h=0):12!==h&&(h+=12),h},offset=0;if(void 0===opts&&(opts=$.jgrid.getRegional(this,"formatter.date")),void 0===opts.parseRe&&(opts.parseRe=/[#%\\\/:_;.,\t\s-]/),opts.masks.hasOwnProperty(format)&&(format=opts.masks[format]),date&&null!=date)if(isNaN(date-0)||"u"!==String(format).toLowerCase())if(date.constructor===Date)timestamp=date;else if(null!==msMatch)timestamp=new Date(parseInt(msMatch[1],10)),msMatch[3]&&(offset=60*Number(msMatch[5])+Number(msMatch[6]),offset*="-"===msMatch[4]?1:-1,offset-=timestamp.getTimezoneOffset(),timestamp.setTime(Number(Number(timestamp)+60*offset*1e3)));else{for("ISO8601Long"===opts.srcformat&&"Z"===date.charAt(date.length-1)&&(offset-=(new Date).getTimezoneOffset()),date=String(date).replace(/\T/g,"#").replace(/\t/,"%").split(opts.parseRe),format=format.replace(/\T/g,"#").replace(/\t/,"%").split(opts.parseRe),k=0,hl=format.length;hl>k;k++){switch(format[k]){case"M":dM=$.inArray(date[k],opts.monthNames),-1!==dM&&12>dM&&(date[k]=dM+1,ts.m=date[k]);break;case"F":dM=$.inArray(date[k],opts.monthNames,12),-1!==dM&&dM>11&&(date[k]=dM+1-12,ts.m=date[k]);break;case"n":format[k]="m";break;case"j":format[k]="d";break;case"a":dM=$.inArray(date[k],opts.AmPm),-1!==dM&&2>dM&&date[k]===opts.AmPm[dM]&&(date[k]=dM,ts.h=h12to24(date[k],ts.h));break;case"A":dM=$.inArray(date[k],opts.AmPm),-1!==dM&&dM>1&&date[k]===opts.AmPm[dM]&&(date[k]=dM-2,ts.h=h12to24(date[k],ts.h));break;case"g":ts.h=parseInt(date[k],10)}void 0!==date[k]&&(ts[format[k].toLowerCase()]=parseInt(date[k],10))}if(ts.f&&(ts.m=ts.f),0===ts.m&&0===ts.y&&0===ts.d)return"&#160;";ts.m=parseInt(ts.m,10)-1;var ty=ts.y;ty>=70&&99>=ty?ts.y=1900+ts.y:ty>=0&&69>=ty&&(ts.y=2e3+ts.y),timestamp=new Date(ts.y,ts.m,ts.d,ts.h,ts.i,ts.s,ts.u),offset>0&&timestamp.setTime(Number(Number(timestamp)+60*offset*1e3))}else timestamp=new Date(1e3*parseFloat(date));else timestamp=new Date(ts.y,ts.m,ts.d,ts.h,ts.i,ts.s,ts.u);if(opts.userLocalTime&&0===offset&&(offset-=(new Date).getTimezoneOffset(),offset>0&&timestamp.setTime(Number(Number(timestamp)+60*offset*1e3))),void 0===newformat)return timestamp;opts.masks.hasOwnProperty(newformat)?newformat=opts.masks[newformat]:newformat||(newformat="Y-m-d");var G=timestamp.getHours(),i=timestamp.getMinutes(),j=timestamp.getDate(),n=timestamp.getMonth()+1,o=timestamp.getTimezoneOffset(),s=timestamp.getSeconds(),u=timestamp.getMilliseconds(),w=timestamp.getDay(),Y=timestamp.getFullYear(),N=(w+6)%7+1,z=(new Date(Y,n-1,j)-new Date(Y,0,1))/864e5,flags={d:pad(j),D:opts.dayNames[w],j:j,l:opts.dayNames[w+7],N:N,S:opts.S(j),w:w,z:z,W:5>N?Math.floor((z+N-1)/7)+1:Math.floor((z+N-1)/7)||((new Date(Y-1,0,1).getDay()+6)%7<4?53:52),F:opts.monthNames[n-1+12],m:pad(n),M:opts.monthNames[n-1],n:n,t:"?",L:"?",o:"?",Y:Y,y:String(Y).substring(2),a:12>G?opts.AmPm[0]:opts.AmPm[1],A:12>G?opts.AmPm[2]:opts.AmPm[3],B:"?",g:G%12||12,G:G,h:pad(G%12||12),H:pad(G),i:pad(i),s:pad(s),u:u,e:"?",I:"?",O:(o>0?"-":"+")+pad(100*Math.floor(Math.abs(o)/60)+Math.abs(o)%60,4),P:"?",T:(String(timestamp).match(timezone)||[""]).pop().replace(timezoneClip,""),Z:"?",c:"?",r:"?",U:Math.floor(timestamp/1e3)};return newformat.replace(token,function($0){return flags.hasOwnProperty($0)?flags[$0]:$0.substring(1)})},jqID:function(sid){return String(sid).replace(/[!"#$%&'()*+,.\/:; <=>?@\[\\\]\^`{|}~]/g,"\\$&")},guid:1,uidPref:"jqg",randId:function(prefix){return(prefix||$.jgrid.uidPref)+$.jgrid.guid++},getAccessor:function(obj,expr){var ret,p,i,prm=[];if("function"==typeof expr)return expr(obj);if(ret=obj[expr],void 0===ret)try{if("string"==typeof expr&&(prm=expr.split(".")),i=prm.length)for(ret=obj;ret&&i--;)p=prm.shift(),ret=ret[p]}catch(e){}return ret},getXmlData:function(obj,expr,returnObj){var ret,m="string"==typeof expr?expr.match(/^(.*)\[(\w+)\]$/):null;return"function"==typeof expr?expr(obj):m&&m[2]?m[1]?$(m[1],obj).attr(m[2]):$(obj).attr(m[2]):(ret=$(expr,obj),returnObj?ret:ret.length>0?$(ret).text():void 0)},cellWidth:function(){var $testDiv=$("<div class='ui-jqgrid' style='left:10000px'><table class='ui-jqgrid-btable' style='width:5px;'><tr class='jqgrow'><td style='width:5px;display:block;'></td></tr></table></div>"),testCell=$testDiv.appendTo("body").find("td").width();return $testDiv.remove(),Math.abs(testCell-5)>.1},isLocalStorage:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}},getRegional:function(inst,param,def_val){var ret;return void 0!==def_val?def_val:(inst.p&&inst.p.regional&&$.jgrid.regional&&(ret=$.jgrid.getAccessor($.jgrid.regional[inst.p.regional]||{},param)),void 0===ret&&(ret=$.jgrid.getAccessor($.jgrid,param)),ret)},cell_width:!0,ajaxOptions:{},from:function(source){var $t=this,QueryObject=function(d,q){"string"==typeof d&&(d=$.data(d));var self=this,_data=d,_usecase=!0,_trim=!1,_query=q,_stripNum=/[\$,%]/g,_lastCommand=null,_lastField=null,_orDepth=0,_negate=!1,_queuedOperator="",_sorting=[],_useProperties=!0;if("object"!=typeof d||!d.push)throw"data provides is not an array";return d.length>0&&(_useProperties="object"!=typeof d[0]?!1:!0),this._hasData=function(){return null===_data?!1:0===_data.length?!1:!0},this._getStr=function(s){var phrase=[];return _trim&&phrase.push("jQuery.trim("),phrase.push("String("+s+")"),_trim&&phrase.push(")"),_usecase||phrase.push(".toLowerCase()"),phrase.join("")},this._strComp=function(val){return"string"==typeof val?".toString()":""},this._group=function(f,u){return{field:f.toString(),unique:u,items:[]}},this._toStr=function(phrase){return _trim&&(phrase=$.trim(phrase)),phrase=phrase.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"'),_usecase?phrase:phrase.toLowerCase()},this._funcLoop=function(func){var results=[];return $.each(_data,function(i,v){results.push(func(v))}),results},this._append=function(s){var i;for(null===_query?_query="":_query+=""===_queuedOperator?" && ":_queuedOperator,i=0;_orDepth>i;i++)_query+="(";_negate&&(_query+="!"),_query+="("+s+")",_negate=!1,_queuedOperator="",_orDepth=0},this._setCommand=function(f,c){_lastCommand=f,_lastField=c},this._resetNegate=function(){_negate=!1},this._repeatCommand=function(f,v){return null===_lastCommand?self:null!==f&&null!==v?_lastCommand(f,v):null===_lastField?_lastCommand(f):_useProperties?_lastCommand(_lastField,f):_lastCommand(f)},this._equals=function(a,b){return 0===self._compare(a,b,1)},this._compare=function(a,b,d){var toString=Object.prototype.toString;return void 0===d&&(d=1),void 0===a&&(a=null),void 0===b&&(b=null),null===a&&null===b?0:null===a&&null!==b?1:null!==a&&null===b?-1:"[object Date]"===toString.call(a)&&"[object Date]"===toString.call(b)?b>a?-d:a>b?d:0:(_usecase||"number"==typeof a||"number"==typeof b||(a=String(a),b=String(b)),b>a?-d:a>b?d:0)},this._performSort=function(){0!==_sorting.length&&(_data=self._doSort(_data,0))},this._doSort=function(d,q){var by=_sorting[q].by,dir=_sorting[q].dir,type=_sorting[q].type,dfmt=_sorting[q].datefmt,sfunc=_sorting[q].sfunc;if(q===_sorting.length-1)return self._getOrder(d,by,dir,type,dfmt,sfunc);q++;var i,j,sorted,values=self._getGroup(d,by,dir,type,dfmt),results=[];for(i=0;i<values.length;i++)for(sorted=self._doSort(values[i].items,q),j=0;j<sorted.length;j++)results.push(sorted[j]);return results},this._getOrder=function(data,by,dir,type,dfmt,sfunc){var i,ab,j,findSortKey,sortData=[],_sortData=[],newDir="a"===dir?1:-1;void 0===type&&(type="text"),findSortKey="float"===type||"number"===type||"currency"===type||"numeric"===type?function($cell){var key=parseFloat(String($cell).replace(_stripNum,""));return isNaN(key)?Number.NEGATIVE_INFINITY:key}:"int"===type||"integer"===type?function($cell){return $cell?parseFloat(String($cell).replace(_stripNum,"")):Number.NEGATIVE_INFINITY}:"date"===type||"datetime"===type?function($cell){return $.jgrid.parseDate.call($t,dfmt,$cell).getTime()}:$.isFunction(type)?type:function($cell){return $cell=$cell?$.trim(String($cell)):"",_usecase?$cell:$cell.toLowerCase()},$.each(data,function(i,v){ab=""!==by?$.jgrid.getAccessor(v,by):v,void 0===ab&&(ab=""),ab=findSortKey(ab,v),_sortData.push({vSort:ab,index:i})}),_sortData.sort($.isFunction(sfunc)?function(a,b){return a=a.vSort,b=b.vSort,sfunc.call(this,a,b,newDir)}:function(a,b){return a=a.vSort,b=b.vSort,self._compare(a,b,newDir)}),j=0;for(var nrec=data.length;nrec>j;)i=_sortData[j].index,sortData.push(data[i]),j++;return sortData},this._getGroup=function(data,by,dir,type,dfmt){var val,results=[],group=null,last=null;return $.each(self._getOrder(data,by,dir,type,dfmt),function(i,v){val=$.jgrid.getAccessor(v,by),null==val&&(val=""),self._equals(last,val)||(last=val,null!==group&&results.push(group),group=self._group(by,val)),group.items.push(v)}),null!==group&&results.push(group),results},this.ignoreCase=function(){return _usecase=!1,self},this.useCase=function(){return _usecase=!0,self},this.trim=function(){return _trim=!0,self},this.noTrim=function(){return _trim=!1,self},this.execute=function(){var match=_query,results=[];return null===match?self:($.each(_data,function(){eval(match)&&results.push(this)}),_data=results,self)},this.data=function(){return _data},this.select=function(f){if(self._performSort(),!self._hasData())return[];if(self.execute(),$.isFunction(f)){var results=[];return $.each(_data,function(i,v){results.push(f(v))}),results}return _data},this.hasMatch=function(){return self._hasData()?(self.execute(),_data.length>0):!1},this.andNot=function(f,v,x){return _negate=!_negate,self.and(f,v,x)},this.orNot=function(f,v,x){return _negate=!_negate,self.or(f,v,x)},this.not=function(f,v,x){return self.andNot(f,v,x)},this.and=function(f,v,x){return _queuedOperator=" && ",void 0===f?self:self._repeatCommand(f,v,x)},this.or=function(f,v,x){return _queuedOperator=" || ",void 0===f?self:self._repeatCommand(f,v,x)},this.orBegin=function(){return _orDepth++,self},this.orEnd=function(){return null!==_query&&(_query+=")"),self},this.isNot=function(f){return _negate=!_negate,self.is(f)},this.is=function(f){return self._append("this."+f),self._resetNegate(),self},this._compareValues=function(func,f,v,how,t){var fld;fld=_useProperties?"jQuery.jgrid.getAccessor(this,'"+f+"')":"this",void 0===v&&(v=null);var val=v,swst=void 0===t.stype?"text":t.stype;if(null!==v)switch(swst){case"int":case"integer":val=isNaN(Number(val))||""===val?"0":val,fld="parseInt("+fld+",10)",val="parseInt("+val+",10)";break;case"float":case"number":case"numeric":val=String(val).replace(_stripNum,""),val=isNaN(Number(val))||""===val?"0":val,fld="parseFloat("+fld+")",val="parseFloat("+val+")";break;case"date":case"datetime":val=String($.jgrid.parseDate.call($t,t.srcfmt||"Y-m-d",val).getTime()),fld='jQuery.jgrid.parseDate.call(jQuery("#'+$.jgrid.jqID($t.p.id)+'")[0],"'+t.srcfmt+'",'+fld+").getTime()";break;default:fld=self._getStr(fld),val=self._getStr('"'+self._toStr(val)+'"')}return self._append(fld+" "+how+" "+val),self._setCommand(func,f),self._resetNegate(),self},this.equals=function(f,v,t){return self._compareValues(self.equals,f,v,"==",t)},this.notEquals=function(f,v,t){return self._compareValues(self.equals,f,v,"!==",t)},this.isNull=function(f,v,t){return self._compareValues(self.equals,f,null,"===",t)},this.greater=function(f,v,t){return self._compareValues(self.greater,f,v,">",t)},this.less=function(f,v,t){return self._compareValues(self.less,f,v,"<",t)},this.greaterOrEquals=function(f,v,t){return self._compareValues(self.greaterOrEquals,f,v,">=",t)},this.lessOrEquals=function(f,v,t){return self._compareValues(self.lessOrEquals,f,v,"<=",t)},this.startsWith=function(f,v){var val=null==v?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;return _useProperties?self._append(self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(v)+'"')):(null!=v&&(length=_trim?$.trim(v.toString()).length:v.toString().length),self._append(self._getStr("this")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(f)+'"'))),self._setCommand(self.startsWith,f),self._resetNegate(),self},this.endsWith=function(f,v){var val=null==v?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;return self._append(_useProperties?self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+".substr("+self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+".length-"+length+","+length+') == "'+self._toStr(v)+'"':self._getStr("this")+".substr("+self._getStr("this")+'.length-"'+self._toStr(f)+'".length,"'+self._toStr(f)+'".length) == "'+self._toStr(f)+'"'),self._setCommand(self.endsWith,f),self._resetNegate(),self},this.contains=function(f,v){return self._append(_useProperties?self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+'.indexOf("'+self._toStr(v)+'",0) > -1':self._getStr("this")+'.indexOf("'+self._toStr(f)+'",0) > -1'),self._setCommand(self.contains,f),self._resetNegate(),self},this.groupBy=function(by,dir,type,datefmt){return self._hasData()?self._getGroup(_data,by,dir,type,datefmt):null},this.orderBy=function(by,dir,stype,dfmt,sfunc){return dir=null==dir?"a":$.trim(dir.toString().toLowerCase()),null==stype&&(stype="text"),null==dfmt&&(dfmt="Y-m-d"),null==sfunc&&(sfunc=!1),("desc"===dir||"descending"===dir)&&(dir="d"),("asc"===dir||"ascending"===dir)&&(dir="a"),_sorting.push({by:by,dir:dir,type:stype,datefmt:dfmt,sfunc:sfunc}),self},self};return new QueryObject(source,null)},getMethod:function(name){return this.getAccessor($.fn.jqGrid,name)},extend:function(methods){$.extend($.fn.jqGrid,methods),this.no_legacy_api||$.fn.extend(methods)},clearBeforeUnload:function(jqGridId){var grid,$t=$("#"+$.jgrid.jqID(jqGridId))[0];if($t.grid){grid=$t.grid,$.isFunction(grid.emptyRows)&&grid.emptyRows.call($t,!0,!0),$(document).unbind("mouseup.jqGrid"+$t.p.id),$(grid.hDiv).unbind("mousemove"),$($t).unbind();var i,l=grid.headers.length,removevents=["formatCol","sortData","updatepager","refreshIndex","setHeadCheckBox","constructTr","formatter","addXmlData","addJSONData","grid","p"];for(i=0;l>i;i++)grid.headers[i].el=null;for(i in grid)grid.hasOwnProperty(i)&&(grid[i]=null);for(i in $t.p)$t.p.hasOwnProperty(i)&&($t.p[i]=$.isArray($t.p[i])?[]:null);for(l=removevents.length,i=0;l>i;i++)$t.hasOwnProperty(removevents[i])&&($t[removevents[i]]=null,delete $t[removevents[i]])}},gridUnload:function(jqGridId){if(jqGridId){jqGridId=$.trim(jqGridId),0===jqGridId.indexOf("#")&&(jqGridId=jqGridId.substring(1));var $t=$("#"+$.jgrid.jqID(jqGridId))[0];if($t.grid){var defgrid={id:$($t).attr("id"),cl:$($t).attr("class")};$t.p.pager&&$($t.p.pager).unbind().empty().removeClass("ui-state-default ui-jqgrid-pager ui-corner-bottom");var newtable=document.createElement("table");newtable.className=defgrid.cl;var gid=$.jgrid.jqID($t.id);$(newtable).removeClass("ui-jqgrid-btable").insertBefore("#gbox_"+gid),1===$($t.p.pager).parents("#gbox_"+gid).length&&$($t.p.pager).insertBefore("#gbox_"+gid),$.jgrid.clearBeforeUnload(jqGridId),$("#gbox_"+gid).remove(),$(newtable).attr({id:defgrid.id}),$("#alertmod_"+$.jgrid.jqID(jqGridId)).remove()}}},gridDestroy:function(jqGridId){if(jqGridId){jqGridId=$.trim(jqGridId),0===jqGridId.indexOf("#")&&(jqGridId=jqGridId.substring(1));var $t=$("#"+$.jgrid.jqID(jqGridId))[0];if($t.grid){$t.p.pager&&$($t.p.pager).remove();try{$.jgrid.clearBeforeUnload(jqGridId),$("#gbox_"+$.jgrid.jqID(jqGridId)).remove()}catch(_){}}}}}),$.fn.jqGrid=function(pin){if("string"==typeof pin){var fn=$.jgrid.getMethod(pin);if(!fn)throw"jqGrid - No such method: "+pin;var args=$.makeArray(arguments).slice(1);return fn.apply(this,args)}return this.each(function(){if(!this.grid){var localData;null!=pin&&void 0!==pin.data&&(localData=pin.data,pin.data=[]);var p=$.extend(!0,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:!0,pginput:!0,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:!1,selarrrow:[],savedRow:[],shrinkToFit:!0,xmlReader:{},jsonReader:{},subGrid:!1,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,onInitGrid:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,beforeProcessing:null,onHeaderClick:null,viewrecords:!1,loadonce:!1,multiselect:!1,multikey:!1,editurl:null,search:!1,caption:"",hidegrid:!0,hiddengrid:!1,postData:{},userData:{},treeGrid:!1,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:!1,gridstate:"visible",cellEdit:!1,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[!1,""],scroll:!1,multiboxonly:!1,deselectAfterSort:!0,scrollrows:!1,autowidth:!1,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:!0,rownumWidth:25,rownumbers:!1,pagerpos:"center",recordpos:"right",footerrow:!1,userDataOnFooter:!1,hoverrows:!0,altclass:"ui-priority-secondary",viewsortcols:[!1,"vertical",!0],resizeclass:"",autoencode:!1,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:!1,headertitles:!1,scrollTimeout:40,data:[],_index:{},grouping:!1,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:!1,sortitems:[],sortnames:[],summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus",displayField:[],groupSummaryPos:[],formatDisplayField:[],_locgr:!1},ignoreCase:!0,cmTemplate:{},idPrefix:"",multiSort:!1,minColWidth:33,scrollPopUp:!1,scrollTopOffset:0,scrollLeftOffset:"100%",storeNavOptions:!1,regional:"en"},$.jgrid.defaults,pin);void 0!==localData&&(p.data=localData,pin.data=localData);var ts=this,grid={headers:[],cols:[],footers:[],dragStart:function(i,x,y){var gridLeftPos=$(this.bDiv).offset().left;this.resizing={idx:i,startX:x.pageX,sOL:x.pageX-gridLeftPos},this.hDiv.style.cursor="col-resize",this.curGbox=$("#rs_m"+$.jgrid.jqID(p.id),"#gbox_"+$.jgrid.jqID(p.id)),this.curGbox.css({display:"block",left:x.pageX-gridLeftPos,top:y[1],height:y[2]}),$(ts).triggerHandler("jqGridResizeStart",[x,i]),$.isFunction(p.resizeStart)&&p.resizeStart.call(ts,x,i),document.onselectstart=function(){return!1}},dragMove:function(x){if(this.resizing){var hn,nWn,diff=x.pageX-this.resizing.startX,h=this.headers[this.resizing.idx],newWidth="ltr"===p.direction?h.width+diff:h.width-diff;newWidth>33&&(this.curGbox.css({left:this.resizing.sOL+diff}),p.forceFit===!0?(hn=this.headers[this.resizing.idx+p.nv],nWn="ltr"===p.direction?hn.width-diff:hn.width+diff,nWn>p.minColWidth&&(h.newWidth=newWidth,hn.newWidth=nWn)):(this.newWidth="ltr"===p.direction?p.tblwidth+diff:p.tblwidth-diff,h.newWidth=newWidth))}},dragEnd:function(){if(this.hDiv.style.cursor="default",this.resizing){var idx=this.resizing.idx,nw=this.headers[idx].newWidth||this.headers[idx].width;nw=parseInt(nw,10),this.resizing=!1,$("#rs_m"+$.jgrid.jqID(p.id)).css("display","none"),p.colModel[idx].width=nw,this.headers[idx].width=nw,this.headers[idx].el.style.width=nw+"px",this.cols[idx].style.width=nw+"px",this.footers.length>0&&(this.footers[idx].style.width=nw+"px"),p.forceFit===!0?(nw=this.headers[idx+p.nv].newWidth||this.headers[idx+p.nv].width,this.headers[idx+p.nv].width=nw,this.headers[idx+p.nv].el.style.width=nw+"px",this.cols[idx+p.nv].style.width=nw+"px",this.footers.length>0&&(this.footers[idx+p.nv].style.width=nw+"px"),p.colModel[idx+p.nv].width=nw):(p.tblwidth=this.newWidth||p.tblwidth,$("table:first",this.bDiv).css("width",p.tblwidth+"px"),$("table:first",this.hDiv).css("width",p.tblwidth+"px"),this.hDiv.scrollLeft=this.bDiv.scrollLeft,p.footerrow&&($("table:first",this.sDiv).css("width",p.tblwidth+"px"),this.sDiv.scrollLeft=this.bDiv.scrollLeft)),$(ts).triggerHandler("jqGridResizeStop",[nw,idx]),$.isFunction(p.resizeStop)&&p.resizeStop.call(ts,nw,idx)}this.curGbox=null,document.onselectstart=function(){return!0}},populateVisible:function(){grid.timer&&clearTimeout(grid.timer),grid.timer=null;var dh=$(grid.bDiv).height();if(dh){var rows,rh,table=$("table:first",grid.bDiv);if(table[0].rows.length)try{rows=table[0].rows[1],rh=rows?$(rows).outerHeight()||grid.prevRowHeight:grid.prevRowHeight}catch(pv){rh=grid.prevRowHeight}if(rh){grid.prevRowHeight=rh;var page,npage,empty,rn=p.rowNum,scrollTop=grid.scrollTop=grid.bDiv.scrollTop,ttop=Math.round(table.position().top)-scrollTop,tbot=ttop+table.height(),div=rh*rn;if(dh>tbot&&0>=ttop&&(void 0===p.lastpage||(parseInt((tbot+scrollTop+div-1)/div,10)||0)<=p.lastpage)&&(npage=parseInt((dh-tbot+div-1)/div,10)||1,tbot>=0||2>npage||p.scroll===!0?(page=(Math.round((tbot+scrollTop)/div)||0)+1,ttop=-1):ttop=1),ttop>0&&(page=(parseInt(scrollTop/div,10)||0)+1,npage=(parseInt((scrollTop+dh)/div,10)||0)+2-page,empty=!0),npage){if(p.lastpage&&(page>p.lastpage||1===p.lastpage||page===p.page&&page===p.lastpage))return;grid.hDiv.loading?grid.timer=setTimeout(grid.populateVisible,p.scrollTimeout):(p.page=page,empty&&(grid.selectionPreserver(table[0]),grid.emptyRows.call(table[0],!1,!1)),grid.populate(npage)),p.scrollPopUp&&null!=p.lastpage&&($("#scroll_g"+p.id).show().html($.jgrid.template($.jgrid.getRegional(ts,"defaults.pgtext",p.pgtext),p.page,p.lastpage)).css({top:p.scrollTopOffset+scrollTop*((parseInt(p.height,10)-45)/(parseInt(rh,10)*parseInt(p.records,10)))+"px",left:p.scrollLeftOffset}),$(this).mouseout(function(){$("#scroll_g"+p.id).hide()}))}}}},scrollGrid:function(e){if(p.scroll){var scrollTop=grid.bDiv.scrollTop;void 0===grid.scrollTop&&(grid.scrollTop=0),scrollTop!==grid.scrollTop&&(grid.scrollTop=scrollTop,grid.timer&&clearTimeout(grid.timer),grid.timer=setTimeout(grid.populateVisible,p.scrollTimeout))}grid.hDiv.scrollLeft=grid.bDiv.scrollLeft,p.footerrow&&(grid.sDiv.scrollLeft=grid.bDiv.scrollLeft),e&&e.stopPropagation()},selectionPreserver:function(ts){var p=ts.p,sr=p.selrow,sra=p.selarrrow?$.makeArray(p.selarrrow):null,left=ts.grid.bDiv.scrollLeft,restoreSelection=function(){var i;if(p.selrow=null,p.selarrrow=[],p.multiselect&&sra&&sra.length>0)for(i=0;i<sra.length;i++)sra[i]!==sr&&$(ts).jqGrid("setSelection",sra[i],!1,null);sr&&$(ts).jqGrid("setSelection",sr,!1,null),ts.grid.bDiv.scrollLeft=left,$(ts).unbind(".selectionPreserver",restoreSelection)};$(ts).bind("jqGridGridComplete.selectionPreserver",restoreSelection)}};if("TABLE"!==this.tagName.toUpperCase()||null==this.id)return void alert("Element is not a table or has no id!");if(void 0!==document.documentMode&&document.documentMode<=5)return void alert("Grid can not be used in this ('quirks') mode!");$(this).empty().attr("tabindex","0"),this.p=p,this.p.useProp=!!$.fn.prop;var i,dir;if(0===this.p.colNames.length)for(i=0;i<this.p.colModel.length;i++)this.p.colNames[i]=this.p.colModel[i].label||this.p.colModel[i].name;if(this.p.colNames.length!==this.p.colModel.length)return void alert($.jgrid.getRegional(this,"errors.model"));var gv=$("<div class='ui-jqgrid-view' role='grid'></div>"),isMSIE=$.jgrid.msie;ts.p.direction=$.trim(ts.p.direction.toLowerCase()),ts.p._ald=!1,-1===$.inArray(ts.p.direction,["ltr","rtl"])&&(ts.p.direction="ltr"),dir=ts.p.direction,$(gv).insertBefore(this),$(this).removeClass("scroll").appendTo(gv);var eg=$("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");$(eg).attr({id:"gbox_"+this.id,dir:dir}).insertBefore(gv),$(gv).attr("id","gview_"+this.id).appendTo(eg),$("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").insertBefore(gv),$("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+$.jgrid.getRegional(ts,"defaults.loadtext",this.p.loadtext)+"</div>").insertBefore(gv),$(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"presentation","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var colTemplate,sortkeys=["shiftKey","altKey","ctrlKey"],intNum=function(val,defval){return val=parseInt(val,10),isNaN(val)?defval||0:val},formatCol=function(pos,rowInd,tv,rawObject,rowId,rdata){var cellAttrFunc,celp,cm=ts.p.colModel[pos],ral=cm.align,result='style="',clas=cm.classes,nm=cm.name,acp=[];return ral&&(result+="text-align:"+ral+";"),cm.hidden===!0&&(result+="display:none;"),0===rowInd?result+="width: "+grid.headers[pos].width+"px;":($.isFunction(cm.cellattr)||"string"==typeof cm.cellattr&&null!=$.jgrid.cellattr&&$.isFunction($.jgrid.cellattr[cm.cellattr]))&&(cellAttrFunc=$.isFunction(cm.cellattr)?cm.cellattr:$.jgrid.cellattr[cm.cellattr],celp=cellAttrFunc.call(ts,rowId,tv,rawObject,cm,rdata),celp&&"string"==typeof celp&&(celp=celp.replace(/style/i,"style").replace(/title/i,"title"),celp.indexOf("title")>-1&&(cm.title=!1),celp.indexOf("class")>-1&&(clas=void 0),acp=celp.replace(/\-style/g,"-sti").split(/style/),2===acp.length?(acp[1]=$.trim(acp[1].replace(/\-sti/g,"-style").replace("=","")),(0===acp[1].indexOf("'")||0===acp[1].indexOf('"'))&&(acp[1]=acp[1].substring(1)),result+=acp[1].replace(/'/gi,'"')):result+='"')),acp.length||(acp[0]="",result+='"'),result+=(void 0!==clas?' class="'+clas+'"':"")+(cm.title&&tv?' title="'+$.jgrid.stripHtml(tv)+'"':""),result+=' aria-describedby="'+ts.p.id+"_"+nm+'"',result+acp[0]},cellVal=function(val){return null==val||""===val?"&#160;":ts.p.autoencode?$.jgrid.htmlEncode(val):String(val)},formatter=function(rowId,cellval,colpos,rwdat,_act){var v,cm=ts.p.colModel[colpos];if(void 0!==cm.formatter){rowId=""!==String(ts.p.idPrefix)?$.jgrid.stripPref(ts.p.idPrefix,rowId):rowId;var opts={rowId:rowId,colModel:cm,gid:ts.p.id,pos:colpos};v=$.isFunction(cm.formatter)?cm.formatter.call(ts,cellval,opts,rwdat,_act):$.fmatter?$.fn.fmatter.call(ts,cm.formatter,cellval,opts,rwdat,_act):cellVal(cellval)}else v=cellVal(cellval);return v},addCell=function(rowId,cell,pos,irow,srvr,rdata){var v,prp;return v=formatter(rowId,cell,pos,srvr,"add"),prp=formatCol(pos,irow,v,srvr,rowId,rdata),'<td role="gridcell" '+prp+">"+v+"</td>"},addMulti=function(rowid,pos,irow,checked){var v='<input role="checkbox" type="checkbox" id="jqg_'+ts.p.id+"_"+rowid+'" class="cbox" name="jqg_'+ts.p.id+"_"+rowid+'"'+(checked?'checked="checked"':"")+"/>",prp=formatCol(pos,irow,"",null,rowid,!0);return'<td role="gridcell" '+prp+">"+v+"</td>"},addRowNum=function(pos,irow,pG,rN){var v=(parseInt(pG,10)-1)*parseInt(rN,10)+1+irow,prp=formatCol(pos,irow,v,null,irow,!0);return'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+prp+">"+v+"</td>"},reader=function(datatype){var field,i,f=[],j=0;for(i=0;i<ts.p.colModel.length;i++)field=ts.p.colModel[i],"cb"!==field.name&&"subgrid"!==field.name&&"rn"!==field.name&&(f[j]="local"===datatype?field.name:"xml"===datatype||"xmlstring"===datatype?field.xmlmap||field.name:field.jsonmap||field.name,ts.p.keyName!==!1&&field.key===!0&&(ts.p.keyName=f[j]),j++);return f},orderedCols=function(offset){var order=ts.p.remapColumns;return order&&order.length||(order=$.map(ts.p.colModel,function(v,i){return i})),offset&&(order=$.map(order,function(v){return offset>v?null:v-offset})),order},emptyRows=function(scroll,locdata){var firstrow;this.p.deepempty?$(this.rows).slice(1).remove():(firstrow=this.rows.length>0?this.rows[0]:null,$(this.firstChild).empty().append(firstrow)),scroll&&this.p.scroll&&($(this.grid.bDiv.firstChild).css({height:"auto"}),$(this.grid.bDiv.firstChild.firstChild).css({height:0,display:"none"}),0!==this.grid.bDiv.scrollTop&&(this.grid.bDiv.scrollTop=0)),locdata!==!0||this.p.loadonce||(this.p.data=[],this.p._index={})},normalizeData=function(){var i,j,cur,idn,idr,ccur,v,rd,arrayReader,objectReader,rowReader,p=ts.p,data=p.data,dataLength=data.length,localReader=p.localReader,colModel=p.colModel,cellName=localReader.cell,iOffset=(p.multiselect===!0?1:0)+(p.subGrid===!0?1:0)+(p.rownumbers===!0?1:0),br=p.scroll?$.jgrid.randId():1;if("local"===p.datatype&&localReader.repeatitems===!0)for(arrayReader=orderedCols(iOffset),objectReader=reader("local"),idn=p.keyIndex===!1?$.isFunction(localReader.id)?localReader.id.call(ts,data):localReader.id:p.keyIndex,i=0;dataLength>i;i++){for(cur=data[i],idr=$.jgrid.getAccessor(cur,idn),void 0===idr&&("number"==typeof idn&&null!=colModel[idn+iOffset]&&(idr=$.jgrid.getAccessor(cur,colModel[idn+iOffset].name)),void 0===idr&&(idr=br+i,cellName&&(ccur=$.jgrid.getAccessor(cur,cellName)||cur,idr=null!=ccur&&void 0!==ccur[idn]?ccur[idn]:idr,ccur=null))),rd={},rd[localReader.id]=idr,cellName&&(cur=$.jgrid.getAccessor(cur,cellName)||cur),rowReader=$.isArray(cur)?arrayReader:objectReader,j=0;j<rowReader.length;j++)v=$.jgrid.getAccessor(cur,rowReader[j]),rd[colModel[j+iOffset].name]=v;$.extend(!0,data[i],rd)}},refreshIndex=function(){var idname,i,val,datalen=ts.p.data.length;for(idname=ts.p.keyName===!1||ts.p.loadonce===!0?ts.p.localReader.id:ts.p.keyName,ts.p._index=[],i=0;datalen>i;i++)val=$.jgrid.getAccessor(ts.p.data[i],idname),void 0===val&&(val=String(i+1)),ts.p._index[val]=i},constructTr=function(id,hide,altClass,rd,cur,selected){var attrName,tabindex="-1",restAttr="",style=hide?"display:none;":"",classes="ui-widget-content jqgrow ui-row-"+ts.p.direction+(altClass?" "+altClass:"")+(selected?" ui-state-highlight":""),rowAttrObj=$(ts).triggerHandler("jqGridRowAttr",[rd,cur,id]);

if("object"!=typeof rowAttrObj&&(rowAttrObj=$.isFunction(ts.p.rowattr)?ts.p.rowattr.call(ts,rd,cur,id):"string"==typeof ts.p.rowattr&&null!=$.jgrid.rowattr&&$.isFunction($.jgrid.rowattr[ts.p.rowattr])?$.jgrid.rowattr[ts.p.rowattr].call(ts,rd,cur,id):{}),!$.isEmptyObject(rowAttrObj)){rowAttrObj.hasOwnProperty("id")&&(id=rowAttrObj.id,delete rowAttrObj.id),rowAttrObj.hasOwnProperty("tabindex")&&(tabindex=rowAttrObj.tabindex,delete rowAttrObj.tabindex),rowAttrObj.hasOwnProperty("style")&&(style+=rowAttrObj.style,delete rowAttrObj.style),rowAttrObj.hasOwnProperty("class")&&(classes+=" "+rowAttrObj["class"],delete rowAttrObj["class"]);try{delete rowAttrObj.role}catch(ra){}for(attrName in rowAttrObj)rowAttrObj.hasOwnProperty(attrName)&&(restAttr+=" "+attrName+"="+rowAttrObj[attrName])}return'<tr role="row" id="'+id+'" tabindex="'+tabindex+'" class="'+classes+'"'+(""===style?"":' style="'+style+'"')+restAttr+">"},addXmlData=function(xml,rcnt,more,adjust){var startReq=new Date,locdata="local"!==ts.p.datatype&&ts.p.loadonce||"xmlstring"===ts.p.datatype,xmlid="_id_",xmlRd=ts.p.xmlReader,frd="local"===ts.p.datatype?"local":"xml";if(locdata&&(ts.p.data=[],ts.p._index={},ts.p.localReader.id=xmlid),ts.p.reccount=0,$.isXMLDoc(xml)){-1!==ts.p.treeANode||ts.p.scroll?rcnt=rcnt>1?rcnt:1:(emptyRows.call(ts,!1,!0),rcnt=1);var i,fpos,v,addSubGridCell,idn,getId,F,xmlr,rid,cn1,self=$(ts),ir=0,gi=ts.p.multiselect===!0?1:0,si=0,ni=ts.p.rownumbers===!0?1:0,f=[],rd={},rowData=[],cn=ts.p.altRows===!0?ts.p.altclass:"";ts.p.subGrid===!0&&(si=1,addSubGridCell=$.jgrid.getMethod("addSubGridCell")),xmlRd.repeatitems||(f=reader(frd)),idn=ts.p.keyName===!1?$.isFunction(xmlRd.id)?xmlRd.id.call(ts,xml):xmlRd.id:ts.p.keyName,getId=-1===String(idn).indexOf("[")?f.length?function(trow,k){return $(idn,trow).text()||k}:function(trow,k){return $(xmlRd.cell,trow).eq(idn).text()||k}:function(trow,k){return trow.getAttribute(idn.replace(/[\[\]]/g,""))||k},ts.p.userData={},ts.p.page=intNum($.jgrid.getXmlData(xml,xmlRd.page),ts.p.page),ts.p.lastpage=intNum($.jgrid.getXmlData(xml,xmlRd.total),1),ts.p.records=intNum($.jgrid.getXmlData(xml,xmlRd.records)),$.isFunction(xmlRd.userdata)?ts.p.userData=xmlRd.userdata.call(ts,xml)||{}:$.jgrid.getXmlData(xml,xmlRd.userdata,!0).each(function(){ts.p.userData[this.getAttribute("name")]=$(this).text()});var gxml=$.jgrid.getXmlData(xml,xmlRd.root,!0);gxml=$.jgrid.getXmlData(gxml,xmlRd.row,!0),gxml||(gxml=[]);var altr,gl=gxml.length,j=0,grpdata=[],rn=parseInt(ts.p.rowNum,10),br=ts.p.scroll?$.jgrid.randId():1;if(gl>0&&ts.p.page<=0&&(ts.p.page=1),gxml&&gl){adjust&&(rn*=adjust+1);var groupingPrepare,afterInsRow=$.isFunction(ts.p.afterInsertRow),hiderow=!1;for(ts.p.grouping&&(hiderow=ts.p.groupingView.groupCollapse===!0,groupingPrepare=$.jgrid.getMethod("groupingPrepare"));gl>j;){xmlr=gxml[j],rid=getId(xmlr,br+j),rid=ts.p.idPrefix+rid,altr=0===rcnt?0:rcnt+1,cn1=(altr+j)%2===1?cn:"";var iStartTrTag=rowData.length;if(rowData.push(""),ni&&rowData.push(addRowNum(0,j,ts.p.page,ts.p.rowNum)),gi&&rowData.push(addMulti(rid,ni,j,!1)),si&&rowData.push(addSubGridCell.call(self,gi+ni,j+rcnt)),xmlRd.repeatitems){F||(F=orderedCols(gi+si+ni));var cells=$.jgrid.getXmlData(xmlr,xmlRd.cell,!0);$.each(F,function(k){var cell=cells[this];return cell?(v=cell.textContent||cell.text,rd[ts.p.colModel[k+gi+si+ni].name]=v,void rowData.push(addCell(rid,v,k+gi+si+ni,j+rcnt,xmlr,rd))):!1})}else for(i=0;i<f.length;i++)v=$.jgrid.getXmlData(xmlr,f[i]),rd[ts.p.colModel[i+gi+si+ni].name]=v,rowData.push(addCell(rid,v,i+gi+si+ni,j+rcnt,xmlr,rd));if(rowData[iStartTrTag]=constructTr(rid,hiderow,cn1,rd,xmlr,!1),rowData.push("</tr>"),ts.p.grouping&&(grpdata.push(rowData),ts.p.groupingView._locgr||groupingPrepare.call(self,rd,j),rowData=[]),locdata&&(rd[xmlid]=$.jgrid.stripPref(ts.p.idPrefix,rid),ts.p.data.push(rd),ts.p._index[rd[xmlid]]=ts.p.data.length-1),ts.p.gridview===!1&&($("tbody:first",ts.grid.bDiv).append(rowData.join("")),self.triggerHandler("jqGridAfterInsertRow",[rid,rd,xmlr]),afterInsRow&&ts.p.afterInsertRow.call(ts,rid,rd,xmlr),rowData=[]),rd={},ir++,j++,ir===rn)break}}if(ts.p.gridview===!0&&(fpos=ts.p.treeANode>-1?ts.p.treeANode:0,ts.p.grouping?locdata||(self.jqGrid("groupingRender",grpdata,ts.p.colModel.length,ts.p.page,rn),grpdata=null):ts.p.treeGrid===!0&&fpos>0?$(ts.rows[fpos]).after(rowData.join("")):(ts.firstElementChild?ts.firstElementChild.innerHTML+=rowData.join(""):$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").append(rowData.join("")),ts.grid.cols=ts.rows[0].cells)),ts.p.subGrid===!0)try{self.jqGrid("addSubGrid",gi+ni)}catch(_){}if(ts.p.totaltime=new Date-startReq,ir>0&&0===ts.p.records&&(ts.p.records=gl),rowData=null,ts.p.treeGrid===!0){var last_pos=ts.p.page*limit,start_pos=last_pos-limit;last_pos>ts.p.records&&(last_pos=start_pos+(ts.p.records-start_pos)),console.debug("TREE limit",limit),console.debug("TREE ts.p.records",ts.p.records),console.debug("TREE start_pos",start_pos),console.debug("TREE last_pos",last_pos);try{self.jqGrid("setTreeNode",start_pos+1,last_pos+1)}catch(e){}}if(ts.p.reccount=ir,ts.p.treeANode=-1,ts.p.userDataOnFooter&&self.jqGrid("footerData","set",ts.p.userData,!0),locdata&&(ts.p.records=gl,ts.p.lastpage=Math.ceil(gl/rn)),more||ts.updatepager(!1,!0),locdata){for(;gl>ir;){if(xmlr=gxml[ir],rid=getId(xmlr,ir+br),rid=ts.p.idPrefix+rid,xmlRd.repeatitems){F||(F=orderedCols(gi+si+ni));var cells2=$.jgrid.getXmlData(xmlr,xmlRd.cell,!0);$.each(F,function(k){var cell=cells2[this];return cell?(v=cell.textContent||cell.text,void(rd[ts.p.colModel[k+gi+si+ni].name]=v)):!1})}else for(i=0;i<f.length;i++)v=$.jgrid.getXmlData(xmlr,f[i]),rd[ts.p.colModel[i+gi+si+ni].name]=v;rd[xmlid]=$.jgrid.stripPref(ts.p.idPrefix,rid),ts.p.grouping&&groupingPrepare.call(self,rd,ir),ts.p.data.push(rd),ts.p._index[rd[xmlid]]=ts.p.data.length-1,rd={},ir++}ts.p.grouping&&(ts.p.groupingView._locgr=!0,self.jqGrid("groupingRender",grpdata,ts.p.colModel.length,ts.p.page,rn),grpdata=null)}}},addJSONData=function(data,rcnt,more,adjust){var startReq=new Date;if(data){-1!==ts.p.treeANode||ts.p.scroll?rcnt=rcnt>1?rcnt:1:(emptyRows.call(ts,!1,!0),rcnt=1);var dReader,frd,locid="_id_",locdata="local"!==ts.p.datatype&&ts.p.loadonce||"jsonstring"===ts.p.datatype;locdata&&(ts.p.data=[],ts.p._index={},ts.p.localReader.id=locid),ts.p.reccount=0,"local"===ts.p.datatype?(dReader=ts.p.localReader,frd="local"):(dReader=ts.p.jsonReader,frd="json");var v,i,j,cur,addSubGridCell,rowReader,len,drows,idn,fpos,idr,cn1,self=$(ts),ir=0,f=[],gi=ts.p.multiselect?1:0,si=ts.p.subGrid===!0?1:0,ni=ts.p.rownumbers===!0?1:0,arrayReader=orderedCols(gi+si+ni),objectReader=reader(frd),rd={},rowData=[],cn=ts.p.altRows===!0?ts.p.altclass:"";ts.p.page=intNum($.jgrid.getAccessor(data,dReader.page),ts.p.page),ts.p.lastpage=intNum($.jgrid.getAccessor(data,dReader.total),1),ts.p.records=intNum($.jgrid.getAccessor(data,dReader.records)),ts.p.userData=$.jgrid.getAccessor(data,dReader.userdata)||{},si&&(addSubGridCell=$.jgrid.getMethod("addSubGridCell")),idn=ts.p.keyName===!1?$.isFunction(dReader.id)?dReader.id.call(ts,data):dReader.id:ts.p.keyName,drows=$.jgrid.getAccessor(data,dReader.root),null==drows&&$.isArray(data)&&(drows=data),drows||(drows=[]),len=drows.length,i=0,len>0&&ts.p.page<=0&&(ts.p.page=1);var altr,selr,rn=parseInt(ts.p.rowNum,10),br=ts.p.scroll?$.jgrid.randId():1,selected=!1;adjust&&(rn*=adjust+1),"local"!==ts.p.datatype||ts.p.deselectAfterSort||(selected=!0);var groupingPrepare,afterInsRow=$.isFunction(ts.p.afterInsertRow),grpdata=[],hiderow=!1;for(ts.p.grouping&&(hiderow=ts.p.groupingView.groupCollapse===!0,groupingPrepare=$.jgrid.getMethod("groupingPrepare"));len>i;){if(cur=drows[i],idr=$.jgrid.getAccessor(cur,idn),void 0===idr&&("number"==typeof idn&&null!=ts.p.colModel[idn+gi+si+ni]&&(idr=$.jgrid.getAccessor(cur,ts.p.colModel[idn+gi+si+ni].name)),void 0===idr&&(idr=br+i,0===f.length&&dReader.cell))){var ccur=$.jgrid.getAccessor(cur,dReader.cell)||cur;idr=null!=ccur&&void 0!==ccur[idn]?ccur[idn]:idr,ccur=null}idr=ts.p.idPrefix+idr,altr=1===rcnt?0:rcnt,cn1=(altr+i)%2===1?cn:"",selected&&(selr=ts.p.multiselect?-1!==$.inArray(idr,ts.p.selarrrow):idr===ts.p.selrow);var iStartTrTag=rowData.length;for(rowData.push(""),ni&&rowData.push(addRowNum(0,i,ts.p.page,ts.p.rowNum)),gi&&rowData.push(addMulti(idr,ni,i,selr)),si&&rowData.push(addSubGridCell.call(self,gi+ni,i+rcnt)),rowReader=objectReader,dReader.repeatitems&&(dReader.cell&&(cur=$.jgrid.getAccessor(cur,dReader.cell)||cur),$.isArray(cur)&&(rowReader=arrayReader)),j=0;j<rowReader.length;j++)v=$.jgrid.getAccessor(cur,rowReader[j]),rd[ts.p.colModel[j+gi+si+ni].name]=v,rowData.push(addCell(idr,v,j+gi+si+ni,i+rcnt,cur,rd));if(rowData[iStartTrTag]=constructTr(idr,hiderow,cn1,rd,cur,selr),rowData.push("</tr>"),ts.p.grouping&&(grpdata.push(rowData),ts.p.groupingView._locgr||groupingPrepare.call(self,rd,i),rowData=[]),(locdata||ts.p.treeGrid===!0&&!ts.p._ald)&&(rd[locid]=$.jgrid.stripPref(ts.p.idPrefix,idr),ts.p.data.push(rd),ts.p._index[rd[locid]]=ts.p.data.length-1),ts.p.gridview===!1&&($("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").append(rowData.join("")),self.triggerHandler("jqGridAfterInsertRow",[idr,rd,cur]),afterInsRow&&ts.p.afterInsertRow.call(ts,idr,rd,cur),rowData=[]),rd={},ir++,i++,ir===rn)break}if(ts.p.gridview===!0&&(fpos=ts.p.treeANode>-1?ts.p.treeANode:0,ts.p.grouping?locdata||(self.jqGrid("groupingRender",grpdata,ts.p.colModel.length,ts.p.page,rn),grpdata=null):ts.p.treeGrid===!0&&fpos>0?$(ts.rows[fpos]).after(rowData.join("")):(ts.firstElementChild?ts.firstElementChild.innerHTML+=rowData.join(""):$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").append(rowData.join("")),ts.grid.cols=ts.rows[0].cells)),ts.p.subGrid===!0)try{self.jqGrid("addSubGrid",gi+ni)}catch(_){}if(ts.p.totaltime=new Date-startReq,ir>0&&0===ts.p.records&&(ts.p.records=len),rowData=null,ts.p.treeGrid===!0){var last_pos=ts.p.page*limit,start_pos=last_pos-limit;last_pos>ts.p.records&&(last_pos=start_pos+(ts.p.records-start_pos)),console.debug("TREE limit",limit),console.debug("TREE ts.p.records",ts.p.records),console.debug("TREE start_pos",start_pos),console.debug("TREE last_pos",last_pos);try{self.jqGrid("setTreeNode",start_pos+1,last_pos+1)}catch(e){}}if(ts.p.reccount=ir,ts.p.treeANode=-1,ts.p.userDataOnFooter&&self.jqGrid("footerData","set",ts.p.userData,!0),locdata&&(ts.p.records=len,ts.p.lastpage=Math.ceil(len/rn)),more||ts.updatepager(!1,!0),locdata){for(;len>ir&&drows[ir];){if(cur=drows[ir],idr=$.jgrid.getAccessor(cur,idn),void 0===idr&&("number"==typeof idn&&null!=ts.p.colModel[idn+gi+si+ni]&&(idr=$.jgrid.getAccessor(cur,ts.p.colModel[idn+gi+si+ni].name)),void 0===idr&&(idr=br+ir,0===f.length&&dReader.cell))){var ccur2=$.jgrid.getAccessor(cur,dReader.cell)||cur;idr=null!=ccur2&&void 0!==ccur2[idn]?ccur2[idn]:idr,ccur2=null}if(cur){for(idr=ts.p.idPrefix+idr,rowReader=objectReader,dReader.repeatitems&&(dReader.cell&&(cur=$.jgrid.getAccessor(cur,dReader.cell)||cur),$.isArray(cur)&&(rowReader=arrayReader)),j=0;j<rowReader.length;j++)rd[ts.p.colModel[j+gi+si+ni].name]=$.jgrid.getAccessor(cur,rowReader[j]);rd[locid]=$.jgrid.stripPref(ts.p.idPrefix,idr),ts.p.grouping&&groupingPrepare.call(self,rd,ir),ts.p.data.push(rd),ts.p._index[rd[locid]]=ts.p.data.length-1,rd={}}ir++}ts.p.grouping&&(ts.p.groupingView._locgr=!0,self.jqGrid("groupingRender",grpdata,ts.p.colModel.length,ts.p.page,rn),grpdata=null)}}},addLocalData=function(){function tojLinq(group){var index,gor,ror,opr,rule,fld,s=0;if(null!=group.groups){for(gor=group.groups.length&&"OR"===group.groupOp.toString().toUpperCase(),gor&&query.orBegin(),index=0;index<group.groups.length;index++){s>0&&gor&&query.or();try{tojLinq(group.groups[index])}catch(e){alert(e)}s++}gor&&query.orEnd()}if(null!=group.rules)try{for(ror=group.rules.length&&"OR"===group.groupOp.toString().toUpperCase(),ror&&query.orBegin(),index=0;index<group.rules.length;index++)rule=group.rules[index],opr=group.groupOp.toString().toUpperCase(),compareFnMap[rule.op]&&rule.field&&(s>0&&opr&&"OR"===opr&&(query=query.or()),fld=cmtypes[rule.field],"date"===fld.stype&&fld.srcfmt&&fld.newfmt&&fld.srcfmt!==fld.newfmt&&(rule.data=$.jgrid.parseDate.call(ts,fld.newfmt,rule.data,fld.srcfmt)),query=compareFnMap[rule.op](query,opr)(rule.field,rule.data,cmtypes[rule.field])),s++;ror&&query.orEnd()}catch(g){alert(g)}}var srcformat,sorttype,newformat,sfld,st=ts.p.multiSort?[]:"",sto=[],fndsort=!1,cmtypes={},grtypes=[],grindexes=[];if($.isArray(ts.p.data)){var lengrp,gin,grpview=ts.p.grouping?ts.p.groupingView:!1;if($.each(ts.p.colModel,function(){if(sorttype=this.sorttype||"text","date"===sorttype||"datetime"===sorttype?(this.formatter&&"string"==typeof this.formatter&&"date"===this.formatter?(srcformat=this.formatoptions&&this.formatoptions.srcformat?this.formatoptions.srcformat:$.jgrid.getRegional(ts,"formatter.date.srcformat"),newformat=this.formatoptions&&this.formatoptions.newformat?this.formatoptions.newformat:$.jgrid.getRegional(ts,"formatter.date.newformat")):srcformat=newformat=this.datefmt||"Y-m-d",cmtypes[this.name]={stype:sorttype,srcfmt:srcformat,newfmt:newformat,sfunc:this.sortfunc||null}):cmtypes[this.name]={stype:sorttype,srcfmt:"",newfmt:"",sfunc:this.sortfunc||null},ts.p.grouping)for(gin=0,lengrp=grpview.groupField.length;lengrp>gin;gin++)if(this.name===grpview.groupField[gin]){var grindex=this.name;this.index&&(grindex=this.index),grtypes[gin]=cmtypes[grindex],grindexes[gin]=grindex}if(ts.p.multiSort){if(this.lso){st.push(this.name);var tmplso=this.lso.split("-");sto.push(tmplso[tmplso.length-1])}}else fndsort||this.index!==ts.p.sortname&&this.name!==ts.p.sortname||(st=this.name,fndsort=!0)}),ts.p.treeGrid&&ts.p._sort)return void $(ts).jqGrid("SortTree",st,ts.p.sortorder,cmtypes[st].stype||"text",cmtypes[st].srcfmt||"");var compareFnMap={eq:function(queryObj){return queryObj.equals},ne:function(queryObj){return queryObj.notEquals},lt:function(queryObj){return queryObj.less},le:function(queryObj){return queryObj.lessOrEquals},gt:function(queryObj){return queryObj.greater},ge:function(queryObj){return queryObj.greaterOrEquals},cn:function(queryObj){return queryObj.contains},nc:function(queryObj,op){return"OR"===op?queryObj.orNot().contains:queryObj.andNot().contains},bw:function(queryObj){return queryObj.startsWith},bn:function(queryObj,op){return"OR"===op?queryObj.orNot().startsWith:queryObj.andNot().startsWith},en:function(queryObj,op){return"OR"===op?queryObj.orNot().endsWith:queryObj.andNot().endsWith},ew:function(queryObj){return queryObj.endsWith},ni:function(queryObj,op){return"OR"===op?queryObj.orNot().equals:queryObj.andNot().equals},"in":function(queryObj){return queryObj.equals},nu:function(queryObj){return queryObj.isNull},nn:function(queryObj,op){return"OR"===op?queryObj.orNot().isNull:queryObj.andNot().isNull}},query=$.jgrid.from.call(ts,ts.p.data);if(ts.p.ignoreCase&&(query=query.ignoreCase()),ts.p.search===!0){var srules=ts.p.postData.filters;if(srules)"string"==typeof srules&&(srules=$.jgrid.parse(srules)),tojLinq(srules);else try{sfld=cmtypes[ts.p.postData.searchField],"date"===sfld.stype&&sfld.srcfmt&&sfld.newfmt&&sfld.srcfmt!==sfld.newfmt&&(ts.p.postData.searchString=$.jgrid.parseDate.call(ts,sfld.newfmt,ts.p.postData.searchString,sfld.srcfmt)),query=compareFnMap[ts.p.postData.searchOper](query)(ts.p.postData.searchField,ts.p.postData.searchString,cmtypes[ts.p.postData.searchField])}catch(se){}}else ts.p.treeGrid&&"nested"===ts.p.treeGridModel&&query.orderBy(ts.p.treeReader.left_field,"asc","integer","",null);if(ts.p.treeGrid&&"adjacency"===ts.p.treeGridModel&&(lengrp=0,st=null),ts.p.grouping)for(gin=0;lengrp>gin;gin++)query.orderBy(grindexes[gin],grpview.groupOrder[gin],grtypes[gin].stype,grtypes[gin].srcfmt);ts.p.multiSort?$.each(st,function(i){query.orderBy(this,sto[i],cmtypes[this].stype,cmtypes[this].srcfmt,cmtypes[this].sfunc)}):st&&ts.p.sortorder&&fndsort&&("DESC"===ts.p.sortorder.toUpperCase()?query.orderBy(ts.p.sortname,"d",cmtypes[st].stype,cmtypes[st].srcfmt,cmtypes[st].sfunc):query.orderBy(ts.p.sortname,"a",cmtypes[st].stype,cmtypes[st].srcfmt,cmtypes[st].sfunc));var queryResults=query.select(),recordsperpage=parseInt(ts.p.rowNum,10),total=queryResults.length,page=parseInt(ts.p.page,10),totalpages=Math.ceil(total/recordsperpage),retresult={};if((ts.p.search||ts.p.resetsearch)&&ts.p.grouping&&ts.p.groupingView._locgr){ts.p.groupingView.groups=[];var j,key,udc,grPrepare=$.jgrid.getMethod("groupingPrepare");if(ts.p.footerrow&&ts.p.userDataOnFooter){for(key in ts.p.userData)ts.p.userData.hasOwnProperty(key)&&(ts.p.userData[key]=0);udc=!0}for(j=0;total>j;j++){if(udc)for(key in ts.p.userData)ts.p.userData.hasOwnProperty(key)&&(ts.p.userData[key]+=parseFloat(queryResults[j][key]||0));grPrepare.call($(ts),queryResults[j],j,recordsperpage)}}return queryResults=ts.p.treeGrid&&ts.p.search?$(ts).jqGrid("searchTree",queryResults):queryResults.slice((page-1)*recordsperpage,page*recordsperpage),query=null,cmtypes=null,retresult[ts.p.localReader.total]=totalpages,retresult[ts.p.localReader.page]=page,retresult[ts.p.localReader.records]=total,retresult[ts.p.localReader.root]=queryResults,retresult[ts.p.localReader.userdata]=ts.p.userData,queryResults=null,retresult}},updatepager=function(rn,dnd){var cp,last,base,from,to,tot,fmt,sppg,pgboxes="",pgid=ts.p.pager?$.jgrid.jqID(ts.p.pager.substr(1)):"",tspg=pgid?"_"+pgid:"",tspg_t=ts.p.toppager?"_"+ts.p.toppager.substr(1):"";if(base=parseInt(ts.p.page,10)-1,0>base&&(base=0),base*=parseInt(ts.p.rowNum,10),to=base+ts.p.reccount,ts.p.scroll){var rows=$("tbody:first > tr:gt(0)",ts.grid.bDiv);base=to-rows.length,ts.p.reccount=rows.length;var rh=rows.outerHeight()||ts.grid.prevRowHeight;if(rh){var top=base*rh,height=parseInt(ts.p.records,10)*rh;$(">div:first",ts.grid.bDiv).css({height:height}).children("div:first").css({height:top,display:top?"":"none"}),0===ts.grid.bDiv.scrollTop&&ts.p.page>1&&(ts.grid.bDiv.scrollTop=ts.p.rowNum*(ts.p.page-1)*rh)}ts.grid.bDiv.scrollLeft=ts.grid.hDiv.scrollLeft}if(pgboxes=ts.p.pager||"",pgboxes+=ts.p.toppager?pgboxes?","+ts.p.toppager:ts.p.toppager:""){if(fmt=$.jgrid.getRegional(ts,"formatter.integer"),cp=intNum(ts.p.page),last=intNum(ts.p.lastpage),$(".selbox",pgboxes)[this.p.useProp?"prop":"attr"]("disabled",!1),ts.p.pginput===!0&&($("#input"+tspg).html($.jgrid.template($.jgrid.getRegional(ts,"defaults.pgtext",ts.p.pgtext)||"","<input class='ui-pg-input ui-corner-all' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+$.jgrid.jqID(pgid)+"'></span>")),ts.p.toppager&&$("#input_t"+tspg_t).html($.jgrid.template($.jgrid.getRegional(ts,"defaults.pgtext",ts.p.pgtext)||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+$.jgrid.jqID(pgid)+"_toppager'></span>")),$(".ui-pg-input",pgboxes).val(ts.p.page),sppg=ts.p.toppager?"#sp_1"+tspg+",#sp_1"+tspg_t:"#sp_1"+tspg,$(sppg).html($.fmatter?$.fmatter.util.NumberFormat(ts.p.lastpage,fmt):ts.p.lastpage)),ts.p.viewrecords)if(0===ts.p.reccount)$(".ui-paging-info",pgboxes).html($.jgrid.getRegional(ts,"defaults.emptyrecords",ts.p.emptyrecords));else{from=base+1,tot=ts.p.records,$.fmatter&&(from=$.fmatter.util.NumberFormat(from,fmt),to=$.fmatter.util.NumberFormat(to,fmt),tot=$.fmatter.util.NumberFormat(tot,fmt));var rt=$.jgrid.getRegional(ts,"defaults.recordtext",ts.p.recordtext);$(".ui-paging-info",pgboxes).html($.jgrid.template(rt,from,to,tot))}ts.p.pgbuttons===!0&&(0>=cp&&(cp=last=0),1===cp||0===cp?($("#first"+tspg+", #prev"+tspg).addClass("ui-state-disabled").removeClass("ui-state-hover"),ts.p.toppager&&$("#first_t"+tspg_t+", #prev_t"+tspg_t).addClass("ui-state-disabled").removeClass("ui-state-hover")):($("#first"+tspg+", #prev"+tspg).removeClass("ui-state-disabled"),ts.p.toppager&&$("#first_t"+tspg_t+", #prev_t"+tspg_t).removeClass("ui-state-disabled")),cp===last||0===cp?($("#next"+tspg+", #last"+tspg).addClass("ui-state-disabled").removeClass("ui-state-hover"),ts.p.toppager&&$("#next_t"+tspg_t+", #last_t"+tspg_t).addClass("ui-state-disabled").removeClass("ui-state-hover")):($("#next"+tspg+", #last"+tspg).removeClass("ui-state-disabled"),ts.p.toppager&&$("#next_t"+tspg_t+", #last_t"+tspg_t).removeClass("ui-state-disabled")))}rn===!0&&ts.p.rownumbers===!0&&$(">td.jqgrid-rownum",ts.rows).each(function(i){$(this).html(base+1+i)}),dnd&&ts.p.jqgdnd&&$(ts).jqGrid("gridDnD","updateDnD"),$(ts).triggerHandler("jqGridGridComplete"),$.isFunction(ts.p.gridComplete)&&ts.p.gridComplete.call(ts),$(ts).triggerHandler("jqGridAfterGridComplete")},beginReq=function(){ts.grid.hDiv.loading=!0,ts.p.hiddengrid||$(ts).jqGrid("progressBar",{method:"show",loadtype:ts.p.loadui,htmlcontent:$.jgrid.getRegional(ts,"defaults.loadtext",ts.p.loadtext)})},endReq=function(){ts.grid.hDiv.loading=!1,$(ts).jqGrid("progressBar",{method:"hide",loadtype:ts.p.loadui})},populate=function(npage){if(!ts.grid.hDiv.loading){var dt,dstr,pvis=ts.p.scroll&&npage===!1,prm={},pN=ts.p.prmNames;ts.p.page<=0&&(ts.p.page=Math.min(1,ts.p.lastpage)),null!==pN.search&&(prm[pN.search]=ts.p.search),null!==pN.nd&&(prm[pN.nd]=(new Date).getTime()),null!==pN.rows&&(prm[pN.rows]=ts.p.rowNum),null!==pN.page&&(prm[pN.page]=ts.p.page),null!==pN.sort&&(prm[pN.sort]=ts.p.sortname),null!==pN.order&&(prm[pN.order]=ts.p.sortorder),null!==ts.p.rowTotal&&null!==pN.totalrows&&(prm[pN.totalrows]=ts.p.rowTotal);var lcf=$.isFunction(ts.p.loadComplete),lc=lcf?ts.p.loadComplete:null,adjust=0;if(npage=npage||1,npage>1?null!==pN.npage?(prm[pN.npage]=npage,adjust=npage-1,npage=1):lc=function(req){ts.p.page++,ts.grid.hDiv.loading=!1,lcf&&ts.p.loadComplete.call(ts,req),populate(npage-1)}:null!==pN.npage&&delete ts.p.postData[pN.npage],ts.p.grouping){$(ts).jqGrid("groupingSetup");var gi,grp=ts.p.groupingView,gs="";for(gi=0;gi<grp.groupField.length;gi++){var index=grp.groupField[gi];$.each(ts.p.colModel,function(cmIndex,cmValue){cmValue.name===index&&cmValue.index&&(index=cmValue.index)}),gs+=index+" "+grp.groupOrder[gi]+", "}prm[pN.sort]=gs+prm[pN.sort]}$.extend(ts.p.postData,prm);var rcnt=ts.p.scroll?ts.rows.length-1:1,bfr=$(ts).triggerHandler("jqGridBeforeRequest");if(bfr===!1||"stop"===bfr)return;if($.isFunction(ts.p.datatype))return void ts.p.datatype.call(ts,ts.p.postData,"load_"+ts.p.id,rcnt,npage,adjust);if($.isFunction(ts.p.beforeRequest)&&(bfr=ts.p.beforeRequest.call(ts),void 0===bfr&&(bfr=!0),bfr===!1))return;switch(dt=ts.p.datatype.toLowerCase()){case"json":case"jsonp":case"xml":case"script":$.ajax($.extend({url:ts.p.url,type:ts.p.mtype,dataType:dt,data:$.isFunction(ts.p.serializeGridData)?ts.p.serializeGridData.call(ts,ts.p.postData):ts.p.postData,success:function(data,st,xhr){return $.isFunction(ts.p.beforeProcessing)&&ts.p.beforeProcessing.call(ts,data,st,xhr)===!1?void endReq():("xml"===dt?addXmlData(data,rcnt,npage>1,adjust):addJSONData(data,rcnt,npage>1,adjust),$(ts).triggerHandler("jqGridLoadComplete",[data]),lc&&lc.call(ts,data),$(ts).triggerHandler("jqGridAfterLoadComplete",[data]),pvis&&ts.grid.populateVisible(),ts.p.loadonce&&(ts.p.datatype="local"),data=null,void(1===npage&&endReq()))},error:function(xhr,st,err){$.isFunction(ts.p.loadError)&&ts.p.loadError.call(ts,xhr,st,err),1===npage&&endReq(),xhr=null},beforeSend:function(xhr,settings){var gotoreq=!0;return $.isFunction(ts.p.loadBeforeSend)&&(gotoreq=ts.p.loadBeforeSend.call(ts,xhr,settings)),void 0===gotoreq&&(gotoreq=!0),gotoreq===!1?!1:void beginReq()}},$.jgrid.ajaxOptions,ts.p.ajaxGridOptions));break;case"xmlstring":beginReq(),dstr="string"!=typeof ts.p.datastr?ts.p.datastr:$.parseXML(ts.p.datastr),addXmlData(dstr),$(ts).triggerHandler("jqGridLoadComplete",[dstr]),lcf&&ts.p.loadComplete.call(ts,dstr),$(ts).triggerHandler("jqGridAfterLoadComplete",[dstr]),ts.p.datatype="local",ts.p.datastr=null,endReq();break;case"jsonstring":beginReq(),dstr="string"==typeof ts.p.datastr?$.jgrid.parse(ts.p.datastr):ts.p.datastr,addJSONData(dstr),$(ts).triggerHandler("jqGridLoadComplete",[dstr]),lcf&&ts.p.loadComplete.call(ts,dstr),$(ts).triggerHandler("jqGridAfterLoadComplete",[dstr]),ts.p.datatype="local",ts.p.datastr=null,endReq();break;case"local":case"clientside":beginReq(),ts.p.datatype="local",ts.p._ald=!0;var req=addLocalData();addJSONData(req,rcnt,npage>1,adjust),$(ts).triggerHandler("jqGridLoadComplete",[req]),lc&&lc.call(ts,req),$(ts).triggerHandler("jqGridAfterLoadComplete",[req]),pvis&&ts.grid.populateVisible(),endReq(),ts.p._ald=!1}ts.p._sort=!1}},setHeadCheckBox=function(checked){$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv)[ts.p.useProp?"prop":"attr"]("checked",checked);var fid=ts.p.frozenColumns?ts.p.id+"_frozen":"";fid&&$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.fhDiv)[ts.p.useProp?"prop":"attr"]("checked",checked)},setPager=function(pgid,tp){var pgcnt,lft,cent,rgt,twd,tdw,i,sep="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",pginp="",pgl="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",str="",clearVals=function(onpaging){var ret;return $.isFunction(ts.p.onPaging)&&(ret=ts.p.onPaging.call(ts,onpaging)),"stop"===ret?!1:(ts.p.selrow=null,ts.p.multiselect&&(ts.p.selarrrow=[],setHeadCheckBox(!1)),ts.p.savedRow=[],!0)};if(pgid=pgid.substr(1),tp+="_"+pgid,pgcnt="pg_"+pgid,lft=pgid+"_left",cent=pgid+"_center",rgt=pgid+"_right",$("#"+$.jgrid.jqID(pgid)).append("<div id='"+pgcnt+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;'><tbody><tr><td id='"+lft+"' align='left'></td><td id='"+cent+"' align='center' style='white-space:pre;'></td><td id='"+rgt+"' align='right'></td></tr></tbody></table></div>").attr("dir","ltr"),ts.p.rowList.length>0){str='<td dir="'+dir+'">',str+='<select class="ui-pg-selbox ui-widget-content ui-corner-all" role="listbox" title="'+($.jgrid.getRegional(ts,"defaults.pgrecs",ts.p.pgrecs)||"")+'">';var strnm;for(i=0;i<ts.p.rowList.length;i++)strnm=ts.p.rowList[i].toString().split(":"),1===strnm.length&&(strnm[1]=strnm[0]),str+='<option role="option" value="'+strnm[0]+'"'+(intNum(ts.p.rowNum,0)===intNum(strnm[0],0)?' selected="selected"':"")+">"+strnm[1]+"</option>";str+="</select></td>"}if("rtl"===dir&&(pgl+=str),ts.p.pginput===!0&&(pginp="<td id='input"+tp+"' dir='"+dir+"'>"+$.jgrid.template($.jgrid.getRegional(ts,"defaults.pgtext",ts.p.pgtext)||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+$.jgrid.jqID(pgid)+"'></span>")+"</td>"),ts.p.pgbuttons===!0){var po=["first"+tp,"prev"+tp,"next"+tp,"last"+tp];"rtl"===dir&&po.reverse(),pgl+="<td id='"+po[0]+"' class='ui-pg-button ui-corner-all' title='"+($.jgrid.getRegional(ts,"defaults.pgfirst",ts.p.pgfirst)||"")+"'><span class='ui-icon ui-icon-seek-first'></span></td>",pgl+="<td id='"+po[1]+"' class='ui-pg-button ui-corner-all' title='"+($.jgrid.getRegional(ts,"defaults.pgprev",ts.p.pgprev)||"")+"'><span class='ui-icon ui-icon-seek-prev'></span></td>",pgl+=""!==pginp?sep+pginp+sep:"",pgl+="<td id='"+po[2]+"' class='ui-pg-button ui-corner-all' title='"+($.jgrid.getRegional(ts,"defaults.pgnext",ts.p.pgnext)||"")+"'><span class='ui-icon ui-icon-seek-next'></span></td>",pgl+="<td id='"+po[3]+"' class='ui-pg-button ui-corner-all' title='"+($.jgrid.getRegional(ts,"defaults.pglast",ts.p.pglast)||"")+"'><span class='ui-icon ui-icon-seek-end'></span></td>"}else""!==pginp&&(pgl+=pginp);"ltr"===dir&&(pgl+=str),pgl+="</tr></tbody></table>",ts.p.viewrecords===!0&&$("td#"+pgid+"_"+ts.p.recordpos,"#"+pgcnt).append("<div dir='"+dir+"' style='text-align:"+ts.p.recordpos+"' class='ui-paging-info'></div>"),$("td#"+pgid+"_"+ts.p.pagerpos,"#"+pgcnt).append(pgl),tdw=$(".ui-jqgrid").css("font-size")||"11px",$(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+tdw+";visibility:hidden;' ></div>"),twd=$(pgl).clone().appendTo("#testpg").width(),$("#testpg").remove(),twd>0&&(""!==pginp&&(twd+=50),$("td#"+pgid+"_"+ts.p.pagerpos,"#"+pgcnt).width(twd)),ts.p._nvtd=[],ts.p._nvtd[0]=Math.floor(twd?(ts.p.width-twd)/2:ts.p.width/3),ts.p._nvtd[1]=0,pgl=null,$(".ui-pg-selbox","#"+pgcnt).bind("change",function(){return clearVals("records")?(ts.p.page=Math.round(ts.p.rowNum*(ts.p.page-1)/this.value-.5)+1,ts.p.rowNum=this.value,ts.p.pager&&$(".ui-pg-selbox",ts.p.pager).val(this.value),ts.p.toppager&&$(".ui-pg-selbox",ts.p.toppager).val(this.value),populate(),!1):!1}),ts.p.pgbuttons===!0&&($(".ui-pg-button","#"+pgcnt).hover(function(){$(this).hasClass("ui-state-disabled")?this.style.cursor="default":($(this).addClass("ui-state-hover"),this.style.cursor="pointer")},function(){$(this).hasClass("ui-state-disabled")||($(this).removeClass("ui-state-hover"),this.style.cursor="default")}),$("#first"+$.jgrid.jqID(tp)+", #prev"+$.jgrid.jqID(tp)+", #next"+$.jgrid.jqID(tp)+", #last"+$.jgrid.jqID(tp)).click(function(){if($(this).hasClass("ui-state-disabled"))return!1;var cp=intNum(ts.p.page,1),last=intNum(ts.p.lastpage,1),selclick=!1,fp=!0,pp=!0,np=!0,lp=!0;return 0===last||1===last?(fp=!1,pp=!1,np=!1,lp=!1):last>1&&cp>=1?1===cp?(fp=!1,pp=!1):cp===last&&(np=!1,lp=!1):last>1&&0===cp&&(np=!1,lp=!1,cp=last-1),clearVals(this.id.split("_")[0])?(this.id==="first"+tp&&fp&&(ts.p.page=1,selclick=!0),this.id==="prev"+tp&&pp&&(ts.p.page=cp-1,selclick=!0),this.id==="next"+tp&&np&&(ts.p.page=cp+1,selclick=!0),this.id==="last"+tp&&lp&&(ts.p.page=last,selclick=!0),selclick&&populate(),!1):!1})),ts.p.pginput===!0&&$("#"+pgcnt).on("keypress","input.ui-pg-input",function(e){var key=e.charCode||e.keyCode||0;return 13===key?clearVals("user")?($(this).val(intNum($(this).val(),1)),ts.p.page=$(this).val()>0?$(this).val():ts.p.page,populate(),!1):!1:this})},multiSort=function(iCol,obj){var splas,ls,sort="",cm=ts.p.colModel,fs=!1,selTh=ts.p.frozenColumns?obj:ts.grid.headers[iCol].el,so="";$("span.ui-grid-ico-sort",selTh).addClass("ui-state-disabled"),$(selTh).attr("aria-selected","false"),cm[iCol].lso?"asc"===cm[iCol].lso?(cm[iCol].lso+="-desc",so="desc"):"desc"===cm[iCol].lso?(cm[iCol].lso+="-asc",so="asc"):("asc-desc"===cm[iCol].lso||"desc-asc"===cm[iCol].lso)&&(cm[iCol].lso=""):cm[iCol].lso=so=cm[iCol].firstsortorder||"asc",so?($("span.s-ico",selTh).show(),$("span.ui-icon-"+so,selTh).removeClass("ui-state-disabled"),$(selTh).attr("aria-selected","true")):ts.p.viewsortcols[0]||$("span.s-ico",selTh).hide(),ts.p.sortorder="",$.each(cm,function(i){this.lso&&(i>0&&fs&&(sort+=", "),splas=this.lso.split("-"),sort+=cm[i].index||cm[i].name,sort+=" "+splas[splas.length-1],fs=!0,ts.p.sortorder=splas[splas.length-1])}),ls=sort.lastIndexOf(ts.p.sortorder),sort=sort.substring(0,ls),ts.p.sortname=sort},sortData=function(index,idxcol,reload,sor,obj){if(ts.p.colModel[idxcol].sortable&&!(ts.p.savedRow.length>0)){if(reload||(ts.p.lastsort===idxcol&&""!==ts.p.sortname?"asc"===ts.p.sortorder?ts.p.sortorder="desc":"desc"===ts.p.sortorder&&(ts.p.sortorder="asc"):ts.p.sortorder=ts.p.colModel[idxcol].firstsortorder||"asc",ts.p.page=1),ts.p.multiSort)multiSort(idxcol,obj);else{if(sor){if(ts.p.lastsort===idxcol&&ts.p.sortorder===sor&&!reload)return;ts.p.sortorder=sor}var previousSelectedTh=ts.grid.headers[ts.p.lastsort]?ts.grid.headers[ts.p.lastsort].el:null,newSelectedTh=ts.p.frozenColumns?obj:ts.grid.headers[idxcol].el;$("span.ui-grid-ico-sort",previousSelectedTh).addClass("ui-state-disabled"),$(previousSelectedTh).attr("aria-selected","false"),ts.p.frozenColumns&&(ts.grid.fhDiv.find("span.ui-grid-ico-sort").addClass("ui-state-disabled"),ts.grid.fhDiv.find("th").attr("aria-selected","false")),$("span.ui-icon-"+ts.p.sortorder,newSelectedTh).removeClass("ui-state-disabled"),$(newSelectedTh).attr("aria-selected","true"),ts.p.viewsortcols[0]||(ts.p.lastsort!==idxcol?(ts.p.frozenColumns&&ts.grid.fhDiv.find("span.s-ico").hide(),$("span.s-ico",previousSelectedTh).hide(),$("span.s-ico",newSelectedTh).show()):""===ts.p.sortname&&$("span.s-ico",newSelectedTh).show()),index=index.substring(5+ts.p.id.length+1),ts.p.sortname=ts.p.colModel[idxcol].index||index;

}if("stop"===$(ts).triggerHandler("jqGridSortCol",[ts.p.sortname,idxcol,ts.p.sortorder]))return void(ts.p.lastsort=idxcol);if($.isFunction(ts.p.onSortCol)&&"stop"===ts.p.onSortCol.call(ts,ts.p.sortname,idxcol,ts.p.sortorder))return void(ts.p.lastsort=idxcol);if("local"===ts.p.datatype?ts.p.deselectAfterSort&&$(ts).jqGrid("resetSelection"):(ts.p.selrow=null,ts.p.multiselect&&setHeadCheckBox(!1),ts.p.selarrrow=[],ts.p.savedRow=[]),ts.p.scroll){var sscroll=ts.grid.bDiv.scrollLeft;emptyRows.call(ts,!0,!1),ts.grid.hDiv.scrollLeft=sscroll}ts.p.subGrid&&"local"===ts.p.datatype&&$("td.sgexpanded","#"+$.jgrid.jqID(ts.p.id)).each(function(){$(this).trigger("click")}),ts.p._sort=!0,populate(),ts.p.lastsort=idxcol,ts.p.sortname!==index&&idxcol&&(ts.p.lastsort=idxcol)}},setColWidth=function(){var lvc,cw,aw,cr,initwidth=0,brd=$.jgrid.cell_width?0:intNum(ts.p.cellLayout,0),vc=0,scw=intNum(ts.p.scrollOffset,0),hs=!1,gw=0;$.each(ts.p.colModel,function(){if(void 0===this.hidden&&(this.hidden=!1),ts.p.grouping&&ts.p.autowidth){var ind=$.inArray(this.name,ts.p.groupingView.groupField);ind>=0&&ts.p.groupingView.groupColumnShow.length>ind&&(this.hidden=!ts.p.groupingView.groupColumnShow[ind])}this.widthOrg=cw=intNum(this.width,0),this.hidden===!1&&(initwidth+=cw+brd,this.fixed?gw+=cw+brd:vc++)}),isNaN(ts.p.width)&&(ts.p.width=initwidth+(ts.p.shrinkToFit!==!1||isNaN(ts.p.height)?0:scw)),grid.width=ts.p.width,ts.p.tblwidth=initwidth,ts.p.shrinkToFit===!1&&ts.p.forceFit===!0&&(ts.p.forceFit=!1),ts.p.shrinkToFit===!0&&vc>0&&(aw=grid.width-brd*vc-gw,isNaN(ts.p.height)||(aw-=scw,hs=!0),initwidth=0,$.each(ts.p.colModel,function(i){this.hidden!==!1||this.fixed||(cw=Math.round(aw*this.width/(ts.p.tblwidth-brd*vc-gw)),this.width=cw,initwidth+=cw,lvc=i)}),cr=0,hs?grid.width-gw-(initwidth+brd*vc)!==scw&&(cr=grid.width-gw-(initwidth+brd*vc)-scw):hs||1===Math.abs(grid.width-gw-(initwidth+brd*vc))||(cr=grid.width-gw-(initwidth+brd*vc)),ts.p.colModel[lvc].width+=cr,ts.p.tblwidth=initwidth+cr+brd*vc+gw,ts.p.tblwidth>ts.p.width&&(ts.p.colModel[lvc].width-=ts.p.tblwidth-parseInt(ts.p.width,10),ts.p.tblwidth=ts.p.width))},nextVisible=function(iCol){var i,ret=iCol,j=iCol;for(i=iCol+1;i<ts.p.colModel.length;i++)if(ts.p.colModel[i].hidden!==!0){j=i;break}return j-ret},getOffset=function(iCol){var $th=$(ts.grid.headers[iCol].el),ret=[$th.position().left+$th.outerWidth()];return"rtl"===ts.p.direction&&(ret[0]=ts.p.width-ret[0]),ret[0]-=ts.grid.bDiv.scrollLeft,ret.push($(ts.grid.hDiv).position().top),ret.push($(ts.grid.bDiv).offset().top-$(ts.grid.hDiv).offset().top+$(ts.grid.bDiv).height()),ret},getColumnHeaderIndex=function(th){var i,headers=ts.grid.headers,ci=$.jgrid.getCellIndex(th);for(i=0;i<headers.length;i++)if(th===headers[i].el){ci=i;break}return ci};for(this.p.id=this.id,-1===$.inArray(ts.p.multikey,sortkeys)&&(ts.p.multikey=!1),ts.p.keyName=!1,i=0;i<ts.p.colModel.length;i++)colTemplate="string"==typeof ts.p.colModel[i].template?null!=$.jgrid.cmTemplate&&"object"==typeof $.jgrid.cmTemplate[ts.p.colModel[i].template]?$.jgrid.cmTemplate[ts.p.colModel[i].template]:{}:ts.p.colModel[i].template,ts.p.colModel[i]=$.extend(!0,{},ts.p.cmTemplate,colTemplate||{},ts.p.colModel[i]),ts.p.keyName===!1&&ts.p.colModel[i].key===!0&&(ts.p.keyName=ts.p.colModel[i].name);if(ts.p.sortorder=ts.p.sortorder.toLowerCase(),$.jgrid.cell_width=$.jgrid.cellWidth(),ts.p.grouping===!0&&(ts.p.scroll=!1,ts.p.rownumbers=!1,ts.p.treeGrid=!1,ts.p.gridview=!0),this.p.treeGrid===!0){try{$(this).jqGrid("setTreeGrid")}catch(_){}"local"!==ts.p.datatype&&(ts.p.localReader={id:"_id_"})}if(this.p.subGrid)try{$(ts).jqGrid("setSubGrid")}catch(s){}if(this.p.multiselect){ts.p.multiselectWidth=60;var cb_align=this.p.treeGrid===!0?"left":"center";this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>"),this.p.colModel.unshift({name:"cb",width:$.jgrid.cell_width?ts.p.multiselectWidth+ts.p.cellLayout:ts.p.multiselectWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:cb_align,fixed:!0})}this.p.rownumbers&&(this.p.colNames.unshift(""),this.p.colModel.unshift({name:"rn",width:ts.p.rownumWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0})),ts.p.xmlReader=$.extend(!0,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:!0,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:!0,cell:"cell"}},ts.p.xmlReader),ts.p.jsonReader=$.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!0,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},ts.p.jsonReader),ts.p.localReader=$.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},ts.p.localReader),ts.p.scroll&&(ts.p.pgbuttons=!1,ts.p.pginput=!1,ts.p.rowList=[]),ts.p.data.length&&(normalizeData(),refreshIndex());var tdc,idn,w,res,sort,td,ptr,tbody,imgs,thead="<thead><tr class='ui-jqgrid-labels' role='row'>",iac="",idc="",sortarr=[],sortord=[],sotmp=[];if(ts.p.shrinkToFit===!0&&ts.p.forceFit===!0)for(i=ts.p.colModel.length-1;i>=0;i--)if(!ts.p.colModel[i].hidden){ts.p.colModel[i].resizable=!1;break}if("horizontal"===ts.p.viewsortcols[1]&&(iac=" ui-i-asc",idc=" ui-i-desc"),tdc=isMSIE?"class='ui-th-div-ie'":"",imgs="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+iac+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+dir+"'></span>",imgs+="<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+idc+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+dir+"'></span></span>",ts.p.multiSort)for(sortarr=ts.p.sortname.split(","),i=0;i<sortarr.length;i++)sotmp=$.trim(sortarr[i]).split(" "),sortarr[i]=$.trim(sotmp[0]),sortord[i]=sotmp[1]?$.trim(sotmp[1]):ts.p.sortorder||"asc";for(i=0;i<this.p.colNames.length;i++){var tooltip=ts.p.headertitles?' title="'+$.jgrid.stripHtml(ts.p.colNames[i])+'"':"";thead+="<th id='"+ts.p.id+"_"+ts.p.colModel[i].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+dir+"'"+tooltip+">",idn=ts.p.colModel[i].index||ts.p.colModel[i].name,thead+="<div id='jqgh_"+ts.p.id+"_"+ts.p.colModel[i].name+"' "+tdc+">"+ts.p.colNames[i],ts.p.colModel[i].width?ts.p.colModel[i].width=parseInt(ts.p.colModel[i].width,10):ts.p.colModel[i].width=150,"boolean"!=typeof ts.p.colModel[i].title&&(ts.p.colModel[i].title=!0),ts.p.colModel[i].lso="",idn===ts.p.sortname&&(ts.p.lastsort=i),ts.p.multiSort&&(sotmp=$.inArray(idn,sortarr),-1!==sotmp&&(ts.p.colModel[i].lso=sortord[sotmp])),thead+=imgs+"</div></th>"}if(thead+="</tr></thead>",imgs=null,$(this).append(thead),$("thead tr:first th",this).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}),this.p.multiselect){var chk,emp=[];$("#cb_"+$.jgrid.jqID(ts.p.id),this).bind("click",function(){ts.p.selarrrow=[];var froz=ts.p.frozenColumns===!0?ts.p.id+"_frozen":"";this.checked?($(ts.rows).each(function(i){i>0&&($(this).hasClass("ui-subgrid")||$(this).hasClass("jqgroup")||$(this).hasClass("ui-state-disabled")||$(this).hasClass("jqfoot")||($("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id))[ts.p.useProp?"prop":"attr"]("checked",!0),$(this).addClass("ui-state-highlight").attr("aria-selected","true"),ts.p.selarrrow.push(this.id),ts.p.selrow=this.id,froz&&($("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id),ts.grid.fbDiv)[ts.p.useProp?"prop":"attr"]("checked",!0),$("#"+$.jgrid.jqID(this.id),ts.grid.fbDiv).addClass("ui-state-highlight"))))}),chk=!0,emp=[]):($(ts.rows).each(function(i){i>0&&($(this).hasClass("ui-subgrid")||$(this).hasClass("jqgroup")||$(this).hasClass("ui-state-disabled")||$(this).hasClass("jqfoot")||($("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id))[ts.p.useProp?"prop":"attr"]("checked",!1),$(this).removeClass("ui-state-highlight").attr("aria-selected","false"),emp.push(this.id),froz&&($("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id),ts.grid.fbDiv)[ts.p.useProp?"prop":"attr"]("checked",!1),$("#"+$.jgrid.jqID(this.id),ts.grid.fbDiv).removeClass("ui-state-highlight"))))}),ts.p.selrow=null,chk=!1),$(ts).triggerHandler("jqGridSelectAll",[chk?ts.p.selarrrow:emp,chk]),$.isFunction(ts.p.onSelectAll)&&ts.p.onSelectAll.call(ts,chk?ts.p.selarrrow:emp,chk)})}if(ts.p.autowidth===!0){var pw=$(eg).innerWidth();ts.p.width=pw>0?pw:"nw"}setColWidth(),$(eg).css("width",grid.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+ts.p.id+"'>&#160;</div>"),ts.p.scrollPopUp&&$(eg).append("<div class='loading ui-scroll-popup ui-widget-content' id='scroll_g"+ts.p.id+"'></div>"),$(gv).css("width",grid.width+"px"),thead=$("thead:first",ts).get(0);var tfoot="";ts.p.footerrow&&(tfoot+="<table role='presentation' style='width:"+ts.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+dir+"'>");var thr=$("tr:first",thead),firstr="<tr class='jqgfirstrow' role='row' style='height:auto'>";if(ts.p.disableClick=!1,$("th",thr).each(function(j){w=ts.p.colModel[j].width,void 0===ts.p.colModel[j].resizable&&(ts.p.colModel[j].resizable=!0),ts.p.colModel[j].resizable?(res=document.createElement("span"),$(res).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+dir).css("cursor","col-resize"),$(this).addClass(ts.p.resizeclass)):res="",$(this).css("width",w+"px").prepend(res),res=null;var hdcol="";ts.p.colModel[j].hidden&&($(this).css("display","none"),hdcol="display:none;"),firstr+="<td role='gridcell' style='height:0px;width:"+w+"px;"+hdcol+"'></td>",grid.headers[j]={width:w,el:this},sort=ts.p.colModel[j].sortable,"boolean"!=typeof sort&&(ts.p.colModel[j].sortable=!0,sort=!0);var nm=ts.p.colModel[j].name;"cb"!==nm&&"subgrid"!==nm&&"rn"!==nm&&ts.p.viewsortcols[2]&&$(">div",this).addClass("ui-jqgrid-sortable"),sort&&(ts.p.multiSort?ts.p.viewsortcols[0]?($("div span.s-ico",this).show(),ts.p.colModel[j].lso&&$("div span.ui-icon-"+ts.p.colModel[j].lso,this).removeClass("ui-state-disabled")):ts.p.colModel[j].lso&&($("div span.s-ico",this).show(),$("div span.ui-icon-"+ts.p.colModel[j].lso,this).removeClass("ui-state-disabled")):ts.p.viewsortcols[0]?($("div span.s-ico",this).show(),j===ts.p.lastsort&&$("div span.ui-icon-"+ts.p.sortorder,this).removeClass("ui-state-disabled")):j===ts.p.lastsort&&""!==ts.p.sortname&&($("div span.s-ico",this).show(),$("div span.ui-icon-"+ts.p.sortorder,this).removeClass("ui-state-disabled"))),ts.p.footerrow&&(tfoot+="<td role='gridcell' "+formatCol(j,0,"",null,"",!1)+">&#160;</td>")}).mousedown(function(e){if(1===$(e.target).closest("th>span.ui-jqgrid-resize").length){var ci=getColumnHeaderIndex(this);return ts.p.forceFit===!0&&(ts.p.nv=nextVisible(ci)),grid.dragStart(ci,e,getOffset(ci)),!1}}).click(function(e){if(ts.p.disableClick)return ts.p.disableClick=!1,!1;var r,d,s="th>div.ui-jqgrid-sortable";ts.p.viewsortcols[2]||(s="th>div>span>span.ui-grid-ico-sort");var t=$(e.target).closest(s);if(1===t.length){var ci;if(ts.p.frozenColumns){var tid=$(this)[0].id.substring(ts.p.id.length+1);$(ts.p.colModel).each(function(i){return this.name===tid?(ci=i,!1):void 0})}else ci=getColumnHeaderIndex(this);return ts.p.viewsortcols[2]||(r=!0,d=t.attr("sort")),null!=ci&&sortData($("div",this)[0].id,ci,r,d,this),!1}}),ts.p.sortable&&$.fn.sortable)try{$(ts).jqGrid("sortableColumns",thr)}catch(e){}ts.p.footerrow&&(tfoot+="</tr></tbody></table>"),firstr+="</tr>",tbody=document.createElement("tbody"),this.appendChild(tbody),$(this).addClass("ui-jqgrid-btable").append(firstr),firstr=null;var hTable=$("<table class='ui-jqgrid-htable' style='width:"+ts.p.tblwidth+"px' role='presentation' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(thead),hg=ts.p.caption&&ts.p.hiddengrid===!0?!0:!1,hb=$("<div class='ui-jqgrid-hbox"+("rtl"===dir?"-rtl":"")+"'></div>");thead=null,grid.hDiv=document.createElement("div"),$(grid.hDiv).css({width:grid.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(hb),$(hb).append(hTable),hTable=null,hg&&$(grid.hDiv).hide(),ts.p.pager&&("string"==typeof ts.p.pager?"#"!==ts.p.pager.substr(0,1)&&(ts.p.pager="#"+ts.p.pager):ts.p.pager="#"+$(ts.p.pager).attr("id"),$(ts.p.pager).css({width:grid.width+"px"}).addClass("ui-state-default ui-jqgrid-pager ui-corner-bottom").appendTo(eg),hg&&$(ts.p.pager).hide(),setPager(ts.p.pager,"")),ts.p.cellEdit===!1&&ts.p.hoverrows===!0&&$(ts).bind("mouseover",function(e){ptr=$(e.target).closest("tr.jqgrow"),"ui-subgrid"!==$(ptr).attr("class")&&$(ptr).addClass("ui-state-hover")}).bind("mouseout",function(e){ptr=$(e.target).closest("tr.jqgrow"),$(ptr).removeClass("ui-state-hover")});var ri,ci,tdHtml;$(ts).before(grid.hDiv).click(function(e){if(td=e.target,ptr=$(td,ts.rows).closest("tr.jqgrow"),0===$(ptr).length||ptr[0].className.indexOf("ui-state-disabled")>-1||($(td,ts).closest("table.ui-jqgrid-btable").attr("id")||"").replace("_frozen","")!==ts.id)return this;var scb=$(td).hasClass("cbox"),cSel=$(ts).triggerHandler("jqGridBeforeSelectRow",[ptr[0].id,e]);if(cSel=cSel===!1||"stop"===cSel?!1:!0,$.isFunction(ts.p.beforeSelectRow)){var allowRowSelect=ts.p.beforeSelectRow.call(ts,ptr[0].id,e);(allowRowSelect===!1||"stop"===allowRowSelect)&&(cSel=!1)}if("A"!==td.tagName&&("INPUT"!==td.tagName&&"TEXTAREA"!==td.tagName&&"OPTION"!==td.tagName&&"SELECT"!==td.tagName||scb)){if(ri=ptr[0].id,td=$(td).closest("tr.jqgrow>td"),td.length>0&&(ci=$.jgrid.getCellIndex(td),tdHtml=$(td).closest("td,th").html(),$(ts).triggerHandler("jqGridCellSelect",[ri,ci,tdHtml,e]),$.isFunction(ts.p.onCellSelect)&&ts.p.onCellSelect.call(ts,ri,ci,tdHtml,e)),ts.p.cellEdit===!0)if(ts.p.multiselect&&scb&&cSel)$(ts).jqGrid("setSelection",ri,!0,e);else if(td.length>0&&1!=ci){ri=ptr[0].rowIndex;try{$(ts).jqGrid("editCell",ri,ci,!0)}catch(_){}}if(cSel)if(ts.p.multikey)e[ts.p.multikey]?$(ts).jqGrid("setSelection",ri,!0,e):ts.p.multiselect&&scb&&(scb=$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+ri).is(":checked"),$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+ri)[ts.p.useProp?"prop":"attr"]("checked",scb));else if(ts.p.multiselect&&ts.p.multiboxonly)if(scb)$(ts).jqGrid("setSelection",ri,!0,e);else{var frz=ts.p.frozenColumns?ts.p.id+"_frozen":"";$(ts.p.selarrrow).each(function(i,n){var trid=$(ts).jqGrid("getGridRowById",n);trid&&$(trid).removeClass("ui-state-highlight"),$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(n))[ts.p.useProp?"prop":"attr"]("checked",!1),frz&&($("#"+$.jgrid.jqID(n),"#"+$.jgrid.jqID(frz)).removeClass("ui-state-highlight"),$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(n),"#"+$.jgrid.jqID(frz))[ts.p.useProp?"prop":"attr"]("checked",!1))}),ts.p.selarrrow=[],$(ts).jqGrid("setSelection",ri,!0,e)}else $(ts).jqGrid("setSelection",ri,!0,e)}}).bind("reloadGrid",function(e,opts){if(ts.p.treeGrid===!0&&(ts.p.datatype=ts.p.treedatatype),opts&&opts.current&&ts.grid.selectionPreserver(ts),"local"===ts.p.datatype?($(ts).jqGrid("resetSelection"),ts.p.data.length&&(normalizeData(),refreshIndex())):ts.p.treeGrid||(ts.p.selrow=null,ts.p.multiselect&&(ts.p.selarrrow=[],setHeadCheckBox(!1)),ts.p.savedRow=[]),ts.p.scroll&&emptyRows.call(ts,!0,!1),opts&&opts.page){var page=opts.page;page>ts.p.lastpage&&(page=ts.p.lastpage),1>page&&(page=1),ts.p.page=page,ts.grid.prevRowHeight?ts.grid.bDiv.scrollTop=(page-1)*ts.grid.prevRowHeight*ts.p.rowNum:ts.grid.bDiv.scrollTop=0}return ts.grid.prevRowHeight&&ts.p.scroll?(delete ts.p.lastpage,ts.grid.populateVisible()):ts.grid.populate(),ts.p.inlineNav===!0&&$(ts).jqGrid("showAddEditButtons"),!1}).dblclick(function(e){if(td=e.target,ptr=$(td,ts.rows).closest("tr.jqgrow"),0!==$(ptr).length){ri=ptr[0].rowIndex,ci=$.jgrid.getCellIndex(td);var dbcr=$(ts).triggerHandler("jqGridDblClickRow",[$(ptr).attr("id"),ri,ci,e]);return null!=dbcr?dbcr:$.isFunction(ts.p.ondblClickRow)&&(dbcr=ts.p.ondblClickRow.call(ts,$(ptr).attr("id"),ri,ci,e),null!=dbcr)?dbcr:void 0}}).bind("contextmenu",function(e){if(td=e.target,ptr=$(td,ts.rows).closest("tr.jqgrow"),0!==$(ptr).length){ts.p.multiselect||$(ts).jqGrid("setSelection",ptr[0].id,!0,e),ri=ptr[0].rowIndex,ci=$.jgrid.getCellIndex(td);var rcr=$(ts).triggerHandler("jqGridRightClickRow",[$(ptr).attr("id"),ri,ci,e]);return null!=rcr?rcr:$.isFunction(ts.p.onRightClickRow)&&(rcr=ts.p.onRightClickRow.call(ts,$(ptr).attr("id"),ri,ci,e),null!=rcr)?rcr:void 0}}),grid.bDiv=document.createElement("div"),isMSIE&&"auto"===String(ts.p.height).toLowerCase()&&(ts.p.height="100%"),$(grid.bDiv).append($('<div style="position:relative;"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:ts.p.height+(isNaN(ts.p.height)?"":"px"),width:grid.width+"px"}).scroll(grid.scrollGrid),$("table:first",grid.bDiv).css({width:ts.p.tblwidth+"px"}),$.support.tbody||2===$("tbody",this).length&&$("tbody:gt(0)",this).remove(),ts.p.multikey&&($.jgrid.msie?$(grid.bDiv).bind("selectstart",function(){return!1}):$(grid.bDiv).bind("mousedown",function(){return!1})),hg&&$(grid.bDiv).hide(),grid.cDiv=document.createElement("div");var arf=ts.p.hidegrid===!0?$("<a role='link' class='ui-jqgrid-titlebar-close ui-corner-all HeaderButton' title='"+($.jgrid.getRegional(ts,"defaults.showhide",ts.p.showhide)||"")+"' />").hover(function(){arf.addClass("ui-state-hover")},function(){arf.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css("rtl"===dir?"left":"right","0px"):"";if($(grid.cDiv).append(arf).append("<span class='ui-jqgrid-title'>"+ts.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-jqgrid-caption"+("rtl"===dir?"-rtl":"")+" ui-widget-header ui-corner-top ui-helper-clearfix"),$(grid.cDiv).insertBefore(grid.hDiv),ts.p.toolbar[0]&&(grid.uDiv=document.createElement("div"),"top"===ts.p.toolbar[1]?$(grid.uDiv).insertBefore(grid.hDiv):"bottom"===ts.p.toolbar[1]&&$(grid.uDiv).insertAfter(grid.hDiv),"both"===ts.p.toolbar[1]?(grid.ubDiv=document.createElement("div"),$(grid.uDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id).insertBefore(grid.hDiv),$(grid.ubDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id).insertAfter(grid.hDiv),hg&&$(grid.ubDiv).hide()):$(grid.uDiv).width(grid.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id),hg&&$(grid.uDiv).hide()),ts.p.toppager&&(ts.p.toppager=$.jgrid.jqID(ts.p.id)+"_toppager",grid.topDiv=$("<div id='"+ts.p.toppager+"'></div>")[0],ts.p.toppager="#"+ts.p.toppager,$(grid.topDiv).addClass("ui-state-default ui-jqgrid-toppager").width(grid.width).insertBefore(grid.hDiv),setPager(ts.p.toppager,"_t")),ts.p.footerrow&&(grid.sDiv=$("<div class='ui-jqgrid-sdiv'></div>")[0],hb=$("<div class='ui-jqgrid-hbox"+("rtl"===dir?"-rtl":"")+"'></div>"),$(grid.sDiv).append(hb).width(grid.width).insertAfter(grid.hDiv),$(hb).append(tfoot),grid.footers=$(".ui-jqgrid-ftable",grid.sDiv)[0].rows[0].cells,ts.p.rownumbers&&(grid.footers[0].className="ui-state-default jqgrid-rownum"),hg&&$(grid.sDiv).hide()),hb=null,ts.p.caption){var tdt=ts.p.datatype;ts.p.hidegrid===!0&&($(".ui-jqgrid-titlebar-close",grid.cDiv).click(function(e){var counter,onHdCl=$.isFunction(ts.p.onHeaderClick),elems=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",self=this;return ts.p.toolbar[0]===!0&&("both"===ts.p.toolbar[1]&&(elems+=", #"+$(grid.ubDiv).attr("id")),elems+=", #"+$(grid.uDiv).attr("id")),counter=$(elems,"#gview_"+$.jgrid.jqID(ts.p.id)).length,"visible"===ts.p.gridstate?$(elems,"#gbox_"+$.jgrid.jqID(ts.p.id)).slideUp("fast",function(){counter--,0===counter&&($("span",self).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),ts.p.gridstate="hidden",$("#gbox_"+$.jgrid.jqID(ts.p.id)).hasClass("ui-resizable")&&$(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(ts.p.id)).hide(),$(ts).triggerHandler("jqGridHeaderClick",[ts.p.gridstate,e]),onHdCl&&(hg||ts.p.onHeaderClick.call(ts,ts.p.gridstate,e)))}):"hidden"===ts.p.gridstate&&$(elems,"#gbox_"+$.jgrid.jqID(ts.p.id)).slideDown("fast",function(){counter--,0===counter&&($("span",self).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),hg&&(ts.p.datatype=tdt,populate(),hg=!1),ts.p.gridstate="visible",$("#gbox_"+$.jgrid.jqID(ts.p.id)).hasClass("ui-resizable")&&$(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(ts.p.id)).show(),$(ts).triggerHandler("jqGridHeaderClick",[ts.p.gridstate,e]),onHdCl&&(hg||ts.p.onHeaderClick.call(ts,ts.p.gridstate,e)))}),!1}),hg&&(ts.p.datatype="local",$(".ui-jqgrid-titlebar-close",grid.cDiv).trigger("click")))}else $(grid.cDiv).hide(),ts.p.toppager||$(grid.hDiv).addClass("ui-corner-top");$(grid.hDiv).after(grid.bDiv).mousemove(function(e){return grid.resizing?(grid.dragMove(e),!1):void 0}),$(".ui-jqgrid-labels",grid.hDiv).bind("selectstart",function(){return!1}),$(document).bind("mouseup.jqGrid"+ts.p.id,function(){return grid.resizing?(grid.dragEnd(),!1):!0}),ts.formatCol=formatCol,ts.sortData=sortData,ts.updatepager=updatepager,ts.refreshIndex=refreshIndex,ts.setHeadCheckBox=setHeadCheckBox,ts.constructTr=constructTr,ts.formatter=function(rowId,cellval,colpos,rwdat,act){return formatter(rowId,cellval,colpos,rwdat,act)},$.extend(grid,{populate:populate,emptyRows:emptyRows,beginReq:beginReq,endReq:endReq}),this.grid=grid,ts.addXmlData=function(d){addXmlData(d)},ts.addJSONData=function(d){addJSONData(d)},this.grid.cols=this.rows[0].cells,$(ts).triggerHandler("jqGridInitGrid"),$.isFunction(ts.p.onInitGrid)&&ts.p.onInitGrid.call(ts),populate(),ts.p.hiddengrid=!1}})},$.jgrid.extend({getGridParam:function(name,module){var ret,$t=this[0];if($t&&$t.grid){if(void 0===module&&"string"!=typeof module&&(module="jqGrid"),ret=$t.p,"jqGrid"!==module)try{ret=$($t).data(module)}catch(e){ret=$t.p}return name?void 0!==ret[name]?ret[name]:null:ret}},setGridParam:function(newParams,overwrite){return this.each(function(){if(null==overwrite&&(overwrite=!1),this.grid&&"object"==typeof newParams)if(overwrite===!0){var params=$.extend({},this.p,newParams);this.p=params}else $.extend(!0,this.p,newParams)})},getGridRowById:function(rowid){var row;return this.each(function(){try{for(var i=this.rows.length;i--;)if(rowid.toString()===this.rows[i].id){row=this.rows[i];break}}catch(e){row=$(this.grid.bDiv).find("#"+$.jgrid.jqID(rowid))}}),row},getDataIDs:function(){var len,ids=[],i=0,j=0;return this.each(function(){if(len=this.rows.length,len&&len>0)for(;len>i;)$(this.rows[i]).hasClass("jqgrow")&&(ids[j]=this.rows[i].id,j++),i++}),ids},setSelection:function(selection,onsr,e){return this.each(function(){function scrGrid(iR){var ch=$($t.grid.bDiv)[0].clientHeight,st=$($t.grid.bDiv)[0].scrollTop,rpos=$($t.rows[iR]).position().top,rh=$t.rows[iR].clientHeight;rpos+rh>=ch+st?$($t.grid.bDiv)[0].scrollTop=rpos-(ch+st)+rh+st:ch+st>rpos&&st>rpos&&($($t.grid.bDiv)[0].scrollTop=rpos)}var stat,pt,ner,ia,tpsr,fid,csr,$t=this;void 0!==selection&&(onsr=onsr===!1?!1:!0,pt=$($t).jqGrid("getGridRowById",selection),!pt||!pt.className||pt.className.indexOf("ui-state-disabled")>-1||($t.p.scrollrows===!0&&(ner=$($t).jqGrid("getGridRowById",selection).rowIndex,ner>=0&&scrGrid(ner)),$t.p.frozenColumns===!0&&(fid=$t.p.id+"_frozen"),$t.p.multiselect?($t.setHeadCheckBox(!1),$t.p.selrow=pt.id,ia=$.inArray($t.p.selrow,$t.p.selarrrow),-1===ia?("ui-subgrid"!==pt.className&&$(pt).addClass("ui-state-highlight").attr("aria-selected","true"),stat=!0,$t.p.selarrrow.push($t.p.selrow)):("ui-subgrid"!==pt.className&&$(pt).removeClass("ui-state-highlight").attr("aria-selected","false"),stat=!1,$t.p.selarrrow.splice(ia,1),tpsr=$t.p.selarrrow[0],$t.p.selrow=void 0===tpsr?null:tpsr),$("#jqg_"+$.jgrid.jqID($t.p.id)+"_"+$.jgrid.jqID(pt.id))[$t.p.useProp?"prop":"attr"]("checked",stat),fid&&(-1===ia?$("#"+$.jgrid.jqID(selection),"#"+$.jgrid.jqID(fid)).addClass("ui-state-highlight"):$("#"+$.jgrid.jqID(selection),"#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight"),$("#jqg_"+$.jgrid.jqID($t.p.id)+"_"+$.jgrid.jqID(selection),"#"+$.jgrid.jqID(fid))[$t.p.useProp?"prop":"attr"]("checked",stat)),onsr&&($($t).triggerHandler("jqGridSelectRow",[pt.id,stat,e]),$t.p.onSelectRow&&$t.p.onSelectRow.call($t,pt.id,stat,e))):"ui-subgrid"!==pt.className&&($t.p.selrow!==pt.id?(csr=$($t).jqGrid("getGridRowById",$t.p.selrow),csr&&$(csr).removeClass("ui-state-highlight").attr({"aria-selected":"false",tabindex:"-1"}),$(pt).addClass("ui-state-highlight").attr({"aria-selected":"true",tabindex:"0"}),fid&&($("#"+$.jgrid.jqID($t.p.selrow),"#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight"),$("#"+$.jgrid.jqID(selection),"#"+$.jgrid.jqID(fid)).addClass("ui-state-highlight")),stat=!0):stat=!1,$t.p.selrow=pt.id,onsr&&($($t).triggerHandler("jqGridSelectRow",[pt.id,stat,e]),$t.p.onSelectRow&&$t.p.onSelectRow.call($t,pt.id,stat,e)))))})},resetSelection:function(rowid){return this.each(function(){var sr,fid,t=this;if(t.p.frozenColumns===!0&&(fid=t.p.id+"_frozen"),void 0!==rowid){if(sr=rowid===t.p.selrow?t.p.selrow:rowid,$("#"+$.jgrid.jqID(t.p.id)+" tbody:first tr#"+$.jgrid.jqID(sr)).removeClass("ui-state-highlight").attr("aria-selected","false"),fid&&$("#"+$.jgrid.jqID(sr),"#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight"),t.p.multiselect){$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(sr),"#"+$.jgrid.jqID(t.p.id))[t.p.useProp?"prop":"attr"]("checked",!1),fid&&$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(sr),"#"+$.jgrid.jqID(fid))[t.p.useProp?"prop":"attr"]("checked",!1),t.setHeadCheckBox(!1);var ia=$.inArray($.jgrid.jqID(sr),t.p.selarrrow);-1!==ia&&t.p.selarrrow.splice(ia,1)}sr=null}else t.p.multiselect?($(t.p.selarrrow).each(function(i,n){$($(t).jqGrid("getGridRowById",n)).removeClass("ui-state-highlight").attr("aria-selected","false"),$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(n))[t.p.useProp?"prop":"attr"]("checked",!1),fid&&($("#"+$.jgrid.jqID(n),"#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight"),$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(n),"#"+$.jgrid.jqID(fid))[t.p.useProp?"prop":"attr"]("checked",!1))}),t.setHeadCheckBox(!1),t.p.selarrrow=[],t.p.selrow=null):t.p.selrow&&($("#"+$.jgrid.jqID(t.p.id)+" tbody:first tr#"+$.jgrid.jqID(t.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false"),fid&&$("#"+$.jgrid.jqID(t.p.selrow),"#"+$.jgrid.jqID(fid)).removeClass("ui-state-highlight"),t.p.selrow=null);t.p.cellEdit===!0&&parseInt(t.p.iCol,10)>=0&&parseInt(t.p.iRow,10)>=0&&($("td:eq("+t.p.iCol+")",t.rows[t.p.iRow]).removeClass("edit-cell ui-state-highlight"),$(t.rows[t.p.iRow]).removeClass("selected-row ui-state-hover")),t.p.savedRow=[]})},getRowData:function(rowid,usedata){var resall,len,res={},getall=!1,j=0;return this.each(function(){var nm,ind,$t=this;if(null==rowid)getall=!0,resall=[],len=$t.rows.length;else{if(ind=$($t).jqGrid("getGridRowById",rowid),!ind)return res;len=2}for(usedata&&usedata===!0&&$t.p.data.length>0||(usedata=!1);len>j;)getall&&(ind=$t.rows[j]),$(ind).hasClass("jqgrow")&&(usedata?res=$t.p.data[$t.p._index[ind.id]]:$('td[role="gridcell"]',ind).each(function(i){if(nm=$t.p.colModel[i].name,"cb"!==nm&&"subgrid"!==nm&&"rn"!==nm)if($t.p.treeGrid===!0&&nm===$t.p.ExpandColumn)res[nm]=$.jgrid.htmlDecode($("span:first",this).html());else try{res[nm]=$.unformat.call($t,this,{rowId:ind.id,colModel:$t.p.colModel[i]},i)}catch(e){res[nm]=$.jgrid.htmlDecode($(this).html())}}),getall&&(resall.push(res),res={})),j++}),resall||res},delRowData:function(rowid){var rowInd,ia,nextRow,success=!1;return this.each(function(){var $t=this;if(rowInd=$($t).jqGrid("getGridRowById",rowid),!rowInd)return!1;if($t.p.subGrid&&(nextRow=$(rowInd).next(),nextRow.hasClass("ui-subgrid")&&nextRow.remove()),$(rowInd).remove(),$t.p.records--,$t.p.reccount--,$t.updatepager(!0,!1),success=!0,$t.p.multiselect&&(ia=$.inArray(rowid,$t.p.selarrrow),-1!==ia&&$t.p.selarrrow.splice(ia,1)),$t.p.multiselect&&$t.p.selarrrow.length>0?$t.p.selrow=$t.p.selarrrow[$t.p.selarrrow.length-1]:$t.p.selrow=null,"local"===$t.p.datatype){var id=$.jgrid.stripPref($t.p.idPrefix,rowid),pos=$t.p._index[id];void 0!==pos&&($t.p.data.splice(pos,1),$t.refreshIndex())}if($t.p.altRows===!0&&success){var cn=$t.p.altclass;$($t.rows).each(function(i){i%2===1?$(this).addClass(cn):$(this).removeClass(cn)})}}),success},setRowData:function(rowid,data,cssp){var nm,title,success=!0;return this.each(function(){if(!this.grid)return!1;var vl,ind,t=this,cp=typeof cssp,lcdata={};if(ind=$(this).jqGrid("getGridRowById",rowid),!ind)return!1;if(data)try{if($(this.p.colModel).each(function(i){nm=this.name;var dval=$.jgrid.getAccessor(data,nm);void 0!==dval&&(lcdata[nm]=this.formatter&&"string"==typeof this.formatter&&"date"===this.formatter?$.unformat.date.call(t,dval,this):dval,vl=t.formatter(rowid,lcdata[nm],i,data,"edit"),title=this.title?{title:$.jgrid.stripHtml(vl)}:{},t.p.treeGrid===!0&&nm===t.p.ExpandColumn?$("td[role='gridcell']:eq("+i+") > span:first",ind).html(vl).attr(title):$("td[role='gridcell']:eq("+i+")",ind).html(vl).attr(title))}),"local"===t.p.datatype){var key,id=$.jgrid.stripPref(t.p.idPrefix,rowid),pos=t.p._index[id];if(t.p.treeGrid)for(key in t.p.treeReader)t.p.treeReader.hasOwnProperty(key)&&delete lcdata[t.p.treeReader[key]];void 0!==pos&&(t.p.data[pos]=$.extend(!0,t.p.data[pos],lcdata)),lcdata=null}}catch(e){success=!1}success&&("string"===cp?$(ind).addClass(cssp):null!==cssp&&"object"===cp&&$(ind).css(cssp),$(t).triggerHandler("jqGridAfterGridComplete"))}),success},addRowData:function(rowid,rdata,pos,src){-1==["first","last","before","after"].indexOf(pos)&&(pos="last");var nm,row,gi,si,ni,sind,i,v,aradd,cnm,cn,data,cm,id,success=!1,prp="";return rdata&&($.isArray(rdata)?(aradd=!0,cnm=rowid):(rdata=[rdata],aradd=!1),this.each(function(){var t=this,datalen=rdata.length;ni=t.p.rownumbers===!0?1:0,gi=t.p.multiselect===!0?1:0,si=t.p.subGrid===!0?1:0,aradd||(void 0!==rowid?rowid=String(rowid):(rowid=$.jgrid.randId(),t.p.keyName!==!1&&(cnm=t.p.keyName,void 0!==rdata[0][cnm]&&(rowid=rdata[0][cnm])))),cn=t.p.altclass;for(var k=0,cna="",lcdata={},air=$.isFunction(t.p.afterInsertRow)?!0:!1;datalen>k;){if(data=rdata[k],row=[],aradd){try{rowid=data[cnm],void 0===rowid&&(rowid=$.jgrid.randId())}catch(e){rowid=$.jgrid.randId()}cna=t.p.altRows===!0&&(t.rows.length-1)%2===0?cn:""}for(id=rowid,rowid=t.p.idPrefix+rowid,ni&&(prp=t.formatCol(0,1,"",null,rowid,!0),row[row.length]='<td role="gridcell" class="ui-state-default jqgrid-rownum" '+prp+">0</td>"),gi&&(v='<input role="checkbox" type="checkbox" id="jqg_'+t.p.id+"_"+rowid+'" class="cbox"/>',prp=t.formatCol(ni,1,"",null,rowid,!0),row[row.length]='<td role="gridcell" '+prp+">"+v+"</td>"),si&&(row[row.length]=$(t).jqGrid("addSubGridCell",gi+ni,1)),i=gi+si+ni;i<t.p.colModel.length;i++)cm=t.p.colModel[i],nm=cm.name,lcdata[nm]=data[nm],v=t.formatter(rowid,$.jgrid.getAccessor(data,nm),i,data),prp=t.formatCol(i,1,v,data,rowid,lcdata),row[row.length]='<td role="gridcell" '+prp+">"+v+"</td>";if(row.unshift(t.constructTr(rowid,!1,cna,lcdata,data,!1)),row[row.length]="</tr>",0===t.rows.length)$("table:first",t.grid.bDiv).append(row.join(""));else switch(pos){case"last":$(t.rows[t.rows.length-1]).after(row.join("")),sind=t.rows.length-1;break;case"first":$(t.rows[0]).after(row.join("")),sind=1;break;case"after":sind=$(t).jqGrid("getGridRowById",src),sind&&($(t.rows[sind.rowIndex+1]).hasClass("ui-subgrid")?$(t.rows[sind.rowIndex+1]).after(row):$(sind).after(row.join("")),sind=sind.rowIndex+1);break;case"before":sind=$(t).jqGrid("getGridRowById",src),sind&&($(sind).before(row.join("")),sind=sind.rowIndex-1)}t.p.subGrid===!0&&$(t).jqGrid("addSubGrid",gi+ni,sind),t.p.records++,t.p.reccount++,$(t).triggerHandler("jqGridAfterInsertRow",[rowid,data,data]),air&&t.p.afterInsertRow.call(t,rowid,data,data),k++,"local"===t.p.datatype&&(lcdata[t.p.localReader.id]=id,t.p._index[id]=t.p.data.length,t.p.data.push(lcdata),lcdata={})}t.p.altRows!==!0||aradd||("last"===pos?(t.rows.length-1)%2===1&&$(t.rows[t.rows.length-1]).addClass(cn):$(t.rows).each(function(i){i%2===1?$(this).addClass(cn):$(this).removeClass(cn)})),t.updatepager(!0,!0),
success=!0})),success},footerData:function(action,data,format){function isEmpty(obj){var i;for(i in obj)if(obj.hasOwnProperty(i))return!1;return!0}var nm,title,success=!1,res={};return void 0===action&&(action="get"),"boolean"!=typeof format&&(format=!0),action=action.toLowerCase(),this.each(function(){var vl,t=this;return t.grid&&t.p.footerrow?"set"===action&&isEmpty(data)?!1:(success=!0,void $(this.p.colModel).each(function(i){nm=this.name,"set"===action?void 0!==data[nm]&&(vl=format?t.formatter("",data[nm],i,data,"edit"):data[nm],title=this.title?{title:$.jgrid.stripHtml(vl)}:{},$("tr.footrow td:eq("+i+")",t.grid.sDiv).html(vl).attr(title),success=!0):"get"===action&&(res[nm]=$("tr.footrow td:eq("+i+")",t.grid.sDiv).html())})):!1}),"get"===action?res:success},showHideCol:function(colname,show){return this.each(function(){var cw,$t=this,fndh=!1,brd=$.jgrid.cell_width?0:$t.p.cellLayout;if($t.grid){"string"==typeof colname&&(colname=[colname]),show="none"!==show?"":"none";var sw=""===show?!0:!1,gh=$t.p.groupHeader&&("object"==typeof $t.p.groupHeader||$.isFunction($t.p.groupHeader));gh&&$($t).jqGrid("destroyGroupHeader",!1),$(this.p.colModel).each(function(i){if(-1!==$.inArray(this.name,colname)&&this.hidden===sw){if($t.p.frozenColumns===!0&&this.frozen===!0)return!0;$("tr[role=row]",$t.grid.hDiv).each(function(){$(this.cells[i]).css("display",show)}),$($t.rows).each(function(){$(this).hasClass("jqgroup")||$(this.cells[i]).css("display",show)}),$t.p.footerrow&&$("tr.footrow td:eq("+i+")",$t.grid.sDiv).css("display",show),cw=parseInt(this.width,10),"none"===show?$t.p.tblwidth-=cw+brd:$t.p.tblwidth+=cw+brd,this.hidden=!sw,fndh=!0,$($t).triggerHandler("jqGridShowHideCol",[sw,this.name,i])}}),fndh===!0&&($t.p.shrinkToFit!==!0||isNaN($t.p.height)||($t.p.tblwidth+=parseInt($t.p.scrollOffset,10)),$($t).jqGrid("setGridWidth",$t.p.shrinkToFit===!0?$t.p.tblwidth:$t.p.width)),gh&&$($t).jqGrid("setGroupHeaders",$t.p.groupHeader)}})},hideCol:function(colname){return this.each(function(){$(this).jqGrid("showHideCol",colname,"none")})},showCol:function(colname){return this.each(function(){$(this).jqGrid("showHideCol",colname,"")})},remapColumns:function(permutation,updateCells,keepHeader){function resortArray(a){var ac;ac=a.length?$.makeArray(a):$.extend({},a),$.each(permutation,function(i){a[i]=ac[this]})}function resortRows(parent,clobj){$(">tr"+(clobj||""),parent).each(function(){var row=this,elems=$.makeArray(row.cells);$.each(permutation,function(){var e=elems[this];e&&row.appendChild(e)})})}var ts=this.get(0);resortArray(ts.p.colModel),resortArray(ts.p.colNames),resortArray(ts.grid.headers),resortRows($("thead:first",ts.grid.hDiv),keepHeader&&":not(.ui-jqgrid-labels)"),updateCells&&resortRows($("#"+$.jgrid.jqID(ts.p.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot"),ts.p.footerrow&&resortRows($("tbody:first",ts.grid.sDiv)),ts.p.remapColumns&&(ts.p.remapColumns.length?resortArray(ts.p.remapColumns):ts.p.remapColumns=$.makeArray(permutation)),ts.p.lastsort=$.inArray(ts.p.lastsort,permutation),ts.p.treeGrid&&(ts.p.expColInd=$.inArray(ts.p.expColInd,permutation)),$(ts).triggerHandler("jqGridRemapColumns",[permutation,updateCells,keepHeader])},setGridWidth:function(nwidth,shrink){return this.each(function(){if(this.grid){var cw,lvc,aw,cr,$t=this,initwidth=0,brd=$.jgrid.cell_width?0:$t.p.cellLayout,vc=0,hs=!1,scw=$t.p.scrollOffset,gw=0;if("boolean"!=typeof shrink&&(shrink=$t.p.shrinkToFit),!isNaN(nwidth)){if(nwidth=parseInt(nwidth,10),$t.grid.width=$t.p.width=nwidth,$("#gbox_"+$.jgrid.jqID($t.p.id)).css("width",nwidth+"px"),$("#gview_"+$.jgrid.jqID($t.p.id)).css("width",nwidth+"px"),$($t.grid.bDiv).css("width",nwidth+"px"),$($t.grid.hDiv).css("width",nwidth+"px"),$t.p.pager&&$($t.p.pager).css("width",nwidth+"px"),$t.p.toppager&&$($t.p.toppager).css("width",nwidth+"px"),$t.p.toolbar[0]===!0&&($($t.grid.uDiv).css("width",nwidth+"px"),"both"===$t.p.toolbar[1]&&$($t.grid.ubDiv).css("width",nwidth+"px")),$t.p.footerrow&&$($t.grid.sDiv).css("width",nwidth+"px"),shrink===!1&&$t.p.forceFit===!0&&($t.p.forceFit=!1),shrink===!0){if($.each($t.p.colModel,function(){this.hidden===!1&&(cw=this.widthOrg,initwidth+=cw+brd,this.fixed?gw+=cw+brd:vc++)}),0===vc)return;$t.p.tblwidth=initwidth,aw=nwidth-brd*vc-gw,isNaN($t.p.height)||($($t.grid.bDiv)[0].clientHeight<$($t.grid.bDiv)[0].scrollHeight||1===$t.rows.length)&&(hs=!0,aw-=scw),initwidth=0;var cle=$t.grid.cols.length>0;if($.each($t.p.colModel,function(i){if(this.hidden===!1&&!this.fixed){if(cw=this.widthOrg,cw=Math.round(aw*cw/($t.p.tblwidth-brd*vc-gw)),0>cw)return;this.width=cw,initwidth+=cw,$t.grid.headers[i].width=cw,$t.grid.headers[i].el.style.width=cw+"px",$t.p.footerrow&&($t.grid.footers[i].style.width=cw+"px"),cle&&($t.grid.cols[i].style.width=cw+"px"),lvc=i}}),!lvc)return;if(cr=0,hs?nwidth-gw-(initwidth+brd*vc)!==scw&&(cr=nwidth-gw-(initwidth+brd*vc)-scw):1!==Math.abs(nwidth-gw-(initwidth+brd*vc))&&(cr=nwidth-gw-(initwidth+brd*vc)),$t.p.colModel[lvc].width+=cr,$t.p.tblwidth=initwidth+cr+brd*vc+gw,$t.p.tblwidth>nwidth){var delta=$t.p.tblwidth-parseInt(nwidth,10);$t.p.tblwidth=nwidth,cw=$t.p.colModel[lvc].width=$t.p.colModel[lvc].width-delta}else cw=$t.p.colModel[lvc].width;$t.grid.headers[lvc].width=cw,$t.grid.headers[lvc].el.style.width=cw+"px",cle&&($t.grid.cols[lvc].style.width=cw+"px"),$t.p.footerrow&&($t.grid.footers[lvc].style.width=cw+"px")}$t.p.tblwidth&&($("table:first",$t.grid.bDiv).css("width",$t.p.tblwidth+"px"),$("table:first",$t.grid.hDiv).css("width",$t.p.tblwidth+"px"),$t.grid.hDiv.scrollLeft=$t.grid.bDiv.scrollLeft,$t.p.footerrow&&$("table:first",$t.grid.sDiv).css("width",$t.p.tblwidth+"px"))}}})},setGridHeight:function(nh){return this.each(function(){var $t=this;if($t.grid){var bDiv=$($t.grid.bDiv);bDiv.css({height:nh+(isNaN(nh)?"":"px")}),$t.p.frozenColumns===!0&&$("#"+$.jgrid.jqID($t.p.id)+"_frozen").parent().height(bDiv.height()-16),$t.p.height=nh,$t.p.scroll&&$t.grid.populateVisible()}})},setCaption:function(newcap){return this.each(function(){this.p.caption=newcap,$("span.ui-jqgrid-title, span.ui-jqgrid-title-rtl",this.grid.cDiv).html(newcap),$(this.grid.cDiv).show(),$(this.grid.hDiv).removeClass("ui-corner-top")})},setLabel:function(colname,nData,prop,attrp){return this.each(function(){var $t=this,pos=-1;if($t.grid&&void 0!==colname&&($($t.p.colModel).each(function(i){return this.name===colname?(pos=i,!1):void 0}),pos>=0)){var thecol=$("tr.ui-jqgrid-labels th:eq("+pos+")",$t.grid.hDiv);if(nData){var ico=$(".s-ico",thecol);$("[id^=jqgh_]",thecol).empty().html(nData).append(ico),$t.p.colNames[pos]=nData}prop&&("string"==typeof prop?$(thecol).addClass(prop):$(thecol).css(prop)),"object"==typeof attrp&&$(thecol).attr(attrp)}})},setCell:function(rowid,colname,nData,cssp,attrp,forceupd){return this.each(function(){var v,title,$t=this,pos=-1;if($t.grid&&(isNaN(colname)?$($t.p.colModel).each(function(i){return this.name===colname?(pos=i,!1):void 0}):pos=parseInt(colname,10),pos>=0)){var ind=$($t).jqGrid("getGridRowById",rowid);if(ind){var tcell=$("td:eq("+pos+")",ind),cl=0,rawdat=[];if(""!==nData||forceupd===!0){if(void 0!==ind.cells)for(;cl<ind.cells.length;)rawdat.push(ind.cells[cl].innerHTML),cl++;if(v=$t.formatter(rowid,nData,pos,rawdat,"edit"),title=$t.p.colModel[pos].title?{title:$.jgrid.stripHtml(v)}:{},$t.p.treeGrid&&$(".tree-wrap",$(tcell)).length>0?$("span",$(tcell)).html(v).attr(title):$(tcell).html(v).attr(title),"local"===$t.p.datatype){var index,cm=$t.p.colModel[pos];nData=cm.formatter&&"string"==typeof cm.formatter&&"date"===cm.formatter?$.unformat.date.call($t,nData,cm):nData,index=$t.p._index[$.jgrid.stripPref($t.p.idPrefix,rowid)],void 0!==index&&($t.p.data[index][cm.name]=nData)}}"string"==typeof cssp?$(tcell).addClass(cssp):cssp&&$(tcell).css(cssp),"object"==typeof attrp&&$(tcell).attr(attrp)}}})},getCell:function(rowid,col){var ret=!1;return this.each(function(){var $t=this,pos=-1;if($t.grid&&(isNaN(col)?$($t.p.colModel).each(function(i){return this.name===col?(pos=i,!1):void 0}):pos=parseInt(col,10),pos>=0)){var ind=$($t).jqGrid("getGridRowById",rowid);if(ind)try{ret=$.unformat.call($t,$("td:eq("+pos+")",ind),{rowId:ind.id,colModel:$t.p.colModel[pos]},pos)}catch(e){ret=$.jgrid.htmlDecode($("td:eq("+pos+")",ind).html())}}}),ret},getCol:function(col,obj,mathopr){var val,min,max,v,ret=[],sum=0;return obj="boolean"!=typeof obj?!1:obj,void 0===mathopr&&(mathopr=!1),this.each(function(){var $t=this,pos=-1;if($t.grid&&(isNaN(col)?$($t.p.colModel).each(function(i){return this.name===col?(pos=i,!1):void 0}):pos=parseInt(col,10),pos>=0)){var ln=$t.rows.length,i=0,dlen=0;if(ln&&ln>0){for(;ln>i;){if($($t.rows[i]).hasClass("jqgrow")){try{val=$.unformat.call($t,$($t.rows[i].cells[pos]),{rowId:$t.rows[i].id,colModel:$t.p.colModel[pos]},pos)}catch(e){val=$.jgrid.htmlDecode($t.rows[i].cells[pos].innerHTML)}mathopr?(v=parseFloat(val),isNaN(v)||(sum+=v,void 0===max&&(max=min=v),min=Math.min(min,v),max=Math.max(max,v),dlen++)):ret.push(obj?{id:$t.rows[i].id,value:val}:val)}i++}if(mathopr)switch(mathopr.toLowerCase()){case"sum":ret=sum;break;case"avg":ret=sum/dlen;break;case"count":ret=ln-1;break;case"min":ret=min;break;case"max":ret=max}}}}),ret},clearGridData:function(clearfooter){return this.each(function(){var $t=this;if($t.grid){if("boolean"!=typeof clearfooter&&(clearfooter=!1),$t.p.deepempty)$("#"+$.jgrid.jqID($t.p.id)+" tbody:first tr:gt(0)").remove();else{var trf=$("#"+$.jgrid.jqID($t.p.id)+" tbody:first tr:first")[0];$("#"+$.jgrid.jqID($t.p.id)+" tbody:first").empty().append(trf)}$t.p.footerrow&&clearfooter&&$(".ui-jqgrid-ftable td",$t.grid.sDiv).html("&#160;"),$t.p.selrow=null,$t.p.selarrrow=[],$t.p.savedRow=[],$t.p.records=0,$t.p.page=1,$t.p.lastpage=0,$t.p.reccount=0,$t.p.data=[],$t.p._index={},$t.updatepager(!0,!1)}})},getInd:function(rowid,rc){var rw,ret=!1;return this.each(function(){rw=$(this).jqGrid("getGridRowById",rowid),rw&&(ret=rc===!0?rw:rw.rowIndex)}),ret},bindKeys:function(settings){var o=$.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:!0},settings||{});return this.each(function(){var $t=this;$("body").is("[role]")||$("body").attr("role","application"),$t.p.scrollrows=o.scrollingRows,$($t).keydown(function(event){var id,r,mind,target=$($t).find("tr[tabindex=0]")[0],expanded=$t.p.treeReader.expanded_field;if(target)if(mind=$t.p._index[$.jgrid.stripPref($t.p.idPrefix,target.id)],37===event.keyCode||38===event.keyCode||39===event.keyCode||40===event.keyCode){if(38===event.keyCode){if(r=target.previousSibling,id="",r)if($(r).is(":hidden")){for(;r;)if(r=r.previousSibling,!$(r).is(":hidden")&&$(r).hasClass("jqgrow")){id=r.id;break}}else id=r.id;$($t).jqGrid("setSelection",id,!0,event),event.preventDefault()}if(40===event.keyCode){if(r=target.nextSibling,id="",r)if($(r).is(":hidden")){for(;r;)if(r=r.nextSibling,!$(r).is(":hidden")&&$(r).hasClass("jqgrow")){id=r.id;break}}else id=r.id;$($t).jqGrid("setSelection",id,!0,event),event.preventDefault()}37===event.keyCode&&($t.p.treeGrid&&$t.p.data[mind][expanded]&&$(target).find("div.treeclick").trigger("click"),$($t).triggerHandler("jqGridKeyLeft",[$t.p.selrow]),$.isFunction(o.onLeftKey)&&o.onLeftKey.call($t,$t.p.selrow)),39===event.keyCode&&($t.p.treeGrid&&!$t.p.data[mind][expanded]&&$(target).find("div.treeclick").trigger("click"),$($t).triggerHandler("jqGridKeyRight",[$t.p.selrow]),$.isFunction(o.onRightKey)&&o.onRightKey.call($t,$t.p.selrow))}else 13===event.keyCode?($($t).triggerHandler("jqGridKeyEnter",[$t.p.selrow]),$.isFunction(o.onEnter)&&o.onEnter.call($t,$t.p.selrow)):32===event.keyCode&&($($t).triggerHandler("jqGridKeySpace",[$t.p.selrow]),$.isFunction(o.onSpace)&&o.onSpace.call($t,$t.p.selrow))})})},unbindKeys:function(){return this.each(function(){$(this).unbind("keydown")})},getLocalRow:function(rowid){var ind,ret=!1;return this.each(function(){void 0!==rowid&&(ind=this.p._index[$.jgrid.stripPref(this.p.idPrefix,rowid)],ind>=0&&(ret=this.p.data[ind]))}),ret},progressBar:function(p){return p=$.extend({htmlcontent:"",method:"hide",loadtype:"disable"},p||{}),this.each(function(){var sh="show"===p.method?!0:!1;switch(""!==p.htmlcontent&&$("#load_"+$.jgrid.jqID(this.p.id)).html(p.htmlcontent),p.loadtype){case"disable":break;case"enable":$("#load_"+$.jgrid.jqID(this.p.id)).toggle(sh);break;case"block":$("#lui_"+$.jgrid.jqID(this.p.id)).toggle(sh),$("#load_"+$.jgrid.jqID(this.p.id)).toggle(sh)}})},getColProp:function(colname){var ret={},$t=this[0];if(!$t.grid)return!1;var i,cM=$t.p.colModel;for(i=0;i<cM.length;i++)if(cM[i].name===colname){ret=cM[i];break}return ret},setColProp:function(colname,obj){return this.each(function(){if(this.grid&&obj){var i,cM=this.p.colModel;for(i=0;i<cM.length;i++)if(cM[i].name===colname){$.extend(!0,this.p.colModel[i],obj);break}}})},sortGrid:function(colname,reload,sor){return this.each(function(){var i,$t=this,idx=-1,sobj=!1;if($t.grid){for(colname||(colname=$t.p.sortname),i=0;i<$t.p.colModel.length;i++)if($t.p.colModel[i].index===colname||$t.p.colModel[i].name===colname){idx=i,$t.p.frozenColumns===!0&&$t.p.colModel[i].frozen===!0&&(sobj=$t.grid.fhDiv.find("#"+$t.p.id+"_"+colname));break}if(-1!==idx){var sort=$t.p.colModel[idx].sortable;sobj||(sobj=$t.grid.headers[idx].el),"boolean"!=typeof sort&&(sort=!0),"boolean"!=typeof reload&&(reload=!1),sort&&$t.sortData("jqgh_"+$t.p.id+"_"+colname,idx,reload,sor,sobj)}}})},setGridState:function(state){return this.each(function(){if(this.grid){var $t=this;"hidden"===state?($(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+$.jgrid.jqID($t.p.id)).slideUp("fast"),$t.p.pager&&$($t.p.pager).slideUp("fast"),$t.p.toppager&&$($t.p.toppager).slideUp("fast"),$t.p.toolbar[0]===!0&&("both"===$t.p.toolbar[1]&&$($t.grid.ubDiv).slideUp("fast"),$($t.grid.uDiv).slideUp("fast")),$t.p.footerrow&&$(".ui-jqgrid-sdiv","#gbox_"+$.jgrid.jqID($t.p.id)).slideUp("fast"),$(".ui-jqgrid-titlebar-close span",$t.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),$t.p.gridstate="hidden"):"visible"===state&&($(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+$.jgrid.jqID($t.p.id)).slideDown("fast"),$t.p.pager&&$($t.p.pager).slideDown("fast"),$t.p.toppager&&$($t.p.toppager).slideDown("fast"),$t.p.toolbar[0]===!0&&("both"===$t.p.toolbar[1]&&$($t.grid.ubDiv).slideDown("fast"),$($t.grid.uDiv).slideDown("fast")),$t.p.footerrow&&$(".ui-jqgrid-sdiv","#gbox_"+$.jgrid.jqID($t.p.id)).slideDown("fast"),$(".ui-jqgrid-titlebar-close span",$t.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),$t.p.gridstate="visible")}})},setFrozenColumns:function(){return this.each(function(){if(this.grid){var $t=this,cm=$t.p.colModel,i=0,len=cm.length,maxfrozen=-1,frozen=!1;for($t.p.rownumbers&&i++,$t.p.multiselect&&i++;len>i&&cm[i].frozen===!0;)frozen=!0,maxfrozen=i,i++;if(maxfrozen>=0&&frozen){var top=$t.p.caption?$($t.grid.cDiv).outerHeight():0,hth=$(".ui-jqgrid-htable","#gview_"+$.jgrid.jqID($t.p.id)).height();$t.p.toppager&&(top+=$($t.grid.topDiv).outerHeight()),$t.p.toolbar[0]===!0&&"bottom"!==$t.p.toolbar[1]&&(top+=$($t.grid.uDiv).outerHeight()),$t.grid.fhDiv=$('<div style="position:absolute;left:0px;top:'+top+"px;height:"+hth+'px;" class="frozen-div ui-state-default ui-jqgrid-hdiv"></div>'),$t.grid.fbDiv=$('<div style="position:absolute;left:0px;top:'+(parseInt(top,10)+parseInt(hth,10)+1)+'px;overflow-y:hidden" class="frozen-bdiv ui-jqgrid-bdiv"></div>'),$("#gview_"+$.jgrid.jqID($t.p.id)).append($t.grid.fhDiv);var htbl=$(".ui-jqgrid-htable","#gview_"+$.jgrid.jqID($t.p.id)).clone(!0);if($t.p.groupHeader){$("tr.jqg-first-row-header, tr.jqg-third-row-header",htbl).each(function(){$("th:gt("+maxfrozen+")",this).remove()});var cs,rs,swapfroz=-1,fdel=-1;$("tr.jqg-second-row-header th",htbl).each(function(){return cs=parseInt($(this).attr("colspan"),10),rs=parseInt($(this).attr("rowspan"),10),rs&&(swapfroz++,fdel++),cs&&(swapfroz+=cs,fdel++),swapfroz===maxfrozen?!1:void 0}),swapfroz!==maxfrozen&&(fdel=maxfrozen),$("tr.jqg-second-row-header",htbl).each(function(){$("th:gt("+fdel+")",this).remove()})}else $("tr",htbl).each(function(){$("th:gt("+maxfrozen+")",this).remove()});if($(htbl).width(1),$($t.grid.fhDiv).append(htbl).mousemove(function(e){return $t.grid.resizing?($t.grid.dragMove(e),!1):void 0}),$t.p.footerrow){var hbd=$(".ui-jqgrid-bdiv","#gview_"+$.jgrid.jqID($t.p.id)).height();$t.grid.fsDiv=$('<div style="position:absolute;left:0px;top:'+(parseInt(top,10)+parseInt(hth,10)+parseInt(hbd,10)+1)+'px;" class="frozen-sdiv ui-jqgrid-sdiv"></div>'),$("#gview_"+$.jgrid.jqID($t.p.id)).append($t.grid.fsDiv);var ftbl=$(".ui-jqgrid-ftable","#gview_"+$.jgrid.jqID($t.p.id)).clone(!0);$("tr",ftbl).each(function(){$("td:gt("+maxfrozen+")",this).remove()}),$(ftbl).width(1),$($t.grid.fsDiv).append(ftbl)}$($t).bind("jqGridResizeStop.setFrozenColumns",function(e,w,index){var rhth=$(".ui-jqgrid-htable",$t.grid.fhDiv);$("th:eq("+index+")",rhth).width(w);var btd=$(".ui-jqgrid-btable",$t.grid.fbDiv);if($("tr:first td:eq("+index+")",btd).width(w),$t.p.footerrow){var ftd=$(".ui-jqgrid-ftable",$t.grid.fsDiv);$("tr:first td:eq("+index+")",ftd).width(w)}}),$($t).bind("jqGridSortCol.setFrozenColumns",function(e,index,idxcol){var previousSelectedTh=$("tr.ui-jqgrid-labels:last th:eq("+$t.p.lastsort+")",$t.grid.fhDiv),newSelectedTh=$("tr.ui-jqgrid-labels:last th:eq("+idxcol+")",$t.grid.fhDiv);$("span.ui-grid-ico-sort",previousSelectedTh).addClass("ui-state-disabled"),$(previousSelectedTh).attr("aria-selected","false"),$("span.ui-icon-"+$t.p.sortorder,newSelectedTh).removeClass("ui-state-disabled"),$(newSelectedTh).attr("aria-selected","true"),$t.p.viewsortcols[0]||$t.p.lastsort!==idxcol&&($("span.s-ico",previousSelectedTh).hide(),$("span.s-ico",newSelectedTh).show())}),$("#gview_"+$.jgrid.jqID($t.p.id)).append($t.grid.fbDiv),$($t.grid.bDiv).scroll(function(){$($t.grid.fbDiv).scrollTop($(this).scrollTop())}),$t.p.hoverrows===!0&&$("#"+$.jgrid.jqID($t.p.id)).unbind("mouseover").unbind("mouseout"),$($t).bind("jqGridAfterGridComplete.setFrozenColumns",function(){$("#"+$.jgrid.jqID($t.p.id)+"_frozen").remove(),$($t.grid.fbDiv).height($($t.grid.bDiv).height()-16);var btbl=$("#"+$.jgrid.jqID($t.p.id)).clone(!0);$("tr[role=row]",btbl).each(function(){$("td[role=gridcell]:gt("+maxfrozen+")",this).remove()}),$(btbl).width(1).attr("id",$t.p.id+"_frozen"),$($t.grid.fbDiv).append(btbl),$t.p.hoverrows===!0&&($("tr.jqgrow",btbl).hover(function(){$(this).addClass("ui-state-hover"),$("#"+$.jgrid.jqID(this.id),"#"+$.jgrid.jqID($t.p.id)).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover"),$("#"+$.jgrid.jqID(this.id),"#"+$.jgrid.jqID($t.p.id)).removeClass("ui-state-hover")}),$("tr.jqgrow","#"+$.jgrid.jqID($t.p.id)).hover(function(){$(this).addClass("ui-state-hover"),$("#"+$.jgrid.jqID(this.id),"#"+$.jgrid.jqID($t.p.id)+"_frozen").addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover"),$("#"+$.jgrid.jqID(this.id),"#"+$.jgrid.jqID($t.p.id)+"_frozen").removeClass("ui-state-hover")})),btbl=null}),$t.grid.hDiv.loading||$($t).triggerHandler("jqGridAfterGridComplete"),$t.p.frozenColumns=!0}}})},destroyFrozenColumns:function(){return this.each(function(){if(this.grid&&this.p.frozenColumns===!0){var $t=this;if($($t.grid.fhDiv).remove(),$($t.grid.fbDiv).remove(),$t.grid.fhDiv=null,$t.grid.fbDiv=null,$t.p.footerrow&&($($t.grid.fsDiv).remove(),$t.grid.fsDiv=null),$(this).unbind(".setFrozenColumns"),$t.p.hoverrows===!0){var ptr;$("#"+$.jgrid.jqID($t.p.id)).bind("mouseover",function(e){ptr=$(e.target).closest("tr.jqgrow"),"ui-subgrid"!==$(ptr).attr("class")&&$(ptr).addClass("ui-state-hover")}).bind("mouseout",function(e){ptr=$(e.target).closest("tr.jqgrow"),$(ptr).removeClass("ui-state-hover")})}this.p.frozenColumns=!1}})}}),$.jgrid.extend({editCell:function(iRow,iCol,ed){return this.each(function(){var nm,tmp,cc,cm,$t=this;if($t.grid&&$t.p.cellEdit===!0){if(iCol=parseInt(iCol,10),$t.p.selrow=$t.rows[iRow].id,$t.p.knv||$($t).jqGrid("GridNav"),$t.p.savedRow.length>0){if(ed===!0&&iRow==$t.p.iRow&&iCol==$t.p.iCol)return;$($t).jqGrid("saveCell",$t.p.savedRow[0].id,$t.p.savedRow[0].ic)}else window.setTimeout(function(){$("#"+$.jgrid.jqID($t.p.knv)).attr("tabindex","-1").focus()},1);if(cm=$t.p.colModel[iCol],nm=cm.name,"subgrid"!==nm&&"cb"!==nm&&"rn"!==nm){if(cc=$("td:eq("+iCol+")",$t.rows[iRow]),cm.editable!==!0||ed!==!0||cc.hasClass("not-editable-cell")||$.isFunction($t.p.isCellEditable)&&!$t.p.isCellEditable.call($t,nm,iRow,iCol))parseInt($t.p.iCol,10)>=0&&parseInt($t.p.iRow,10)>=0&&($("td:eq("+$t.p.iCol+")",$t.rows[$t.p.iRow]).removeClass("edit-cell ui-state-highlight"),$($t.rows[$t.p.iRow]).removeClass("selected-row ui-state-hover")),cc.addClass("edit-cell ui-state-highlight"),$($t.rows[iRow]).addClass("selected-row ui-state-hover"),tmp=cc.html().replace(/\&#160\;/gi,""),$($t).triggerHandler("jqGridSelectCell",[$t.rows[iRow].id,nm,tmp,iRow,iCol]),$.isFunction($t.p.onSelectCell)&&$t.p.onSelectCell.call($t,$t.rows[iRow].id,nm,tmp,iRow,iCol);else{parseInt($t.p.iCol,10)>=0&&parseInt($t.p.iRow,10)>=0&&($("td:eq("+$t.p.iCol+")",$t.rows[$t.p.iRow]).removeClass("edit-cell ui-state-highlight"),$($t.rows[$t.p.iRow]).removeClass("selected-row ui-state-hover")),$(cc).addClass("edit-cell ui-state-highlight"),$($t.rows[iRow]).addClass("selected-row ui-state-hover");try{tmp=$.unformat.call($t,cc,{rowId:$t.rows[iRow].id,colModel:cm},iCol)}catch(_){tmp=cm.edittype&&"textarea"===cm.edittype?$(cc).text():$(cc).html()}if($t.p.autoencode&&(tmp=$.jgrid.htmlDecode(tmp)),cm.edittype||(cm.edittype="text"),$t.p.savedRow.push({id:iRow,ic:iCol,name:nm,v:tmp}),("&nbsp;"===tmp||"&#160;"===tmp||1===tmp.length&&160===tmp.charCodeAt(0))&&(tmp=""),$.isFunction($t.p.formatCell)){var tmp2=$t.p.formatCell.call($t,$t.rows[iRow].id,nm,tmp,iRow,iCol);void 0!==tmp2&&(tmp=tmp2)}$($t).triggerHandler("jqGridBeforeEditCell",[$t.rows[iRow].id,nm,tmp,iRow,iCol]),$.isFunction($t.p.beforeEditCell)&&$t.p.beforeEditCell.call($t,$t.rows[iRow].id,nm,tmp,iRow,iCol);var opt=$.extend({},cm.editoptions||{},{id:iRow+"_"+nm,name:nm,rowId:$t.rows[iRow].id,oper:"edit"}),elc=$.jgrid.createEl.call($t,cm.edittype,opt,tmp,!0,$.extend({},$.jgrid.ajaxOptions,$t.p.ajaxSelectOptions||{}));$(cc).html("").append(elc).attr("tabindex","0"),$.jgrid.bindEv.call($t,elc,opt),window.setTimeout(function(){$(elc).focus()},1),$("input, select, textarea",cc).bind("keydown",function(e){if(27===e.keyCode&&($("input.hasDatepicker",cc).length>0?$(".ui-datepicker").is(":hidden")?$($t).jqGrid("restoreCell",iRow,iCol):$("input.hasDatepicker",cc).datepicker("hide"):$($t).jqGrid("restoreCell",iRow,iCol)),13===e.keyCode&&!e.shiftKey)return $($t).jqGrid("saveCell",iRow,iCol),!1;if(9===e.keyCode){if($t.grid.hDiv.loading)return!1;e.shiftKey?$($t).jqGrid("prevCell",iRow,iCol):$($t).jqGrid("nextCell",iRow,iCol)}e.stopPropagation()}),$($t).triggerHandler("jqGridAfterEditCell",[$t.rows[iRow].id,nm,tmp,iRow,iCol]),$.isFunction($t.p.afterEditCell)&&$t.p.afterEditCell.call($t,$t.rows[iRow].id,nm,tmp,iRow,iCol)}$t.p.iCol=iCol,$t.p.iRow=iRow}}})},saveCell:function(iRow,iCol){return this.each(function(){var fr,$t=this,errors=$.jgrid.getRegional(this,"errors"),edit=$.jgrid.getRegional(this,"edit");if($t.grid&&$t.p.cellEdit===!0){if(fr=$t.p.savedRow.length>=1?0:null,null!==fr){var v,v2,cc=$("td:eq("+iCol+")",$t.rows[iRow]),cm=$t.p.colModel[iCol],nm=cm.name,nmjq=$.jgrid.jqID(nm);switch(cm.edittype){case"select":if(cm.editoptions.multiple){var sel=$("#"+iRow+"_"+nmjq,$t.rows[iRow]),selectedText=[];v=$(sel).val(),v?v.join(","):v="",$("option:selected",sel).each(function(i,selected){selectedText[i]=$(selected).text()}),v2=selectedText.join(",")}else v=$("#"+iRow+"_"+nmjq+" option:selected",$t.rows[iRow]).val(),v2=$("#"+iRow+"_"+nmjq+" option:selected",$t.rows[iRow]).text();cm.formatter&&(v2=v);break;case"checkbox":var cbv=["Yes","No"];cm.editoptions&&(cbv=cm.editoptions.value.split(":")),v=$("#"+iRow+"_"+nmjq,$t.rows[iRow]).is(":checked")?cbv[0]:cbv[1],v2=v;break;case"password":case"text":case"textarea":case"button":v=$("#"+iRow+"_"+nmjq,$t.rows[iRow]).val(),v2=v;break;case"custom":try{if(!cm.editoptions||!$.isFunction(cm.editoptions.custom_value))throw"e1";if(v=cm.editoptions.custom_value.call($t,$(".customelement",cc),"get"),void 0===v)throw"e2";v2=v}catch(e){"e1"===e&&$.jgrid.info_dialog(errors.errcap,"function 'custom_value' "+edit.msg.nodefined,edit.bClose),"e2"===e?$.jgrid.info_dialog(errors.errcap,"function 'custom_value' "+edit.msg.novalue,edit.bClose):$.jgrid.info_dialog(errors.errcap,e.message,edit.bClose)}}if(v2!==$t.p.savedRow[fr].v){var vvv=$($t).triggerHandler("jqGridBeforeSaveCell",[$t.rows[iRow].id,nm,v,iRow,iCol]);if(vvv&&(v=vvv,v2=vvv),$.isFunction($t.p.beforeSaveCell)){var vv=$t.p.beforeSaveCell.call($t,$t.rows[iRow].id,nm,v,iRow,iCol);vv&&(v=vv,v2=vv)}var cv=$.jgrid.checkValues.call($t,v,iCol);if(cv[0]===!0){var addpost=$($t).triggerHandler("jqGridBeforeSubmitCell",[$t.rows[iRow].id,nm,v,iRow,iCol])||{};if($.isFunction($t.p.beforeSubmitCell)&&(addpost=$t.p.beforeSubmitCell.call($t,$t.rows[iRow].id,nm,v,iRow,iCol),addpost||(addpost={})),$("input.hasDatepicker",cc).length>0&&$("input.hasDatepicker",cc).datepicker("hide"),"remote"===$t.p.cellsubmit)if($t.p.cellurl){var postdata={};$t.p.autoencode&&(v=$.jgrid.htmlEncode(v)),postdata[nm]=v;var idname,oper,opers;opers=$t.p.prmNames,idname=opers.id,oper=opers.oper,postdata[idname]=$.jgrid.stripPref($t.p.idPrefix,$t.rows[iRow].id),postdata[oper]=opers.editoper,postdata=$.extend(addpost,postdata),$($t).jqGrid("progressBar",{method:"show",loadtype:$t.p.loadui,htmlcontent:$.jgrid.getRegional($t,"defaults.savetext")}),$t.grid.hDiv.loading=!0,$.ajax($.extend({url:$t.p.cellurl,data:$.isFunction($t.p.serializeCellData)?$t.p.serializeCellData.call($t,postdata):postdata,type:"POST",complete:function(result,stat){if($($t).jqGrid("progressBar",{method:"hide",loadtype:$t.p.loadui}),$t.grid.hDiv.loading=!1,"success"===stat){var ret=$($t).triggerHandler("jqGridAfterSubmitCell",[$t,result,postdata.id,nm,v,iRow,iCol])||[!0,""];ret[0]===!0&&$.isFunction($t.p.afterSubmitCell)&&(ret=$t.p.afterSubmitCell.call($t,result,postdata.id,nm,v,iRow,iCol)),ret[0]===!0?($(cc).empty(),$($t).jqGrid("setCell",$t.rows[iRow].id,iCol,v2,!1,!1,!0),$(cc).addClass("dirty-cell"),$($t.rows[iRow]).addClass("edited"),$($t).triggerHandler("jqGridAfterSaveCell",[$t.rows[iRow].id,nm,v,iRow,iCol]),$.isFunction($t.p.afterSaveCell)&&$t.p.afterSaveCell.call($t,$t.rows[iRow].id,nm,v,iRow,iCol),$t.p.savedRow.splice(0,1)):($.jgrid.info_dialog(errors.errcap,ret[1],edit.bClose),$($t).jqGrid("restoreCell",iRow,iCol))}},error:function(res,stat,err){$("#lui_"+$.jgrid.jqID($t.p.id)).hide(),$t.grid.hDiv.loading=!1,$($t).triggerHandler("jqGridErrorCell",[res,stat,err]),$.isFunction($t.p.errorCell)?($t.p.errorCell.call($t,res,stat,err),$($t).jqGrid("restoreCell",iRow,iCol)):($.jgrid.info_dialog(errors.errcap,res.status+" : "+res.statusText+"<br/>"+stat,edit.bClose),$($t).jqGrid("restoreCell",iRow,iCol))}},$.jgrid.ajaxOptions,$t.p.ajaxCellOptions||{}))}else try{$.jgrid.info_dialog(errors.errcap,errors.nourl,edit.bClose),$($t).jqGrid("restoreCell",iRow,iCol)}catch(e){}"clientArray"===$t.p.cellsubmit&&($(cc).empty(),$($t).jqGrid("setCell",$t.rows[iRow].id,iCol,v2,!1,!1,!0),$(cc).addClass("dirty-cell"),$($t.rows[iRow]).addClass("edited"),$($t).triggerHandler("jqGridAfterSaveCell",[$t.rows[iRow].id,nm,v,iRow,iCol]),$.isFunction($t.p.afterSaveCell)&&$t.p.afterSaveCell.call($t,$t.rows[iRow].id,nm,v,iRow,iCol),$t.p.savedRow.splice(0,1))}else try{window.setTimeout(function(){$.jgrid.info_dialog(errors.errcap,v+" "+cv[1],edit.bClose)},100),$($t).jqGrid("restoreCell",iRow,iCol)}catch(e){}}else $($t).jqGrid("restoreCell",iRow,iCol)}window.setTimeout(function(){$("#"+$.jgrid.jqID($t.p.knv)).attr("tabindex","-1").focus()},0)}})},restoreCell:function(iRow,iCol){return this.each(function(){var fr,$t=this;if($t.grid&&$t.p.cellEdit===!0){if(fr=$t.p.savedRow.length>=1?0:null,null!==fr){var cc=$("td:eq("+iCol+")",$t.rows[iRow]);if($.isFunction($.fn.datepicker))try{$("input.hasDatepicker",cc).datepicker("hide")}catch(e){}$(cc).empty().attr("tabindex","-1"),$($t).jqGrid("setCell",$t.rows[iRow].id,iCol,$t.p.savedRow[fr].v,!1,!1,!0),$($t).triggerHandler("jqGridAfterRestoreCell",[$t.rows[iRow].id,$t.p.savedRow[fr].v,iRow,iCol]),$.isFunction($t.p.afterRestoreCell)&&$t.p.afterRestoreCell.call($t,$t.rows[iRow].id,$t.p.savedRow[fr].v,iRow,iCol),$t.p.savedRow.splice(0,1)}window.setTimeout(function(){$("#"+$t.p.knv).attr("tabindex","-1").focus()},0)}})},nextCell:function(iRow,iCol){return this.each(function(){var i,$t=this,nCol=!1;if($t.grid&&$t.p.cellEdit===!0){for(i=iCol+1;i<$t.p.colModel.length;i++)if($t.p.colModel[i].editable===!0&&(!$.isFunction($t.p.isCellEditable)||$t.p.isCellEditable.call($t,$t.p.colModel[i].name,iRow,i))){nCol=i;break}nCol!==!1?$($t).jqGrid("editCell",iRow,nCol,!0):$t.p.savedRow.length>0&&$($t).jqGrid("saveCell",iRow,iCol)}})},prevCell:function(iRow,iCol){return this.each(function(){var i,$t=this,nCol=!1;if($t.grid&&$t.p.cellEdit===!0){for(i=iCol-1;i>=0;i--)if($t.p.colModel[i].editable===!0&&(!$.isFunction($t.p.isCellEditable)||$t.p.isCellEditable.call($t,$t.p.colModel[i].name,iRow,i))){nCol=i;break}nCol!==!1?$($t).jqGrid("editCell",iRow,nCol,!0):$t.p.savedRow.length>0&&$($t).jqGrid("saveCell",iRow,iCol)}})},GridNav:function(){return this.each(function(){function scrollGrid(iR,iC,tp){if("v"===tp.substr(0,1)){var ch=$($t.grid.bDiv)[0].clientHeight,st=$($t.grid.bDiv)[0].scrollTop,nROT=$t.rows[iR].offsetTop+$t.rows[iR].clientHeight,pROT=$t.rows[iR].offsetTop;"vd"===tp&&nROT>=ch&&($($t.grid.bDiv)[0].scrollTop=$($t.grid.bDiv)[0].scrollTop+$t.rows[iR].clientHeight),"vu"===tp&&st>pROT&&($($t.grid.bDiv)[0].scrollTop=$($t.grid.bDiv)[0].scrollTop-$t.rows[iR].clientHeight)}if("h"===tp){var cw=$($t.grid.bDiv)[0].clientWidth,sl=$($t.grid.bDiv)[0].scrollLeft,nCOL=$t.rows[iR].cells[iC].offsetLeft+$t.rows[iR].cells[iC].clientWidth,pCOL=$t.rows[iR].cells[iC].offsetLeft;nCOL>=cw+parseInt(sl,10)?$($t.grid.bDiv)[0].scrollLeft=$($t.grid.bDiv)[0].scrollLeft+$t.rows[iR].cells[iC].clientWidth:sl>pCOL&&($($t.grid.bDiv)[0].scrollLeft=$($t.grid.bDiv)[0].scrollLeft-$t.rows[iR].cells[iC].clientWidth)}}function findNextVisible(iC,act){var ind,i;if("lft"===act)for(ind=iC+1,i=iC;i>=0;i--)if($t.p.colModel[i].hidden!==!0){ind=i;break}if("rgt"===act)for(ind=iC-1,i=iC;i<$t.p.colModel.length;i++)if($t.p.colModel[i].hidden!==!0){ind=i;break}return ind}var $t=this;if($t.grid&&$t.p.cellEdit===!0){$t.p.knv=$t.p.id+"_kn";var i,kdir,selection=$("<div style='position:fixed;top:0px;width:1px;height:1px;' tabindex='0'><div tabindex='-1' style='width:1px;height:1px;' id='"+$t.p.knv+"'></div></div>");$(selection).insertBefore($t.grid.cDiv),$("#"+$t.p.knv).focus().keydown(function(e){switch(kdir=e.keyCode,"rtl"===$t.p.direction&&(37===kdir?kdir=39:39===kdir&&(kdir=37)),kdir){case 38:$t.p.iRow-1>0&&(scrollGrid($t.p.iRow-1,$t.p.iCol,"vu"),$($t).jqGrid("editCell",$t.p.iRow-1,$t.p.iCol,!1));break;case 40:$t.p.iRow+1<=$t.rows.length-1&&(scrollGrid($t.p.iRow+1,$t.p.iCol,"vd"),$($t).jqGrid("editCell",$t.p.iRow+1,$t.p.iCol,!1));break;case 37:$t.p.iCol-1>=0&&(i=findNextVisible($t.p.iCol-1,"lft"),scrollGrid($t.p.iRow,i,"h"),$($t).jqGrid("editCell",$t.p.iRow,i,!1));break;case 39:$t.p.iCol+1<=$t.p.colModel.length-1&&(i=findNextVisible($t.p.iCol+1,"rgt"),scrollGrid($t.p.iRow,i,"h"),$($t).jqGrid("editCell",$t.p.iRow,i,!1));break;case 13:parseInt($t.p.iCol,10)>=0&&parseInt($t.p.iRow,10)>=0&&$($t).jqGrid("editCell",$t.p.iRow,$t.p.iCol,!0);break;default:return!0}return!1})}})},getChangedCells:function(mthd){var ret=[];return mthd||(mthd="all"),this.each(function(){var nm,$t=this;$t.grid&&$t.p.cellEdit===!0&&$($t.rows).each(function(j){var res={};$(this).hasClass("edited")&&($("td",this).each(function(i){if(nm=$t.p.colModel[i].name,"cb"!==nm&&"subgrid"!==nm)if("dirty"===mthd){if($(this).hasClass("dirty-cell"))try{res[nm]=$.unformat.call($t,this,{rowId:$t.rows[j].id,colModel:$t.p.colModel[i]},i)}catch(e){res[nm]=$.jgrid.htmlDecode($(this).html());

}}else try{res[nm]=$.unformat.call($t,this,{rowId:$t.rows[j].id,colModel:$t.p.colModel[i]},i)}catch(e){res[nm]=$.jgrid.htmlDecode($(this).html())}}),res.id=this.id,ret.push(res))})}),ret}}),$.extend($.jgrid,{showModal:function(h){h.w.show()},closeModal:function(h){h.w.hide().attr("aria-hidden","true"),h.o&&h.o.remove()},hideModal:function(selector,o){o=$.extend({jqm:!0,gb:"",removemodal:!1,formprop:!1,form:""},o||{});var thisgrid=o.gb&&"string"==typeof o.gb&&"#gbox_"===o.gb.substr(0,6)?$("#"+o.gb.substr(6))[0]:!1;if(o.onClose){var oncret=thisgrid?o.onClose.call(thisgrid,selector):o.onClose(selector);if("boolean"==typeof oncret&&!oncret)return}if(o.formprop&&thisgrid&&o.form){var fh=$(selector)[0].style.height;fh.indexOf("px")>-1&&(fh=parseFloat(fh));var frmgr,frmdata;"edit"===o.form?(frmgr="#"+$.jgrid.jqID("FrmGrid_"+o.gb.substr(6)),frmdata="formProp"):"view"===o.form&&(frmgr="#"+$.jgrid.jqID("ViewGrid_"+o.gb.substr(6)),frmdata="viewProp"),$(thisgrid).data(frmdata,{top:parseFloat($(selector).css("top")),left:parseFloat($(selector).css("left")),width:$(selector).width(),height:fh,dataheight:$(frmgr).height(),datawidth:$(frmgr).width()})}if($.fn.jqm&&o.jqm===!0)$(selector).attr("aria-hidden","true").jqmHide();else{if(""!==o.gb)try{$(".jqgrid-overlay:first",o.gb).hide()}catch(e){}$(selector).hide().attr("aria-hidden","true")}o.removemodal&&$(selector).remove()},findPos:function(obj){var curleft=0,curtop=0;if(obj.offsetParent)do curleft+=obj.offsetLeft,curtop+=obj.offsetTop;while(obj=obj.offsetParent);return[curleft,curtop]},createModal:function(aIDs,content,p,insertSelector,posSelector,appendsel,css){p=$.extend(!0,{},$.jgrid.jqModal||{},p);var rtlsup,mw=document.createElement("div"),self=this;css=$.extend({},css||{}),rtlsup="rtl"===$(p.gbox).attr("dir")?!0:!1,mw.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog",mw.id=aIDs.themodal;var mh=document.createElement("div");mh.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix",mh.id=aIDs.modalhead,$(mh).append("<span class='ui-jqdialog-title'>"+p.caption+"</span>");var ahr=$("<a class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){ahr.addClass("ui-state-hover")},function(){ahr.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-closethick'></span>");$(mh).append(ahr),rtlsup?(mw.dir="rtl",$(".ui-jqdialog-title",mh).css("float","right"),$(".ui-jqdialog-titlebar-close",mh).css("left","0.3em")):(mw.dir="ltr",$(".ui-jqdialog-title",mh).css("float","left"),$(".ui-jqdialog-titlebar-close",mh).css("right","0.3em"));var mc=document.createElement("div");$(mc).addClass("ui-jqdialog-content ui-widget-content").attr("id",aIDs.modalcontent),$(mc).append(content),mw.appendChild(mc),$(mw).prepend(mh),appendsel===!0?$("body").append(mw):"string"==typeof appendsel?$(appendsel).append(mw):$(mw).insertBefore(insertSelector),$(mw).css(css),void 0===p.jqModal&&(p.jqModal=!0);var coord={};if($.fn.jqm&&p.jqModal===!0){if(0===p.left&&0===p.top&&p.overlay){var pos=[];pos=$.jgrid.findPos(posSelector),p.left=pos[0]+4,p.top=pos[1]+4}coord.top=p.top+"px",coord.left=p.left}else(0!==p.left||0!==p.top)&&(coord.left=p.left,coord.top=p.top+"px");if($("a.ui-jqdialog-titlebar-close",mh).click(function(){var oncm=$("#"+$.jgrid.jqID(aIDs.themodal)).data("onClose")||p.onClose,gboxclose=$("#"+$.jgrid.jqID(aIDs.themodal)).data("gbox")||p.gbox;return self.hideModal("#"+$.jgrid.jqID(aIDs.themodal),{gb:gboxclose,jqm:p.jqModal,onClose:oncm,removemodal:p.removemodal||!1,formprop:!p.recreateForm||!1,form:p.form||""}),!1}),0!==p.width&&p.width||(p.width=300),0!==p.height&&p.height||(p.height=200),!p.zIndex){var parentZ=$(insertSelector).parents("*[role=dialog]").filter(":first").css("z-index");parentZ?p.zIndex=parseInt(parentZ,10)+2:p.zIndex=950}var rtlt=0;if(rtlsup&&coord.left&&!appendsel&&(rtlt=$(p.gbox).width()-(isNaN(p.width)?0:parseInt(p.width,10))-8,coord.left=parseInt(coord.left,10)+parseInt(rtlt,10)),coord.left&&(coord.left+="px"),$(mw).css($.extend({width:isNaN(p.width)?"auto":p.width+"px",height:isNaN(p.height)?"auto":p.height+"px",zIndex:p.zIndex,overflow:"hidden"},coord)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":aIDs.modalhead,"aria-hidden":"true"}),void 0===p.drag&&(p.drag=!0),void 0===p.resize&&(p.resize=!0),p.drag)if($(mh).css("cursor","move"),$.fn.jqDrag)$(mw).jqDrag(mh);else try{$(mw).draggable({handle:$("#"+$.jgrid.jqID(mh.id))})}catch(e){}if(p.resize)if($.fn.jqResize)$(mw).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se'></div>"),$("#"+$.jgrid.jqID(aIDs.themodal)).jqResize(".jqResize",aIDs.scrollelm?"#"+$.jgrid.jqID(aIDs.scrollelm):!1);else try{$(mw).resizable({handles:"se, sw",alsoResize:aIDs.scrollelm?"#"+$.jgrid.jqID(aIDs.scrollelm):!1})}catch(r){}p.closeOnEscape===!0&&$(mw).keydown(function(e){if(27===e.which){var cone=$("#"+$.jgrid.jqID(aIDs.themodal)).data("onClose")||p.onClose;self.hideModal("#"+$.jgrid.jqID(aIDs.themodal),{gb:p.gbox,jqm:p.jqModal,onClose:cone,removemodal:p.removemodal||!1,formprop:!p.recreateForm||!1,form:p.form||""})}})},viewModal:function(selector,o){if(o=$.extend({toTop:!0,overlay:10,modal:!1,overlayClass:"ui-widget-overlay",onShow:$.jgrid.showModal,onHide:$.jgrid.closeModal,gbox:"",jqm:!0,jqM:!0},o||{}),$.fn.jqm&&o.jqm===!0)o.jqM?$(selector).attr("aria-hidden","false").jqm(o).jqmShow():$(selector).attr("aria-hidden","false").jqmShow();else{""!==o.gbox&&($(".jqgrid-overlay:first",o.gbox).show(),$(selector).data("gbox",o.gbox)),$(selector).show().attr("aria-hidden","false");try{$(":input:visible",selector)[0].focus()}catch(_){}}},info_dialog:function(caption,content,c_b,modalopt){var mopt={width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,left:250,top:170,zIndex:1e3,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]};$.extend(!0,mopt,$.jgrid.jqModal||{},{caption:"<b>"+caption+"</b>"},modalopt||{});var jm=mopt.jqModal,self=this;$.fn.jqm&&!jm&&(jm=!1);var i,buttstr="";if(mopt.buttons.length>0)for(i=0;i<mopt.buttons.length;i++)void 0===mopt.buttons[i].id&&(mopt.buttons[i].id="info_button_"+i),buttstr+="<a id='"+mopt.buttons[i].id+"' class='fm-button ui-state-default ui-corner-all'>"+mopt.buttons[i].text+"</a>";var dh=isNaN(mopt.dataheight)?mopt.dataheight:mopt.dataheight+"px",cn="text-align:"+mopt.align+";",cnt="<div id='info_id'>";cnt+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+dh+";"+cn+"'>"+content+"</div>",cnt+=c_b?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+mopt.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+c_b+"</a>"+buttstr+"</div>":""!==buttstr?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+mopt.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+buttstr+"</div>":"",cnt+="</div>";try{"false"===$("#info_dialog").attr("aria-hidden")&&$.jgrid.hideModal("#info_dialog",{jqm:jm}),$("#info_dialog").remove()}catch(e){}$.jgrid.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},cnt,mopt,"","",!0),buttstr&&$.each(mopt.buttons,function(i){$("#"+$.jgrid.jqID(this.id),"#info_id").bind("click",function(){return mopt.buttons[i].onClick.call($("#info_dialog")),!1})}),$("#closedialog","#info_id").click(function(){return self.hideModal("#info_dialog",{jqm:jm,onClose:$("#info_dialog").data("onClose")||mopt.onClose,gb:$("#info_dialog").data("gbox")||mopt.gbox}),!1}),$(".fm-button","#info_dialog").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}),$.isFunction(mopt.beforeOpen)&&mopt.beforeOpen(),$.jgrid.viewModal("#info_dialog",{onHide:function(h){h.w.hide().remove(),h.o&&h.o.remove()},modal:mopt.modal,jqm:jm}),$.isFunction(mopt.afterOpen)&&mopt.afterOpen();try{$("#info_dialog").focus()}catch(m){}},bindEv:function(el,opt){var $t=this;$.isFunction(opt.dataInit)&&opt.dataInit.call($t,el,opt),opt.dataEvents&&$.each(opt.dataEvents,function(){void 0!==this.data?$(el).bind(this.type,this.data,this.fn):$(el).bind(this.type,this.fn)})},createEl:function(eltype,options,vl,autowidth,ajaxso){function setAttributes(elm,atr,exl){var exclude=["dataInit","dataEvents","dataUrl","buildSelect","sopt","searchhidden","defaultValue","attr","custom_element","custom_value","oper"];void 0!==exl&&$.isArray(exl)&&$.merge(exclude,exl),$.each(atr,function(key,value){-1===$.inArray(key,exclude)&&$(elm).attr(key,value)}),atr.hasOwnProperty("id")||$(elm).attr("id",$.jgrid.randId())}var elem="",$t=this;switch(eltype){case"textarea":elem=document.createElement("textarea"),autowidth?options.cols||$(elem).css({width:"98%"}):options.cols||(options.cols=20),options.rows||(options.rows=2),("&nbsp;"===vl||"&#160;"===vl||1===vl.length&&160===vl.charCodeAt(0))&&(vl=""),elem.value=vl,setAttributes(elem,options),$(elem).attr({role:"textbox",multiline:"true"});break;case"checkbox":if(elem=document.createElement("input"),elem.type="checkbox",options.value){var cbval=options.value.split(":");vl===cbval[0]&&(elem.checked=!0,elem.defaultChecked=!0),elem.value=cbval[0],$(elem).attr("offval",cbval[1])}else{var vl1=(vl+"").toLowerCase();vl1.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==vl1?(elem.checked=!0,elem.defaultChecked=!0,elem.value=vl):elem.value="on",$(elem).attr("offval","off")}setAttributes(elem,options,["value"]),$(elem).attr("role","checkbox");break;case"select":elem=document.createElement("select"),elem.setAttribute("role","select");var msl,ovm=[];if(options.multiple===!0?(msl=!0,elem.multiple="multiple",$(elem).attr("aria-multiselectable","true")):msl=!1,null!=options.dataUrl){var rowid=null,postData=options.postData||ajaxso.postData;try{rowid=options.rowId}catch(e){}$t.p&&$t.p.idPrefix&&(rowid=$.jgrid.stripPref($t.p.idPrefix,rowid)),$.ajax($.extend({url:$.isFunction(options.dataUrl)?options.dataUrl.call($t,rowid,vl,String(options.name)):options.dataUrl,type:"GET",dataType:"html",data:$.isFunction(postData)?postData.call($t,rowid,vl,String(options.name)):postData,context:{elem:elem,options:options,vl:vl},success:function(data){var txt,vl,ovm=[],elem=this.elem,vl=this.vl,options=$.extend({},this.options),msl=options.multiple===!0,cU=options.cacheUrlData===!0,oV="",a=$.isFunction(options.buildSelect)?options.buildSelect.call($t,data):data;"string"==typeof a&&(a=$($.trim(a)).html()),a&&($(elem).append(a),setAttributes(elem,options,postData?["postData"]:void 0),void 0===options.size&&(options.size=msl?3:1),msl?(ovm=vl.split(","),ovm=$.map(ovm,function(n){return $.trim(n)})):ovm[0]=$.trim(vl),setTimeout(function(){if($("option",elem).each(function(i){txt=$(this).text(),vl=$(this).val()||txt,cU&&(oV+=(0!==i?";":"")+vl+":"+txt),0===i&&elem.multiple&&(this.selected=!1),$(this).attr("role","option"),($.inArray($.trim(txt),ovm)>-1||$.inArray($.trim(vl),ovm)>-1)&&(this.selected="selected")}),cU)if("edit"===options.oper)$($t).jqGrid("setColProp",options.name,{editoptions:{buildSelect:null,dataUrl:null,value:oV}});else if("search"===options.oper)$($t).jqGrid("setColProp",options.name,{searchoptions:{dataUrl:null,value:oV}});else if("filter"===options.oper&&$("#fbox_"+$t.p.id)[0].p){var nm,cols=$("#fbox_"+$t.p.id)[0].p.columns;$.each(cols,function(i){return nm=this.index||this.name,options.name===nm?(this.searchoptions.dataUrl=null,this.searchoptions.value=oV,!1):void 0})}},0))}},ajaxso||{}))}else if(options.value){var i;void 0===options.size&&(options.size=msl?3:1),msl&&(ovm=vl.split(","),ovm=$.map(ovm,function(n){return $.trim(n)})),"function"==typeof options.value&&(options.value=options.value());var so,sv,ov,sep=void 0===options.separator?":":options.separator,delim=void 0===options.delimiter?";":options.delimiter;if("string"==typeof options.value)for(so=options.value.split(delim),i=0;i<so.length;i++)sv=so[i].split(sep),sv.length>2&&(sv[1]=$.map(sv,function(n,ii){return ii>0?n:void 0}).join(sep)),ov=document.createElement("option"),ov.setAttribute("role","option"),ov.value=sv[0],ov.innerHTML=sv[1],elem.appendChild(ov),msl||$.trim(sv[0])!==$.trim(vl)&&$.trim(sv[1])!==$.trim(vl)||(ov.selected="selected"),msl&&($.inArray($.trim(sv[1]),ovm)>-1||$.inArray($.trim(sv[0]),ovm)>-1)&&(ov.selected="selected");else if("[object Array]"===Object.prototype.toString.call(options.value)){for(var oSv=options.value,i=0;i<oSv.length;i++)if(2===oSv[i].length){var key=oSv[i][0],value=oSv[i][1];ov=document.createElement("option"),ov.setAttribute("role","option"),ov.value=key,ov.innerHTML=value,elem.appendChild(ov),msl||$.trim(key)!==$.trim(vl)&&$.trim(value)!==$.trim(vl)||(ov.selected="selected"),msl&&($.inArray($.trim(value),ovm)>-1||$.inArray($.trim(key),ovm)>-1)&&(ov.selected="selected")}}else if("object"==typeof options.value){var key,oSv=options.value;for(key in oSv)oSv.hasOwnProperty(key)&&(ov=document.createElement("option"),ov.setAttribute("role","option"),ov.value=key,ov.innerHTML=oSv[key],elem.appendChild(ov),msl||$.trim(key)!==$.trim(vl)&&$.trim(oSv[key])!==$.trim(vl)||(ov.selected="selected"),msl&&($.inArray($.trim(oSv[key]),ovm)>-1||$.inArray($.trim(key),ovm)>-1)&&(ov.selected="selected"))}setAttributes(elem,options,["value"])}break;case"text":case"password":case"button":var role;role="button"===eltype?"button":"textbox",elem=document.createElement("input"),elem.type=eltype,elem.value=vl,setAttributes(elem,options),"button"!==eltype&&(autowidth?options.size||$(elem).css({width:"98%"}):options.size||(options.size=20)),$(elem).attr("role",role);break;case"image":case"file":elem=document.createElement("input"),elem.type=eltype,setAttributes(elem,options);break;case"custom":elem=document.createElement("span");try{if(!$.isFunction(options.custom_element))throw"e1";var celm=options.custom_element.call($t,vl,options);if(!celm)throw"e2";celm=$(celm).addClass("customelement").attr({id:options.id,name:options.name}),$(elem).empty().append(celm)}catch(e){var errors=$.jgrid.getRegional($t,"errors"),edit=$.jgrid.getRegional($t,"edit");"e1"===e&&$.jgrid.info_dialog(errors.errcap,"function 'custom_element' "+edit.msg.nodefined,edit.bClose),"e2"===e?$.jgrid.info_dialog(errors.errcap,"function 'custom_element' "+edit.msg.novalue,edit.bClose):$.jgrid.info_dialog(errors.errcap,"string"==typeof e?e:e.message,edit.bClose)}}return elem},checkDate:function(format,date){var sep,daysInFebruary=function(year){return year%4!==0||year%100===0&&year%400!==0?28:29},tsp={};if(format=format.toLowerCase(),sep=-1!==format.indexOf("/")?"/":-1!==format.indexOf("-")?"-":-1!==format.indexOf(".")?".":"/",format=format.split(sep),date=date.split(sep),3!==date.length)return!1;var yln,i,j=-1,dln=-1,mln=-1;for(i=0;i<format.length;i++){var dv=isNaN(date[i])?0:parseInt(date[i],10);tsp[format[i]]=dv,yln=format[i],-1!==yln.indexOf("y")&&(j=i),-1!==yln.indexOf("m")&&(mln=i),-1!==yln.indexOf("d")&&(dln=i)}yln="y"===format[j]||"yyyy"===format[j]?4:"yy"===format[j]?2:-1;var strDate,daysInMonth=[0,31,29,31,30,31,30,31,31,30,31,30,31];return-1===j?!1:(strDate=tsp[format[j]].toString(),2===yln&&1===strDate.length&&(yln=1),strDate.length!==yln||0===tsp[format[j]]&&"00"!==date[j]?!1:-1===mln?!1:(strDate=tsp[format[mln]].toString(),strDate.length<1||tsp[format[mln]]<1||tsp[format[mln]]>12?!1:-1===dln?!1:(strDate=tsp[format[dln]].toString(),strDate.length<1||tsp[format[dln]]<1||tsp[format[dln]]>31||2===tsp[format[mln]]&&tsp[format[dln]]>daysInFebruary(tsp[format[j]])||tsp[format[dln]]>daysInMonth[tsp[format[mln]]]?!1:!0)))},isEmpty:function(val){return val.match(/^\s+$/)||""===val?!0:!1},checkTime:function(time){var regs,re=/^(\d{1,2}):(\d{2})([apAP][Mm])?$/;if(!$.jgrid.isEmpty(time)){if(regs=time.match(re),!regs)return!1;if(regs[3]){if(regs[1]<1||regs[1]>12)return!1}else if(regs[1]>23)return!1;if(regs[2]>59)return!1}return!0},checkValues:function(val,valref,customobject,nam){var edtrul,i,nm,dft,len,fmtdate,g=this,cm=g.p.colModel,msg=$.jgrid.getRegional(this,"edit.msg");if(void 0===customobject)if("string"==typeof valref){for(i=0,len=cm.length;len>i;i++)if(cm[i].name===valref){edtrul=cm[i].editrules,valref=i,null!=cm[i].formoptions&&(nm=cm[i].formoptions.label);break}}else valref>=0&&(edtrul=cm[valref].editrules);else edtrul=customobject,nm=void 0===nam?"_":nam;if(edtrul){if(nm||(nm=null!=g.p.colNames?g.p.colNames[valref]:cm[valref].label),edtrul.required===!0&&$.jgrid.isEmpty(val))return[!1,nm+": "+msg.required,""];var rqfield=edtrul.required===!1?!1:!0;if(edtrul.number===!0&&(rqfield!==!1||!$.jgrid.isEmpty(val))&&isNaN(val))return[!1,nm+": "+msg.number,""];if(void 0!==edtrul.minValue&&!isNaN(edtrul.minValue)&&parseFloat(val)<parseFloat(edtrul.minValue))return[!1,nm+": "+msg.minValue+" "+edtrul.minValue,""];if(void 0!==edtrul.maxValue&&!isNaN(edtrul.maxValue)&&parseFloat(val)>parseFloat(edtrul.maxValue))return[!1,nm+": "+msg.maxValue+" "+edtrul.maxValue,""];var filter;if(edtrul.email===!0&&!(rqfield===!1&&$.jgrid.isEmpty(val)||(filter=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,filter.test(val))))return[!1,nm+": "+msg.email,""];if(edtrul.integer===!0&&(rqfield!==!1||!$.jgrid.isEmpty(val))){if(isNaN(val))return[!1,nm+": "+msg.integer,""];if(val%1!==0||-1!==val.indexOf("."))return[!1,nm+": "+msg.integer,""]}if(edtrul.date===!0&&!(rqfield===!1&&$.jgrid.isEmpty(val)||(cm[valref].formatoptions&&cm[valref].formatoptions.newformat?(dft=cm[valref].formatoptions.newformat,fmtdate=$.jgrid.getRegional(g,"formatter.date.masks"),fmtdate&&fmtdate.hasOwnProperty(dft)&&(dft=fmtdate[dft])):dft=cm[valref].datefmt||"Y-m-d",$.jgrid.checkDate(dft,val))))return[!1,nm+": "+msg.date+" - "+dft,""];if(edtrul.time===!0&&!(rqfield===!1&&$.jgrid.isEmpty(val)||$.jgrid.checkTime(val)))return[!1,nm+": "+msg.date+" - hh:mm (am/pm)",""];if(edtrul.url===!0&&!(rqfield===!1&&$.jgrid.isEmpty(val)||(filter=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,filter.test(val))))return[!1,nm+": "+msg.url,""];if(edtrul.custom===!0&&(rqfield!==!1||!$.jgrid.isEmpty(val))){if($.isFunction(edtrul.custom_func)){var ret=edtrul.custom_func.call(g,val,nm,valref);return $.isArray(ret)?ret:[!1,msg.customarray,""]}return[!1,msg.customfcheck,""]}}return[!0,"",""]}}),$.fn.jqFilter=function(arg){if("string"==typeof arg){var fn=$.fn.jqFilter[arg];if(!fn)throw"jqFilter - No such method: "+arg;var args=$.makeArray(arguments).slice(1);return fn.apply(this,args)}var p=$.extend(!0,{filter:null,columns:[],onChange:null,afterRedraw:null,checkValues:null,error:!1,errmsg:"",errorcheck:!0,showQuery:!0,sopt:null,ops:[],operands:null,numopts:["eq","ne","lt","le","gt","ge","nu","nn","in","ni"],stropts:["eq","ne","bw","bn","ew","en","cn","nc","nu","nn","in","ni"],strarr:["text","string","blob"],groupOps:[{op:"AND",text:"AND"},{op:"OR",text:"OR"}],groupButton:!0,ruleButtons:!0,direction:"ltr"},$.jgrid.filter,arg||{});return this.each(function(){if(!this.filter){this.p=p,(null===this.p.filter||void 0===this.p.filter)&&(this.p.filter={groupOp:this.p.groupOps[0].op,rules:[],groups:[]});var i,cl,len=this.p.columns.length,isIE=/msie/i.test(navigator.userAgent)&&!window.opera;if(this.p.initFilter=$.extend(!0,{},this.p.filter),len){for(i=0;len>i;i++)cl=this.p.columns[i],cl.stype?cl.inputtype=cl.stype:cl.inputtype||(cl.inputtype="text"),cl.sorttype?cl.searchtype=cl.sorttype:cl.searchtype||(cl.searchtype="string"),void 0===cl.hidden&&(cl.hidden=!1),cl.label||(cl.label=cl.name),cl.index&&(cl.name=cl.index),cl.hasOwnProperty("searchoptions")||(cl.searchoptions={}),cl.hasOwnProperty("searchrules")||(cl.searchrules={});this.p.showQuery&&$(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;' dir='"+this.p.direction+"'><tbody><tr><td class='query'></td></tr></tbody></table>");var getGrid=function(){return $("#"+$.jgrid.jqID(p.id))[0]||null},checkData=function(val,colModelItem){var ret=[!0,""],$t=getGrid();if($.isFunction(colModelItem.searchrules))ret=colModelItem.searchrules.call($t,val,colModelItem);else if($.jgrid&&$.jgrid.checkValues)try{ret=$.jgrid.checkValues.call($t,val,-1,colModelItem.searchrules,colModelItem.label)}catch(e){}ret&&ret.length&&ret[0]===!1&&(p.error=!ret[0],p.errmsg=ret[1])};this.onchange=function(){return this.p.error=!1,this.p.errmsg="",$.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):!1},this.reDraw=function(){$("table.group:first",this).remove();var t=this.createTableForGroup(p.filter,null);$(this).append(t),$.isFunction(this.p.afterRedraw)&&this.p.afterRedraw.call(this,this.p)},this.createTableForGroup=function(group,parentgroup){var i,that=this,table=$("<table class='group ui-widget ui-widget-content ui-search-table' style='border:0px none;'><tbody></tbody></table>"),align="left";"rtl"===this.p.direction&&(align="right",table.attr("dir","rtl")),null===parentgroup&&table.append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='"+align+"'></th></tr>");var tr=$("<tr></tr>");table.append(tr);var th=$("<th colspan='5' align='"+align+"'></th>");if(tr.append(th),this.p.ruleButtons===!0){var groupOpSelect=$("<select class='opsel ui-widget-content ui-corner-all'></select>");th.append(groupOpSelect);var selected,str="";for(i=0;i<p.groupOps.length;i++)selected=group.groupOp===that.p.groupOps[i].op?" selected='selected'":"",str+="<option value='"+that.p.groupOps[i].op+"'"+selected+">"+that.p.groupOps[i].text+"</option>";groupOpSelect.append(str).bind("change",function(){group.groupOp=$(groupOpSelect).val(),that.onchange()})}var inputAddSubgroup="<span></span>";if(this.p.groupButton&&(inputAddSubgroup=$("<input type='button' value='+ {}' title='Add subgroup' class='add-group ui-widget-content ui-corner-all'/>"),inputAddSubgroup.bind("click",function(){return void 0===group.groups&&(group.groups=[]),group.groups.push({groupOp:p.groupOps[0].op,rules:[],groups:[]}),that.reDraw(),that.onchange(),!1})),th.append(inputAddSubgroup),this.p.ruleButtons===!0){var cm,inputAddRule=$("<input type='button' value='+' title='Add rule' class='add-rule ui-add ui-widget-content ui-corner-all'/>");inputAddRule.bind("click",function(){for(void 0===group.rules&&(group.rules=[]),i=0;i<that.p.columns.length;i++){var searchable=void 0===that.p.columns[i].search?!0:that.p.columns[i].search,hidden=that.p.columns[i].hidden===!0,ignoreHiding=that.p.columns[i].searchoptions.searchhidden===!0;if(ignoreHiding&&searchable||searchable&&!hidden){cm=that.p.columns[i];break}}var opr;return opr=cm.searchoptions.sopt?cm.searchoptions.sopt:that.p.sopt?that.p.sopt:-1!==$.inArray(cm.searchtype,that.p.strarr)?that.p.stropts:that.p.numopts,group.rules.push({field:cm.name,op:opr[0],data:""}),that.reDraw(),!1}),th.append(inputAddRule)}if(null!==parentgroup){var inputDeleteGroup=$("<input type='button' value='-' title='Delete group' class='delete-group ui-widget-content ui-corner-all'/>");th.append(inputDeleteGroup),inputDeleteGroup.bind("click",function(){for(i=0;i<parentgroup.groups.length;i++)if(parentgroup.groups[i]===group){parentgroup.groups.splice(i,1);break}return that.reDraw(),that.onchange(),!1})}if(void 0!==group.groups)for(i=0;i<group.groups.length;i++){var trHolderForSubgroup=$("<tr></tr>");table.append(trHolderForSubgroup);var tdFirstHolderForSubgroup=$("<td class='first'></td>");trHolderForSubgroup.append(tdFirstHolderForSubgroup);var tdMainHolderForSubgroup=$("<td colspan='4'></td>");tdMainHolderForSubgroup.append(this.createTableForGroup(group.groups[i],group)),trHolderForSubgroup.append(tdMainHolderForSubgroup)}if(void 0===group.groupOp&&(group.groupOp=that.p.groupOps[0].op),void 0!==group.rules)for(i=0;i<group.rules.length;i++)table.append(this.createTableRowForRule(group.rules[i],group));return table},this.createTableRowForRule=function(rule,group){var i,op,trpar,cm,selected,that=this,$t=getGrid(),tr=$("<tr></tr>"),str="";tr.append("<td class='first'></td>");var ruleFieldTd=$("<td class='columns'></td>");tr.append(ruleFieldTd);var ina,ruleFieldSelect=$("<select class='ui-widget-content ui-corner-all'></select>"),aoprs=[];ruleFieldTd.append(ruleFieldSelect),ruleFieldSelect.bind("change",function(){for(rule.field=$(ruleFieldSelect).val(),trpar=$(this).parents("tr:first"),i=0;i<that.p.columns.length;i++)if(that.p.columns[i].name===rule.field){cm=that.p.columns[i];break}if(cm){cm.searchoptions.id=$.jgrid.randId(),cm.searchoptions.name=rule.field,cm.searchoptions.oper="filter",isIE&&"text"===cm.inputtype&&(cm.searchoptions.size||(cm.searchoptions.size=10));var elm=$.jgrid.createEl.call($t,cm.inputtype,cm.searchoptions,"",!0,that.p.ajaxSelectOptions||{},!0);$(elm).addClass("input-elm ui-widget-content ui-corner-all"),op=cm.searchoptions.sopt?cm.searchoptions.sopt:that.p.sopt?that.p.sopt:-1!==$.inArray(cm.searchtype,that.p.strarr)?that.p.stropts:that.p.numopts;var s="",so=0;for(aoprs=[],$.each(that.p.ops,function(){aoprs.push(this.oper)}),i=0;i<op.length;i++)ina=$.inArray(op[i],aoprs),-1!==ina&&(0===so&&(rule.op=that.p.ops[ina].oper),s+="<option value='"+that.p.ops[ina].oper+"'>"+that.p.ops[ina].text+"</option>",so++);if($(".selectopts",trpar).empty().append(s),$(".selectopts",trpar)[0].selectedIndex=0,$.jgrid.msie&&$.jgrid.msiever()<9){var sw=parseInt($("select.selectopts",trpar)[0].offsetWidth,10)+1;$(".selectopts",trpar).width(sw),$(".selectopts",trpar).css("width","auto")}$(".data",trpar).empty().append(elm),$.jgrid.bindEv.call($t,elm,cm.searchoptions),$(".input-elm",trpar).bind("change",function(e){var elem=e.target;rule.data="SPAN"===elem.nodeName.toUpperCase()&&cm.searchoptions&&$.isFunction(cm.searchoptions.custom_value)?cm.searchoptions.custom_value.call($t,$(elem).children(".customelement:first"),"get"):elem.value,that.onchange()}),setTimeout(function(){rule.data=$(elm).val(),that.onchange()},0)}});var j=0;for(i=0;i<that.p.columns.length;i++){var searchable=void 0===that.p.columns[i].search?!0:that.p.columns[i].search,hidden=that.p.columns[i].hidden===!0,ignoreHiding=that.p.columns[i].searchoptions.searchhidden===!0;(ignoreHiding&&searchable||searchable&&!hidden)&&(selected="",rule.field===that.p.columns[i].name&&(selected=" selected='selected'",j=i),str+="<option value='"+that.p.columns[i].name+"'"+selected+">"+that.p.columns[i].label+"</option>")}ruleFieldSelect.append(str);var ruleOperatorTd=$("<td class='operators'></td>");tr.append(ruleOperatorTd),cm=p.columns[j],cm.searchoptions.id=$.jgrid.randId(),isIE&&"text"===cm.inputtype&&(cm.searchoptions.size||(cm.searchoptions.size=10)),cm.searchoptions.name=rule.field,cm.searchoptions.oper="filter";var ruleDataInput=$.jgrid.createEl.call($t,cm.inputtype,cm.searchoptions,rule.data,!0,that.p.ajaxSelectOptions||{},!0);("nu"===rule.op||"nn"===rule.op)&&($(ruleDataInput).attr("readonly","true"),$(ruleDataInput).attr("disabled","true"));var ruleOperatorSelect=$("<select class='selectopts ui-widget-content ui-corner-all'></select>");for(ruleOperatorTd.append(ruleOperatorSelect),ruleOperatorSelect.bind("change",function(){rule.op=$(ruleOperatorSelect).val(),trpar=$(this).parents("tr:first");var rd=$(".input-elm",trpar)[0];"nu"===rule.op||"nn"===rule.op?(rule.data="","SELECT"!==rd.tagName.toUpperCase()&&(rd.value=""),rd.setAttribute("readonly","true"),rd.setAttribute("disabled","true")):("SELECT"===rd.tagName.toUpperCase()&&(rule.data=rd.value),rd.removeAttribute("readonly"),rd.removeAttribute("disabled")),that.onchange()}),op=cm.searchoptions.sopt?cm.searchoptions.sopt:that.p.sopt?that.p.sopt:-1!==$.inArray(cm.searchtype,that.p.strarr)?that.p.stropts:that.p.numopts,str="",$.each(that.p.ops,function(){aoprs.push(this.oper)}),i=0;i<op.length;i++)ina=$.inArray(op[i],aoprs),-1!==ina&&(selected=rule.op===that.p.ops[ina].oper?" selected='selected'":"",str+="<option value='"+that.p.ops[ina].oper+"'"+selected+">"+that.p.ops[ina].text+"</option>");ruleOperatorSelect.append(str);var ruleDataTd=$("<td class='data'></td>");tr.append(ruleDataTd),ruleDataTd.append(ruleDataInput),$.jgrid.bindEv.call($t,ruleDataInput,cm.searchoptions),$(ruleDataInput).addClass("input-elm ui-widget-content ui-corner-all").bind("change",function(){rule.data="custom"===cm.inputtype?cm.searchoptions.custom_value.call($t,$(this).children(".customelement:first"),"get"):$(this).val(),that.onchange()});var ruleDeleteTd=$("<td></td>");if(tr.append(ruleDeleteTd),this.p.ruleButtons===!0){var ruleDeleteInput=$("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del ui-widget-content ui-corner-all'/>");ruleDeleteTd.append(ruleDeleteInput),ruleDeleteInput.bind("click",function(){for(i=0;i<group.rules.length;i++)if(group.rules[i]===rule){group.rules.splice(i,1);break}return that.reDraw(),that.onchange(),!1})}return tr},this.getStringForGroup=function(group){var index,s="(";if(void 0!==group.groups)for(index=0;index<group.groups.length;index++){s.length>1&&(s+=" "+group.groupOp+" ");try{s+=this.getStringForGroup(group.groups[index])}catch(eg){alert(eg)}}if(void 0!==group.rules)try{for(index=0;index<group.rules.length;index++)s.length>1&&(s+=" "+group.groupOp+" "),s+=this.getStringForRule(group.rules[index])}catch(e){alert(e)}return s+=")","()"===s?"":s},this.getStringForRule=function(rule){var i,cm,ret,val,opUF="",opC="",numtypes=["int","integer","float","number","currency"];for(i=0;i<this.p.ops.length;i++)if(this.p.ops[i].oper===rule.op){opUF=this.p.operands.hasOwnProperty(rule.op)?this.p.operands[rule.op]:"",opC=this.p.ops[i].oper;break}for(i=0;i<this.p.columns.length;i++)if(this.p.columns[i].name===rule.field){cm=this.p.columns[i];break}return void 0===cm?"":(val=rule.data,("bw"===opC||"bn"===opC)&&(val+="%"),("ew"===opC||"en"===opC)&&(val="%"+val),("cn"===opC||"nc"===opC)&&(val="%"+val+"%"),("in"===opC||"ni"===opC)&&(val=" ("+val+")"),p.errorcheck&&checkData(rule.data,cm),ret=-1!==$.inArray(cm.searchtype,numtypes)||"nn"===opC||"nu"===opC?rule.field+" "+opUF+" "+val:rule.field+" "+opUF+' "'+val+'"')},this.resetFilter=function(){this.p.filter=$.extend(!0,{},this.p.initFilter),this.reDraw(),this.onchange()},this.hideError=function(){$("th.ui-state-error",this).html(""),$("tr.error",this).hide()},this.showError=function(){$("th.ui-state-error",this).html(this.p.errmsg),$("tr.error",this).show()},this.toUserFriendlyString=function(){return this.getStringForGroup(p.filter)},this.toString=function(){function getStringRule(rule){if(that.p.errorcheck){var i,cm;for(i=0;i<that.p.columns.length;i++)if(that.p.columns[i].name===rule.field){cm=that.p.columns[i];break}cm&&checkData(rule.data,cm)}return rule.op+"(item."+rule.field+",'"+rule.data+"')"}function getStringForGroup(group){var index,s="(";if(void 0!==group.groups)for(index=0;index<group.groups.length;index++)s.length>1&&(s+="OR"===group.groupOp?" || ":" && "),s+=getStringForGroup(group.groups[index]);if(void 0!==group.rules)for(index=0;index<group.rules.length;index++)s.length>1&&(s+="OR"===group.groupOp?" || ":" && "),s+=getStringRule(group.rules[index]);return s+=")","()"===s?"":s}var that=this;return getStringForGroup(this.p.filter)},this.reDraw(),this.p.showQuery&&this.onchange(),
this.filter=!0}}})},$.extend($.fn.jqFilter,{toSQLString:function(){var s="";return this.each(function(){s=this.toUserFriendlyString()}),s},filterData:function(){var s;return this.each(function(){s=this.p.filter}),s},getParameter:function(param){return void 0!==param&&this.p.hasOwnProperty(param)?this.p[param]:this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(pfilter){"string"==typeof pfilter&&(pfilter=$.jgrid.parse(pfilter)),this.each(function(){this.p.filter=pfilter,this.reDraw(),this.onchange()})}}),$.jgrid.extend({filterToolbar:function(p){var regional=$.jgrid.getRegional(this[0],"search");return p=$.extend({autosearch:!0,autosearchDelay:500,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw",searchOperators:!1,resetIcon:"x",operands:{eq:"==",ne:"!",lt:"<",le:"<=",gt:">",ge:">=",bw:"^",bn:"!^","in":"=",ni:"!=",ew:"|",en:"!@",cn:"~",nc:"!~",nu:"#",nn:"!#"}},regional,p||{}),this.each(function(){var $t=this;if(!$t.p.filterToolbar){$($t).data("filterToolbar")||$($t).data("filterToolbar",p),$t.p.force_regional&&(p=$.extend(p,regional));var timeoutHnd,triggerToolbar=function(){var v,nm,so,sdata={},j=0,sopt={};$.each($t.p.colModel,function(){var $elem=$("#gs_"+$t.p.idPrefix+$.jgrid.jqID(this.name),this.frozen===!0&&$t.p.frozenColumns===!0?$t.grid.fhDiv:$t.grid.hDiv);if(nm=this.index||this.name,so=p.searchOperators?$elem.parent().prev().children("a").attr("soper")||p.defaultSearch:this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"select"===this.stype?"eq":p.defaultSearch,v="custom"===this.stype&&$.isFunction(this.searchoptions.custom_value)&&$elem.length>0&&"SPAN"===$elem[0].nodeName.toUpperCase()?this.searchoptions.custom_value.call($t,$elem.children(".customelement:first"),"get"):$elem.val(),v||"nu"===so||"nn"===so)sdata[nm]=v,sopt[nm]=so,j++;else try{delete $t.p.postData[nm]}catch(z){}});var sd=j>0?!0:!1;if(p.stringResult===!0||"local"===$t.p.datatype||p.searchOperators===!0){var ruleGroup='{"groupOp":"'+p.groupOp+'","rules":[',gi=0;$.each(sdata,function(i,n){gi>0&&(ruleGroup+=","),ruleGroup+='{"field":"'+i+'",',ruleGroup+='"op":"'+sopt[i]+'",',n+="",ruleGroup+='"data":"'+n.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',gi++}),ruleGroup+="]}",$.extend($t.p.postData,{filters:ruleGroup}),$.each(["searchField","searchString","searchOper"],function(i,n){$t.p.postData.hasOwnProperty(n)&&delete $t.p.postData[n]})}else $.extend($t.p.postData,sdata);var saveurl;$t.p.searchurl&&(saveurl=$t.p.url,$($t).jqGrid("setGridParam",{url:$t.p.searchurl}));var bsr="stop"===$($t).triggerHandler("jqGridToolbarBeforeSearch")?!0:!1;!bsr&&$.isFunction(p.beforeSearch)&&(bsr=p.beforeSearch.call($t)),bsr||$($t).jqGrid("setGridParam",{search:sd}).trigger("reloadGrid",[{page:1}]),saveurl&&$($t).jqGrid("setGridParam",{url:saveurl}),$($t).triggerHandler("jqGridToolbarAfterSearch"),$.isFunction(p.afterSearch)&&p.afterSearch.call($t)},clearToolbar=function(trigger){var nm,sdata={},j=0;trigger="boolean"!=typeof trigger?!0:trigger,$.each($t.p.colModel,function(){var v,$elem=$("#gs_"+$t.p.idPrefix+$.jgrid.jqID(this.name),this.frozen===!0&&$t.p.frozenColumns===!0?$t.grid.fhDiv:$t.grid.hDiv);switch(this.searchoptions&&void 0!==this.searchoptions.defaultValue&&(v=this.searchoptions.defaultValue),nm=this.index||this.name,this.stype){case"select":if($elem.find("option").each(function(i){return 0===i&&(this.selected=!0),$(this).val()===v?(this.selected=!0,!1):void 0}),void 0!==v)sdata[nm]=v,j++;else try{delete $t.p.postData[nm]}catch(e){}break;case"text":if($elem.val(v||""),void 0!==v)sdata[nm]=v,j++;else try{delete $t.p.postData[nm]}catch(y){}break;case"custom":$.isFunction(this.searchoptions.custom_value)&&$elem.length>0&&"SPAN"===$elem[0].nodeName.toUpperCase()&&this.searchoptions.custom_value.call($t,$elem.children(".customelement:first"),"set",v||"")}});var sd=j>0?!0:!1;if($t.p.resetsearch=!0,p.stringResult===!0||"local"===$t.p.datatype){var ruleGroup='{"groupOp":"'+p.groupOp+'","rules":[',gi=0;$.each(sdata,function(i,n){gi>0&&(ruleGroup+=","),ruleGroup+='{"field":"'+i+'",',ruleGroup+='"op":"eq",',n+="",ruleGroup+='"data":"'+n.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',gi++}),ruleGroup+="]}",$.extend($t.p.postData,{filters:ruleGroup}),$.each(["searchField","searchString","searchOper"],function(i,n){$t.p.postData.hasOwnProperty(n)&&delete $t.p.postData[n]})}else $.extend($t.p.postData,sdata);var saveurl;$t.p.searchurl&&(saveurl=$t.p.url,$($t).jqGrid("setGridParam",{url:$t.p.searchurl}));var bcv="stop"===$($t).triggerHandler("jqGridToolbarBeforeClear")?!0:!1;!bcv&&$.isFunction(p.beforeClear)&&(bcv=p.beforeClear.call($t)),bcv||trigger&&$($t).jqGrid("setGridParam",{search:sd}).trigger("reloadGrid",[{page:1}]),saveurl&&$($t).jqGrid("setGridParam",{url:saveurl}),$($t).triggerHandler("jqGridToolbarAfterClear"),$.isFunction(p.afterClear)&&p.afterClear()},toggleToolbar=function(){var trow=$("tr.ui-search-toolbar",$t.grid.hDiv),trow2=$t.p.frozenColumns===!0?$("tr.ui-search-toolbar",$t.grid.fhDiv):!1;"none"===trow.css("display")?(trow.show(),trow2&&trow2.show()):(trow.hide(),trow2&&trow2.hide())},buildRuleMenu=function(elem,left,top){$("#sopt_menu").remove(),left=parseInt(left,10),top=parseInt(top,10)+18;for(var selclass,ina,fs=$(".ui-jqgrid-view").css("font-size")||"11px",str='<ul id="sopt_menu" class="ui-search-menu" role="menu" tabindex="0" style="font-size:'+fs+";left:"+left+"px;top:"+top+'px;">',selected=$(elem).attr("soper"),aoprs=[],i=0,nm=$(elem).attr("colname"),len=$t.p.colModel.length;len>i&&$t.p.colModel[i].name!==nm;)i++;var cm=$t.p.colModel[i],options=$.extend({},cm.searchoptions);for(options.sopt||(options.sopt=[],options.sopt[0]="select"===cm.stype?"eq":p.defaultSearch),$.each(p.odata,function(){aoprs.push(this.oper)}),i=0;i<options.sopt.length;i++)ina=$.inArray(options.sopt[i],aoprs),-1!==ina&&(selclass=selected===p.odata[ina].oper?"ui-state-highlight":"",str+='<li class="ui-menu-item '+selclass+'" role="presentation"><a class="ui-corner-all g-menu-item" tabindex="0" role="menuitem" value="'+p.odata[ina].oper+'" oper="'+p.operands[p.odata[ina].oper]+'"><table cellspacing="0" cellpadding="0" border="0"><tr><td width="25px">'+p.operands[p.odata[ina].oper]+"</td><td>"+p.odata[ina].text+"</td></tr></table></a></li>");str+="</ul>",$("body").append(str),$("#sopt_menu").addClass("ui-menu ui-widget ui-widget-content ui-corner-all"),$("#sopt_menu > li > a").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}).click(function(){var v=$(this).attr("value"),oper=$(this).attr("oper");if($($t).triggerHandler("jqGridToolbarSelectOper",[v,oper,elem]),$("#sopt_menu").hide(),$(elem).text(oper).attr("soper",v),p.autosearch===!0){var inpelm=$(elem).parent().next().children()[0];($(inpelm).val()||"nu"===v||"nn"===v)&&triggerToolbar()}})},tr=$("<tr class='ui-search-toolbar' role='row'></tr>");$.each($t.p.colModel,function(ci){var soptions,so,i,st,csv,df,elem,cm=this,select="",sot="=",th=$("<th role='columnheader' class='ui-state-default ui-th-"+$t.p.direction+"' id='gsh_"+$t.p.id+"_"+cm.name+"' ></th>"),thd=$("<div></div>"),stbl=$("<table class='ui-search-table' cellspacing='0'><tr><td class='ui-search-oper' headers=''></td><td class='ui-search-input' headers=''></td><td class='ui-search-clear' headers=''></td></tr></table>");if(this.hidden===!0&&$(th).css("display","none"),this.search=this.search===!1?!1:!0,void 0===this.stype&&(this.stype="text"),soptions=$.extend({},this.searchoptions||{},{name:cm.index||cm.name,id:"gs_"+$t.p.idPrefix+cm.name,oper:"search"}),this.search){if(p.searchOperators){for(so=soptions.sopt?soptions.sopt[0]:"select"===cm.stype?"eq":p.defaultSearch,i=0;i<p.odata.length;i++)if(p.odata[i].oper===so){sot=p.operands[so]||"";break}st=null!=soptions.searchtitle?soptions.searchtitle:p.operandTitle,select="<a title='"+st+"' style='padding-right: 0.5em;' soper='"+so+"' class='soptclass' colname='"+this.name+"'>"+sot+"</a>"}switch($("td:eq(0)",stbl).attr("colindex",ci).append(select),void 0===soptions.clearSearch&&(soptions.clearSearch=!0),soptions.clearSearch?(csv=p.resetTitle||"Clear Search Value",$("td:eq(2)",stbl).append("<a title='"+csv+"' style='padding-right: 0.3em;padding-left: 0.3em;' class='clearsearchclass'>"+p.resetIcon+"</a>")):$("td:eq(2)",stbl).hide(),this.surl&&(soptions.dataUrl=this.surl),df="",soptions.defaultValue&&(df=$.isFunction(soptions.defaultValue)?soptions.defaultValue.call($t):soptions.defaultValue),elem=$.jgrid.createEl.call($t,this.stype,soptions,df,!1,$.extend({},$.jgrid.ajaxOptions,$t.p.ajaxSelectOptions||{})),$(elem).css({width:"100%"}).addClass("ui-widget-content ui-corner-all"),$("td:eq(1)",stbl).append(elem),$(thd).append(stbl),this.stype){case"select":p.autosearch===!0&&(soptions.dataEvents=[{type:"change",fn:function(){return triggerToolbar(),!1}}]);break;case"text":p.autosearch===!0&&(p.searchOnEnter?soptions.dataEvents=[{type:"keypress",fn:function(e){var key=e.charCode||e.keyCode||0;return 13===key?(triggerToolbar(),!1):this}}]:soptions.dataEvents=[{type:"keydown",fn:function(e){var key=e.which;switch(key){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:timeoutHnd&&clearTimeout(timeoutHnd),timeoutHnd=setTimeout(function(){triggerToolbar()},p.autosearchDelay)}}}])}$.jgrid.bindEv.call($t,elem,soptions)}$(th).append(thd),$(tr).append(th),p.searchOperators||$("td:eq(0)",stbl).hide()}),$("table thead",$t.grid.hDiv).append(tr),p.searchOperators&&($(".soptclass",tr).click(function(e){var offset=$(this).offset(),left=offset.left,top=offset.top;buildRuleMenu(this,left,top),e.stopPropagation()}),$("body").on("click",function(e){"soptclass"!==e.target.className&&$("#sopt_menu").hide()})),$(".clearsearchclass",tr).click(function(){var ptr=$(this).parents("tr:first"),coli=parseInt($("td.ui-search-oper",ptr).attr("colindex"),10),sval=$.extend({},$t.p.colModel[coli].searchoptions||{}),dval=sval.defaultValue?sval.defaultValue:"";"select"===$t.p.colModel[coli].stype?dval?$("td.ui-search-input select",ptr).val(dval):$("td.ui-search-input select",ptr)[0].selectedIndex=0:$("td.ui-search-input input",ptr).val(dval),p.autosearch===!0&&triggerToolbar()}),this.p.filterToolbar=!0,this.triggerToolbar=triggerToolbar,this.clearToolbar=clearToolbar,this.toggleToolbar=toggleToolbar}})},destroyFilterToolbar:function(){return this.each(function(){this.p.filterToolbar&&(this.triggerToolbar=null,this.clearToolbar=null,this.toggleToolbar=null,this.p.filterToolbar=!1,$(this.grid.hDiv).find("table thead tr.ui-search-toolbar").remove())})},searchGrid:function(p){var regional=$.jgrid.getRegional(this[0],"search");return p=$.extend(!0,{recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,jqModal:!0,modal:!1,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,toTop:!0,overlay:30,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE","in":"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"ISNOT NULL"}},regional,p||{}),this.each(function(){function showFilter(_filter){showFrm=$($t).triggerHandler("jqGridFilterBeforeShow",[_filter]),void 0===showFrm&&(showFrm=!0),showFrm&&$.isFunction(p.beforeShowSearch)&&(showFrm=p.beforeShowSearch.call($t,_filter)),showFrm&&($.jgrid.viewModal("#"+$.jgrid.jqID(IDs.themodal),{gbox:"#gbox_"+$.jgrid.jqID(fid),jqm:p.jqModal,modal:p.modal,overlay:p.overlay,toTop:p.toTop}),$($t).triggerHandler("jqGridFilterAfterShow",[_filter]),$.isFunction(p.afterShowSearch)&&p.afterShowSearch.call($t,_filter))}var $t=this;if($t.grid){var fl,fid="fbox_"+$t.p.id,showFrm=!0,mustReload=!0,IDs={themodal:"searchmod"+fid,modalhead:"searchhd"+fid,modalcontent:"searchcnt"+fid,scrollelm:fid},defaultFilters=$t.p.postData[p.sFilter];if("string"==typeof defaultFilters&&(defaultFilters=$.jgrid.parse(defaultFilters)),p.recreateFilter===!0&&$("#"+$.jgrid.jqID(IDs.themodal)).remove(),void 0!==$("#"+$.jgrid.jqID(IDs.themodal))[0])showFilter($("#fbox_"+$.jgrid.jqID($t.p.id)));else{var fil=$("<div><div id='"+fid+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore("#gview_"+$.jgrid.jqID($t.p.id)),align="left",butleft="";"rtl"===$t.p.direction&&(align="right",butleft=" style='text-align:left'",fil.attr("dir","rtl"));var colnm,bt,columns=$.extend([],$t.p.colModel),bS="<a id='"+fid+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+p.Find+"</a>",bC="<a id='"+fid+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+p.Reset+"</a>",bQ="",tmpl="",found=!1,cmi=-1;if(p.showQuery&&(bQ="<a id='"+fid+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>"),p.columns.length?(columns=p.columns,cmi=0,colnm=columns[0].index||columns[0].name):$.each(columns,function(i,n){if(n.label||(n.label=$t.p.colNames[i]),!found){var searchable=void 0===n.search?!0:n.search,hidden=n.hidden===!0,ignoreHiding=n.searchoptions&&n.searchoptions.searchhidden===!0;(ignoreHiding&&searchable||searchable&&!hidden)&&(found=!0,colnm=n.index||n.name,cmi=i)}}),!defaultFilters&&colnm||p.multipleSearch===!1){var cmop="eq";cmi>=0&&columns[cmi].searchoptions&&columns[cmi].searchoptions.sopt?cmop=columns[cmi].searchoptions.sopt[0]:p.sopt&&p.sopt.length&&(cmop=p.sopt[0]),defaultFilters={groupOp:"AND",rules:[{field:colnm,op:cmop,data:""}]}}found=!1,p.tmplNames&&p.tmplNames.length&&(found=!0,tmpl=p.tmplLabel,tmpl+="<select class='ui-template'>",tmpl+="<option value='default'>Default</option>",$.each(p.tmplNames,function(i,n){tmpl+="<option value='"+i+"'>"+n+"</option>"}),tmpl+="</select>"),bt="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+fid+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:"+align+"'>"+bC+tmpl+"</td><td class='EditButton' "+butleft+">"+bQ+bS+"</td></tr></tbody></table>",fid=$.jgrid.jqID(fid),$("#"+fid).jqFilter({columns:columns,filter:p.loadDefaults?defaultFilters:null,showQuery:p.showQuery,errorcheck:p.errorcheck,sopt:p.sopt,groupButton:p.multipleGroup,ruleButtons:p.multipleSearch,afterRedraw:p.afterRedraw,ops:p.odata,operands:p.operands,ajaxSelectOptions:$t.p.ajaxSelectOptions,groupOps:p.groupOps,onChange:function(){this.p.showQuery&&$(".query",this).html(this.toUserFriendlyString()),$.isFunction(p.afterChange)&&p.afterChange.call($t,$("#"+fid),p)},direction:$t.p.direction,id:$t.p.id}),fil.append(bt),found&&p.tmplFilters&&p.tmplFilters.length&&$(".ui-template",fil).bind("change",function(){var curtempl=$(this).val();return"default"===curtempl?$("#"+fid).jqFilter("addFilter",defaultFilters):$("#"+fid).jqFilter("addFilter",p.tmplFilters[parseInt(curtempl,10)]),!1}),p.multipleGroup===!0&&(p.multipleSearch=!0),$($t).triggerHandler("jqGridFilterInitialize",[$("#"+fid)]),$.isFunction(p.onInitializeSearch)&&p.onInitializeSearch.call($t,$("#"+fid)),p.gbox="#gbox_"+fid,p.layer?$.jgrid.createModal(IDs,fil,p,"#gview_"+$.jgrid.jqID($t.p.id),$("#gbox_"+$.jgrid.jqID($t.p.id))[0],"#"+$.jgrid.jqID(p.layer),{position:"relative"}):$.jgrid.createModal(IDs,fil,p,"#gview_"+$.jgrid.jqID($t.p.id),$("#gbox_"+$.jgrid.jqID($t.p.id))[0]),(p.searchOnEnter||p.closeOnEscape)&&$("#"+$.jgrid.jqID(IDs.themodal)).keydown(function(e){var $target=$(e.target);return!p.searchOnEnter||13!==e.which||$target.hasClass("add-group")||$target.hasClass("add-rule")||$target.hasClass("delete-group")||$target.hasClass("delete-rule")||$target.hasClass("fm-button")&&$target.is("[id$=_query]")?p.closeOnEscape&&27===e.which?($("#"+$.jgrid.jqID(IDs.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0:($("#"+fid+"_search").click(),!1)}),bQ&&$("#"+fid+"_query").bind("click",function(){return $(".queryresult",fil).toggle(),!1}),void 0===p.stringResult&&(p.stringResult=p.multipleSearch),$("#"+fid+"_search").bind("click",function(){var res,filters,sdata={};if(fl=$("#"+fid),fl.find(".input-elm:focus").change(),filters=fl.jqFilter("filterData"),p.errorcheck&&(fl[0].hideError(),p.showQuery||fl.jqFilter("toSQLString"),fl[0].p.error))return fl[0].showError(),!1;if(p.stringResult){try{res=JSON.stringify(filters)}catch(e2){}"string"==typeof res&&(sdata[p.sFilter]=res,$.each([p.sField,p.sValue,p.sOper],function(){sdata[this]=""}))}else p.multipleSearch?(sdata[p.sFilter]=filters,$.each([p.sField,p.sValue,p.sOper],function(){sdata[this]=""})):(sdata[p.sField]=filters.rules[0].field,sdata[p.sValue]=filters.rules[0].data,sdata[p.sOper]=filters.rules[0].op,sdata[p.sFilter]="");return $t.p.search=!0,$.extend($t.p.postData,sdata),mustReload=$($t).triggerHandler("jqGridFilterSearch"),void 0===mustReload&&(mustReload=!0),mustReload&&$.isFunction(p.onSearch)&&(mustReload=p.onSearch.call($t,$t.p.filters)),mustReload!==!1&&$($t).trigger("reloadGrid",[{page:1}]),p.closeAfterSearch&&$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:p.jqModal,onClose:p.onClose}),!1}),$("#"+fid+"_reset").bind("click",function(){var sdata={},fl=$("#"+fid);return $t.p.search=!1,$t.p.resetsearch=!0,p.multipleSearch===!1?sdata[p.sField]=sdata[p.sValue]=sdata[p.sOper]="":sdata[p.sFilter]="",fl[0].resetFilter(),found&&$(".ui-template",fil).val("default"),$.extend($t.p.postData,sdata),mustReload=$($t).triggerHandler("jqGridFilterReset"),void 0===mustReload&&(mustReload=!0),mustReload&&$.isFunction(p.onReset)&&(mustReload=p.onReset.call($t)),mustReload!==!1&&$($t).trigger("reloadGrid",[{page:1}]),p.closeAfterReset&&$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:p.jqModal,onClose:p.onClose}),!1}),showFilter($("#"+fid)),$(".fm-button:not(.ui-state-disabled)",fil).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")})}}})}});var rp_ge={};if($.jgrid.extend({editGridRow:function(rowid,p){var regional=$.jgrid.getRegional(this[0],"edit");return p=$.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:"ui-widget-overlay",removemodal:!0,form:"edit",template:null},regional,p||{}),rp_ge[$(this)[0].p.id]=p,this.each(function(){function getFormData(){return $(frmtb).find(".FormElement").each(function(){var celm=$(".customelement",this);if(celm.length){var elem=celm[0],nm=$(elem).attr("name");$.each($t.p.colModel,function(){if(this.name===nm&&this.editoptions&&$.isFunction(this.editoptions.custom_value)){try{if(postdata[nm]=this.editoptions.custom_value.call($t,$("#"+$.jgrid.jqID(nm),frmtb),"get"),void 0===postdata[nm])throw"e1"}catch(e){"e1"===e?$.jgrid.info_dialog(errors.errcap,"function 'custom_value' "+rp_ge[$(this)[0]].p.msg.novalue,rp_ge[$(this)[0]].p.bClose):$.jgrid.info_dialog(errors.errcap,e.message,rp_ge[$(this)[0]].p.bClose)}return!0}})}else{switch($(this).get(0).type){case"checkbox":if($(this).is(":checked"))postdata[this.name]=$(this).val();else{var ofv=$(this).attr("offval");postdata[this.name]=ofv}break;case"select-one":postdata[this.name]=$("option:selected",this).val();break;case"select-multiple":postdata[this.name]=$(this).val(),postdata[this.name]?postdata[this.name]=postdata[this.name].join(","):postdata[this.name]="";var selectedText=[];$("option:selected",this).each(function(i,selected){selectedText[i]=$(selected).text()});break;case"password":case"text":case"textarea":case"button":postdata[this.name]=$(this).val()}$t.p.autoencode&&(postdata[this.name]=$.jgrid.htmlEncode(postdata[this.name]))}}),!0}function createData(rowid,obj,tb,maxcols){var nm,hc,trdata,tmp,dc,elc,i,cnt=0,retpos=[],ind=!1,tdtmpl="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>",tmpl="";for(i=1;maxcols>=i;i++)tmpl+=tdtmpl;if("_empty"!==rowid&&(ind=$(obj).jqGrid("getInd",rowid)),$(obj.p.colModel).each(function(i){if(nm=this.name,hc=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1,dc=hc?"style='display:none'":"","cb"!==nm&&"subgrid"!==nm&&this.editable===!0&&"rn"!==nm){if(ind===!1)tmp="";else if(nm===obj.p.ExpandColumn&&obj.p.treeGrid===!0)tmp=$("td[role='gridcell']:eq("+i+")",obj.rows[ind]).text();else{try{tmp=$.unformat.call(obj,$("td[role='gridcell']:eq("+i+")",obj.rows[ind]),{rowId:rowid,colModel:this},i)}catch(_){tmp=this.edittype&&"textarea"===this.edittype?$("td[role='gridcell']:eq("+i+")",obj.rows[ind]).text():$("td[role='gridcell']:eq("+i+")",obj.rows[ind]).html()}(!tmp||"&nbsp;"===tmp||"&#160;"===tmp||1===tmp.length&&160===tmp.charCodeAt(0))&&(tmp="")}var opt=$.extend({},this.editoptions||{},{id:nm,name:nm,rowId:rowid,oper:"edit"}),frmopt=$.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),rp=parseInt(frmopt.rowpos,10)||cnt+1,cp=parseInt(2*(parseInt(frmopt.colpos,10)||1),10);if("_empty"===rowid&&opt.defaultValue&&(tmp=$.isFunction(opt.defaultValue)?opt.defaultValue.call($t):opt.defaultValue),this.edittype||(this.edittype="text"),$t.p.autoencode&&(tmp=$.jgrid.htmlDecode(tmp)),elc=$.jgrid.createEl.call($t,this.edittype,opt,tmp,!1,$.extend({},$.jgrid.ajaxOptions,obj.p.ajaxSelectOptions||{})),"select"===this.edittype&&(tmp=$(elc).val(),"select-multiple"===$(elc).get(0).type&&(tmp=tmp.join(","))),"checkbox"===this.edittype&&(tmp=$(elc).is(":checked")?$(elc).val():$(elc).attr("offval")),(rp_ge[$t.p.id].checkOnSubmit||rp_ge[$t.p.id].checkOnUpdate)&&(rp_ge[$t.p.id]._savedData[nm]=tmp),$(elc).addClass("FormElement"),$.inArray(this.edittype,["text","textarea","password","select"])>-1&&$(elc).addClass("ui-widget-content ui-corner-all"),templ)$(frm).find("#"+nm).replaceWith(elc);else{if(trdata=$(tb).find("tr[rowpos="+rp+"]"),frmopt.rowabove){var newdata=$("<tr><td class='contentinfo' colspan='"+2*maxcols+"'>"+frmopt.rowcontent+"</td></tr>");$(tb).append(newdata),newdata[0].rp=rp}0===trdata.length&&(trdata=$("<tr "+dc+" rowpos='"+rp+"'></tr>").addClass("FormData").attr("id","tr_"+nm),$(trdata).append(tmpl),$(tb).append(trdata),trdata[0].rp=rp),$("td:eq("+(cp-2)+")",trdata[0]).html(void 0===frmopt.label?obj.p.colNames[i]:frmopt.label),$("td:eq("+(cp-1)+")",trdata[0]).append(frmopt.elmprefix).append(elc).append(frmopt.elmsuffix)}"custom"===this.edittype&&$.isFunction(opt.custom_value)&&opt.custom_value.call($t,$("#"+nm,frmgr),"set",tmp),$.jgrid.bindEv.call($t,elc,opt),retpos[cnt]=i,cnt++}}),cnt>0){var idrow;templ?(idrow="<div class='FormData' style='display:none'><input class='FormElement' id='id_g' type='text' name='"+obj.p.id+"_id' value='"+rowid+"'/>",$(frm).append(idrow)):(idrow=$("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*maxcols-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+obj.p.id+"_id' value='"+rowid+"'/></td></tr>"),idrow[0].rp=cnt+999,$(tb).append(idrow)),(rp_ge[$t.p.id].checkOnSubmit||rp_ge[$t.p.id].checkOnUpdate)&&(rp_ge[$t.p.id]._savedData[obj.p.id+"_id"]=rowid)}return retpos}function fillData(rowid,obj,fmid){var nm,tmp,fld,opt,vl,vlc,cnt=0;(rp_ge[$t.p.id].checkOnSubmit||rp_ge[$t.p.id].checkOnUpdate)&&(rp_ge[$t.p.id]._savedData={},rp_ge[$t.p.id]._savedData[obj.p.id+"_id"]=rowid);var cm=obj.p.colModel;if("_empty"===rowid)return $(cm).each(function(){nm=this.name,opt=$.extend({},this.editoptions||{}),fld=$("#"+$.jgrid.jqID(nm),fmid),fld&&fld.length&&null!==fld[0]&&(vl="","custom"===this.edittype&&$.isFunction(opt.custom_value)?opt.custom_value.call($t,$("#"+nm,fmid),"set",vl):opt.defaultValue?(vl=$.isFunction(opt.defaultValue)?opt.defaultValue.call($t):opt.defaultValue,"checkbox"===fld[0].type?(vlc=vl.toLowerCase(),vlc.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==vlc?(fld[0].checked=!0,fld[0].defaultChecked=!0,fld[0].value=vl):(fld[0].checked=!1,fld[0].defaultChecked=!1)):fld.val(vl)):"checkbox"===fld[0].type?(fld[0].checked=!1,fld[0].defaultChecked=!1,vl=$(fld).attr("offval")):fld[0].type&&"select"===fld[0].type.substr(0,6)?fld[0].selectedIndex=0:fld.val(vl),(rp_ge[$t.p.id].checkOnSubmit===!0||rp_ge[$t.p.id].checkOnUpdate)&&(rp_ge[$t.p.id]._savedData[nm]=vl))}),void $("#id_g",fmid).val(rowid);var tre=$(obj).jqGrid("getInd",rowid,!0);tre&&($('td[role="gridcell"]',tre).each(function(i){if(nm=cm[i].name,"cb"!==nm&&"subgrid"!==nm&&"rn"!==nm&&cm[i].editable===!0){if(nm===obj.p.ExpandColumn&&obj.p.treeGrid===!0)tmp=$(this).text();else try{tmp=$.unformat.call(obj,$(this),{rowId:rowid,colModel:cm[i]},i)}catch(_){tmp="textarea"===cm[i].edittype?$(this).text():$(this).html()}switch($t.p.autoencode&&(tmp=$.jgrid.htmlDecode(tmp)),(rp_ge[$t.p.id].checkOnSubmit===!0||rp_ge[$t.p.id].checkOnUpdate)&&(rp_ge[$t.p.id]._savedData[nm]=tmp),nm=$.jgrid.jqID(nm),cm[i].edittype){case"password":case"text":case"button":case"image":case"textarea":("&nbsp;"===tmp||"&#160;"===tmp||1===tmp.length&&160===tmp.charCodeAt(0))&&(tmp=""),$("#"+nm,fmid).val(tmp);break;case"select":var opv=tmp.split(",");opv=$.map(opv,function(n){return $.trim(n)}),$("#"+nm+" option",fmid).each(function(){cm[i].editoptions.multiple||$.trim(tmp)!==$.trim($(this).text())&&opv[0]!==$.trim($(this).text())&&opv[0]!==$.trim($(this).val())?cm[i].editoptions.multiple&&($.inArray($.trim($(this).text()),opv)>-1||$.inArray($.trim($(this).val()),opv)>-1)?this.selected=!0:this.selected=!1:this.selected=!0}),(rp_ge[$t.p.id].checkOnSubmit===!0||rp_ge[$t.p.id].checkOnUpdate)&&(tmp=$("#"+nm,fmid).val(),cm[i].editoptions.multiple&&(tmp=tmp.join(",")),rp_ge[$t.p.id]._savedData[nm]=tmp);break;case"checkbox":if(tmp=String(tmp),cm[i].editoptions&&cm[i].editoptions.value){var cb=cm[i].editoptions.value.split(":");$("#"+nm,fmid)[$t.p.useProp?"prop":"attr"](cb[0]===tmp?{checked:!0,defaultChecked:!0}:{checked:!1,defaultChecked:!1})}else tmp=tmp.toLowerCase(),tmp.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==tmp?($("#"+nm,fmid)[$t.p.useProp?"prop":"attr"]("checked",!0),$("#"+nm,fmid)[$t.p.useProp?"prop":"attr"]("defaultChecked",!0)):($("#"+nm,fmid)[$t.p.useProp?"prop":"attr"]("checked",!1),$("#"+nm,fmid)[$t.p.useProp?"prop":"attr"]("defaultChecked",!1));(rp_ge[$t.p.id].checkOnSubmit===!0||rp_ge[$t.p.id].checkOnUpdate)&&(tmp=$("#"+nm,fmid).is(":checked")?$("#"+nm,fmid).val():$("#"+nm,fmid).attr("offval"));break;case"custom":try{if(!cm[i].editoptions||!$.isFunction(cm[i].editoptions.custom_value))throw"e1";cm[i].editoptions.custom_value.call($t,$("#"+nm,fmid),"set",tmp)}catch(e){"e1"===e?$.jgrid.info_dialog(errors.errcap,"function 'custom_value' "+rp_ge[$(this)[0]].p.msg.nodefined,$.rp_ge[$(this)[0]].p.bClose):$.jgrid.info_dialog(errors.errcap,e.message,$.rp_ge[$(this)[0]].p.bClose)}}cnt++}}),cnt>0&&$("#id_g",frmtb).val(rowid))}function setNulls(){$.each($t.p.colModel,function(i,n){n.editoptions&&n.editoptions.NullIfEmpty===!0&&postdata.hasOwnProperty(n.name)&&""===postdata[n.name]&&(postdata[n.name]="null")})}function postIt(){var copydata,idname,oper,key,selr,i,url,ret=[!0,"",""],onCS={},opers=$t.p.prmNames,retvals=$($t).triggerHandler("jqGridAddEditBeforeCheckValues",[$(frmgr),frmoper]);retvals&&"object"==typeof retvals&&(postdata=retvals),$.isFunction(rp_ge[$t.p.id].beforeCheckValues)&&(retvals=rp_ge[$t.p.id].beforeCheckValues.call($t,postdata,$(frmgr),frmoper),retvals&&"object"==typeof retvals&&(postdata=retvals));for(key in postdata)if(postdata.hasOwnProperty(key)&&(ret=$.jgrid.checkValues.call($t,postdata[key],key),ret[0]===!1))break;if(setNulls(),ret[0]&&(onCS=$($t).triggerHandler("jqGridAddEditClickSubmit",[rp_ge[$t.p.id],postdata,frmoper]),void 0===onCS&&$.isFunction(rp_ge[$t.p.id].onclickSubmit)&&(onCS=rp_ge[$t.p.id].onclickSubmit.call($t,rp_ge[$t.p.id],postdata,frmoper)||{}),ret=$($t).triggerHandler("jqGridAddEditBeforeSubmit",[postdata,$(frmgr),frmoper]),void 0===ret&&(ret=[!0,"",""]),ret[0]&&$.isFunction(rp_ge[$t.p.id].beforeSubmit)&&(ret=rp_ge[$t.p.id].beforeSubmit.call($t,postdata,$(frmgr),frmoper))),ret[0]&&!rp_ge[$t.p.id].processing){if(rp_ge[$t.p.id].processing=!0,$("#sData",frmtb+"_2").addClass("ui-state-active"),url=rp_ge[$t.p.id].url||$($t).jqGrid("getGridParam","editurl"),oper=opers.oper,idname="clientArray"===url?$t.p.keyName:opers.id,postdata[oper]="_empty"===$.trim(postdata[$t.p.id+"_id"])?opers.addoper:opers.editoper,postdata[oper]!==opers.addoper?postdata[idname]=postdata[$t.p.id+"_id"]:void 0===postdata[idname]&&(postdata[idname]=postdata[$t.p.id+"_id"]),delete postdata[$t.p.id+"_id"],postdata=$.extend(postdata,rp_ge[$t.p.id].editData,onCS),$t.p.treeGrid===!0){if(postdata[oper]===opers.addoper){selr=$($t).jqGrid("getGridParam","selrow");var tr_par_id="adjacency"===$t.p.treeGridModel?$t.p.treeReader.parent_id_field:"parent_id";postdata[tr_par_id]=selr}for(i in $t.p.treeReader)if($t.p.treeReader.hasOwnProperty(i)){var itm=$t.p.treeReader[i];if(postdata.hasOwnProperty(itm)){if(postdata[oper]===opers.addoper&&"parent_id_field"===i)continue;delete postdata[itm]}}}postdata[idname]=$.jgrid.stripPref($t.p.idPrefix,postdata[idname]);var ajaxOptions=$.extend({url:url,type:rp_ge[$t.p.id].mtype,data:$.isFunction(rp_ge[$t.p.id].serializeEditData)?rp_ge[$t.p.id].serializeEditData.call($t,postdata):postdata,complete:function(data,status){var key;if($("#sData",frmtb+"_2").removeClass("ui-state-active"),postdata[idname]=$t.p.idPrefix+postdata[idname],data.status>=300&&304!==data.status?(ret[0]=!1,ret[1]=$($t).triggerHandler("jqGridAddEditErrorTextFormat",[data,frmoper]),$.isFunction(rp_ge[$t.p.id].errorTextFormat)?ret[1]=rp_ge[$t.p.id].errorTextFormat.call($t,data,frmoper):ret[1]=status+" Status: '"+data.statusText+"'. Error code: "+data.status):(ret=$($t).triggerHandler("jqGridAddEditAfterSubmit",[data,postdata,frmoper]),void 0===ret&&(ret=[!0,"",""]),ret[0]&&$.isFunction(rp_ge[$t.p.id].afterSubmit)&&(ret=rp_ge[$t.p.id].afterSubmit.call($t,data,postdata,frmoper))),ret[0]===!1)$(".FormError",frmgr).html(ret[1]),$(".FormError",frmgr).show();else if($t.p.autoencode&&$.each(postdata,function(n,v){postdata[n]=$.jgrid.htmlDecode(v)}),postdata[oper]===opers.addoper?(ret[2]||(ret[2]=$.jgrid.randId()),null==postdata[idname]||"_empty"===postdata[idname]?postdata[idname]=ret[2]:ret[2]=postdata[idname],rp_ge[$t.p.id].reloadAfterSubmit?$($t).trigger("reloadGrid"):$t.p.treeGrid===!0?$($t).jqGrid("addChildNode",ret[2],selr,postdata):$($t).jqGrid("addRowData",ret[2],postdata,p.addedrow),rp_ge[$t.p.id].closeAfterAdd?($t.p.treeGrid!==!0&&$($t).jqGrid("setSelection",ret[2]),$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form})):rp_ge[$t.p.id].clearAfterAdd&&fillData("_empty",$t,frmgr)):(rp_ge[$t.p.id].reloadAfterSubmit?($($t).trigger("reloadGrid"),rp_ge[$t.p.id].closeAfterEdit||setTimeout(function(){$($t).jqGrid("setSelection",postdata[idname])},1e3)):$t.p.treeGrid===!0?$($t).jqGrid("setTreeRow",postdata[idname],postdata):$($t).jqGrid("setRowData",postdata[idname],postdata),
rp_ge[$t.p.id].closeAfterEdit&&$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form})),$.isFunction(rp_ge[$t.p.id].afterComplete)&&(copydata=data,setTimeout(function(){$($t).triggerHandler("jqGridAddEditAfterComplete",[copydata,postdata,$(frmgr),frmoper]),rp_ge[$t.p.id].afterComplete.call($t,copydata,postdata,$(frmgr),frmoper),copydata=null},500)),(rp_ge[$t.p.id].checkOnSubmit||rp_ge[$t.p.id].checkOnUpdate)&&($(frmgr).data("disabled",!1),"_empty"!==rp_ge[$t.p.id]._savedData[$t.p.id+"_id"]))for(key in rp_ge[$t.p.id]._savedData)rp_ge[$t.p.id]._savedData.hasOwnProperty(key)&&postdata[key]&&(rp_ge[$t.p.id]._savedData[key]=postdata[key]);rp_ge[$t.p.id].processing=!1;try{$(":input:visible",frmgr)[0].focus()}catch(e){}}},$.jgrid.ajaxOptions,rp_ge[$t.p.id].ajaxEditOptions);if(ajaxOptions.url||rp_ge[$t.p.id].useDataProxy||$.isFunction($t.p.dataProxy)&&(rp_ge[$t.p.id].useDataProxy=!0),ret[0])if(rp_ge[$t.p.id].useDataProxy){var dpret=$t.p.dataProxy.call($t,ajaxOptions,"set_"+$t.p.id);void 0===dpret&&(dpret=[!0,""]),dpret[0]===!1?(ret[0]=!1,ret[1]=dpret[1]||"Error deleting the selected row!"):(ajaxOptions.data.oper===opers.addoper&&rp_ge[$t.p.id].closeAfterAdd&&$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form}),ajaxOptions.data.oper===opers.editoper&&rp_ge[$t.p.id].closeAfterEdit&&$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form}))}else"clientArray"===ajaxOptions.url?(rp_ge[$t.p.id].reloadAfterSubmit=!1,postdata=ajaxOptions.data,ajaxOptions.complete({status:200,statusText:""},"")):$.ajax(ajaxOptions)}ret[0]===!1&&($(".FormError",frmgr).html(ret[1]),$(".FormError",frmgr).show())}function compareData(nObj,oObj){var key,ret=!1;for(key in nObj)if(nObj.hasOwnProperty(key)&&nObj[key]!=oObj[key]){ret=!0;break}return ret}function checkUpdates(){var stat=!0;return $(".FormError",frmgr).hide(),rp_ge[$t.p.id].checkOnUpdate&&(postdata={},getFormData(),diff=compareData(postdata,rp_ge[$t.p.id]._savedData),diff&&($(frmgr).data("disabled",!0),$(".confirm","#"+IDs.themodal).show(),stat=!1)),stat}function restoreInline(){var i;if("_empty"!==rowid&&void 0!==$t.p.savedRow&&$t.p.savedRow.length>0&&$.isFunction($.fn.jqGrid.restoreRow))for(i=0;i<$t.p.savedRow.length;i++)if($t.p.savedRow[i].id===rowid){$($t).jqGrid("restoreRow",rowid);break}}function updateNav(cr,posarr){var totr=posarr[1].length-1;0===cr?$("#pData",frmtb2).addClass("ui-state-disabled"):void 0!==posarr[1][cr-1]&&$("#"+$.jgrid.jqID(posarr[1][cr-1])).hasClass("ui-state-disabled")?$("#pData",frmtb2).addClass("ui-state-disabled"):$("#pData",frmtb2).removeClass("ui-state-disabled"),cr===totr?$("#nData",frmtb2).addClass("ui-state-disabled"):void 0!==posarr[1][cr+1]&&$("#"+$.jgrid.jqID(posarr[1][cr+1])).hasClass("ui-state-disabled")?$("#nData",frmtb2).addClass("ui-state-disabled"):$("#nData",frmtb2).removeClass("ui-state-disabled")}function getCurrPos(){var rowsInGrid=$($t).jqGrid("getDataIDs"),selrow=$("#id_g",frmtb).val(),pos=$.inArray(selrow,rowsInGrid);return[pos,rowsInGrid]}function parseTemplate(template){var tmpl="";return"string"==typeof template&&(tmpl=template.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(m,i){return'<span id="'+i+'" ></span>'})),tmpl}var $t=this;if($t.grid&&rowid){var frmtb2,postdata,diff,frmoper,gID=$t.p.id,frmgr="FrmGrid_"+gID,frmtborg="TblGrid_"+gID,frmtb="#"+$.jgrid.jqID(frmtborg),IDs={themodal:"editmod"+gID,modalhead:"edithd"+gID,modalcontent:"editcnt"+gID,scrollelm:frmgr},showFrm=!0,maxCols=1,maxRows=0,templ="string"==typeof rp_ge[$t.p.id].template&&rp_ge[$t.p.id].template.length>0,errors=$.jgrid.getRegional(this,"errors");"new"===rowid?(rowid="_empty",frmoper="add",p.caption=rp_ge[$t.p.id].addCaption):(p.caption=rp_ge[$t.p.id].editCaption,frmoper="edit"),p.recreateForm||$($t).data("formProp")&&$.extend(rp_ge[$(this)[0].p.id],$($t).data("formProp"));var closeovrl=!0;p.checkOnUpdate&&p.jqModal&&!p.modal&&(closeovrl=!1);var tbl,dh=isNaN(rp_ge[$(this)[0].p.id].dataheight)?rp_ge[$(this)[0].p.id].dataheight:rp_ge[$(this)[0].p.id].dataheight+"px",dw=isNaN(rp_ge[$(this)[0].p.id].datawidth)?rp_ge[$(this)[0].p.id].datawidth:rp_ge[$(this)[0].p.id].datawidth+"px",frm=$("<form name='FormPost' id='"+frmgr+"' class='FormGrid' onSubmit='return false;' style='width:"+dw+";overflow:auto;position:relative;height:"+dh+";'></form>").data("disabled",!1);if(templ?(tbl=parseTemplate(rp_ge[$(this)[0].p.id].template),frmtb2=frmtb):(tbl=$("<table id='"+frmtborg+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),frmtb2=frmtb+"_2"),frmgr="#"+$.jgrid.jqID(frmgr),$(frm).append("<div class='FormError ui-state-error' style='display:none;'></div>"),$(frm).append("<div class='tinfo topinfo'>"+rp_ge[$t.p.id].topinfo+"</div>"),$($t.p.colModel).each(function(){var fmto=this.formoptions;maxCols=Math.max(maxCols,fmto?fmto.colpos||0:0),maxRows=Math.max(maxRows,fmto?fmto.rowpos||0:0)}),$(frm).append(tbl),showFrm=$($t).triggerHandler("jqGridAddEditBeforeInitData",[frm,frmoper]),void 0===showFrm&&(showFrm=!0),showFrm&&$.isFunction(rp_ge[$t.p.id].beforeInitData)&&(showFrm=rp_ge[$t.p.id].beforeInitData.call($t,frm,frmoper)),showFrm!==!1){restoreInline(),createData(rowid,$t,tbl,maxCols);var rtlb="rtl"===$t.p.direction?!0:!1,bp=rtlb?"nData":"pData",bn=rtlb?"pData":"nData",bP="<a id='"+bp+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",bN="<a id='"+bn+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",bS="<a id='sData' class='fm-button ui-state-default ui-corner-all'>"+p.bSubmit+"</a>",bC="<a id='cData' class='fm-button ui-state-default ui-corner-all'>"+p.bCancel+"</a>",bt="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+frmtborg+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(rtlb?bN+bP:bP+bN)+"</td><td class='EditButton'>"+bS+bC+"</td></tr>";if(bt+="</tbody></table>",maxRows>0){var sd=[];$.each($(tbl)[0].rows,function(i,r){sd[i]=r}),sd.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0}),$.each(sd,function(index,row){$("tbody",tbl).append(row)})}p.gbox="#gbox_"+$.jgrid.jqID(gID);var cle=!1;p.closeOnEscape===!0&&(p.closeOnEscape=!1,cle=!0);var tms;if(templ?($(frm).find("#pData").replaceWith(bP),$(frm).find("#nData").replaceWith(bN),$(frm).find("#sData").replaceWith(bS),$(frm).find("#cData").replaceWith(bC),tms=$("<div id="+frmtborg+"></div>").append(frm)):tms=$("<div></div>").append(frm).append(bt),$(frm).append("<div class='binfo topinfo bottominfo'>"+rp_ge[$t.p.id].bottominfo+"</div>"),$.jgrid.createModal(IDs,tms,rp_ge[$(this)[0].p.id],"#gview_"+$.jgrid.jqID($t.p.id),$("#gbox_"+$.jgrid.jqID($t.p.id))[0]),rtlb&&($("#pData, #nData",frmtb+"_2").css("float","right"),$(".EditButton",frmtb+"_2").css("text-align","left")),rp_ge[$t.p.id].topinfo&&$(".tinfo",frmgr).show(),rp_ge[$t.p.id].bottominfo&&$(".binfo",frmgr).show(),tms=null,bt=null,$("#"+$.jgrid.jqID(IDs.themodal)).keydown(function(e){var wkey=e.target;if($(frmgr).data("disabled")===!0)return!1;if(rp_ge[$t.p.id].savekey[0]===!0&&e.which===rp_ge[$t.p.id].savekey[1]&&"TEXTAREA"!==wkey.tagName)return $("#sData",frmtb+"_2").trigger("click"),!1;if(27===e.which)return checkUpdates()?(cle&&$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:p.gbox,jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form}),!1):!1;if(rp_ge[$t.p.id].navkeys[0]===!0){if("_empty"===$("#id_g",frmtb).val())return!0;if(e.which===rp_ge[$t.p.id].navkeys[1])return $("#pData",frmtb2).trigger("click"),!1;if(e.which===rp_ge[$t.p.id].navkeys[2])return $("#nData",frmtb2).trigger("click"),!1}}),p.checkOnUpdate&&($("a.ui-jqdialog-titlebar-close span","#"+$.jgrid.jqID(IDs.themodal)).removeClass("jqmClose"),$("a.ui-jqdialog-titlebar-close","#"+$.jgrid.jqID(IDs.themodal)).unbind("click").click(function(){return checkUpdates()?($.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form}),!1):!1})),p.saveicon=$.extend([!0,"left","ui-icon-disk"],p.saveicon),p.closeicon=$.extend([!0,"left","ui-icon-close"],p.closeicon),p.saveicon[0]===!0&&$("#sData",frmtb2).addClass("right"===p.saveicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+p.saveicon[2]+"'></span>"),p.closeicon[0]===!0&&$("#cData",frmtb2).addClass("right"===p.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+p.closeicon[2]+"'></span>"),rp_ge[$t.p.id].checkOnSubmit||rp_ge[$t.p.id].checkOnUpdate){bS="<a id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+p.bYes+"</a>",bN="<a id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+p.bNo+"</a>",bC="<a id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+p.bExit+"</a>";var zI=p.zIndex||999;zI++,$("<div class='"+p.overlayClass+" jqgrid-overlay confirm' style='z-index:"+zI+";display:none;'>&#160;</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(zI+1)+"'>"+p.saveData+"<br/><br/>"+bS+bN+bC+"</div>").insertAfter(frmgr),$("#sNew","#"+$.jgrid.jqID(IDs.themodal)).click(function(){return postIt(),$(frmgr).data("disabled",!1),$(".confirm","#"+$.jgrid.jqID(IDs.themodal)).hide(),!1}),$("#nNew","#"+$.jgrid.jqID(IDs.themodal)).click(function(){return $(".confirm","#"+$.jgrid.jqID(IDs.themodal)).hide(),$(frmgr).data("disabled",!1),setTimeout(function(){$(":input:visible",frmgr)[0].focus()},0),!1}),$("#cNew","#"+$.jgrid.jqID(IDs.themodal)).click(function(){return $(".confirm","#"+$.jgrid.jqID(IDs.themodal)).hide(),$(frmgr).data("disabled",!1),$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form}),!1})}$($t).triggerHandler("jqGridAddEditInitializeForm",[$(frmgr),frmoper]),$.isFunction(rp_ge[$t.p.id].onInitializeForm)&&rp_ge[$t.p.id].onInitializeForm.call($t,$(frmgr),frmoper),"_empty"!==rowid&&rp_ge[$t.p.id].viewPagerButtons?$("#pData,#nData",frmtb2).show():$("#pData,#nData",frmtb2).hide(),$($t).triggerHandler("jqGridAddEditBeforeShowForm",[$(frmgr),frmoper]),$.isFunction(rp_ge[$t.p.id].beforeShowForm)&&rp_ge[$t.p.id].beforeShowForm.call($t,$(frmgr),frmoper),$("#"+$.jgrid.jqID(IDs.themodal)).data("onClose",rp_ge[$t.p.id].onClose),$.jgrid.viewModal("#"+$.jgrid.jqID(IDs.themodal),{gbox:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,overlay:p.overlay,modal:p.modal,overlayClass:p.overlayClass,onHide:function(h){var fh=$("#editmod"+gID)[0].style.height;fh.indexOf("px")>-1&&(fh=parseFloat(fh)),$($t).data("formProp",{top:parseFloat($(h.w).css("top")),left:parseFloat($(h.w).css("left")),width:$(h.w).width(),height:fh,dataheight:$(frmgr).height(),datawidth:$(frmgr).width()}),h.w.remove(),h.o&&h.o.remove()}}),closeovrl||$("."+$.jgrid.jqID(p.overlayClass)).click(function(){return checkUpdates()?($.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form}),!1):!1}),$(".fm-button","#"+$.jgrid.jqID(IDs.themodal)).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}),$("#sData",frmtb2).click(function(){return postdata={},$(".FormError",frmgr).hide(),getFormData(),"_empty"===postdata[$t.p.id+"_id"]?postIt():p.checkOnSubmit===!0?(diff=compareData(postdata,rp_ge[$t.p.id]._savedData),diff?($(frmgr).data("disabled",!0),$(".confirm","#"+$.jgrid.jqID(IDs.themodal)).show()):postIt()):postIt(),!1}),$("#cData",frmtb2).click(function(){return checkUpdates()?($.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form}),!1):!1}),$("#nData",frmtb2).click(function(){if(!checkUpdates())return!1;$(".FormError",frmgr).hide();var npos=getCurrPos();if(npos[0]=parseInt(npos[0],10),-1!==npos[0]&&npos[1][npos[0]+1]){$($t).triggerHandler("jqGridAddEditClickPgButtons",["next",$(frmgr),npos[1][npos[0]]]);var nposret;if($.isFunction(p.onclickPgButtons)&&(nposret=p.onclickPgButtons.call($t,"next",$(frmgr),npos[1][npos[0]]),void 0!==nposret&&nposret===!1))return!1;if($("#"+$.jgrid.jqID(npos[1][npos[0]+1])).hasClass("ui-state-disabled"))return!1;fillData(npos[1][npos[0]+1],$t,frmgr),$($t).jqGrid("setSelection",npos[1][npos[0]+1]),$($t).triggerHandler("jqGridAddEditAfterClickPgButtons",["next",$(frmgr),npos[1][npos[0]]]),$.isFunction(p.afterclickPgButtons)&&p.afterclickPgButtons.call($t,"next",$(frmgr),npos[1][npos[0]+1]),updateNav(npos[0]+1,npos)}return!1}),$("#pData",frmtb2).click(function(){if(!checkUpdates())return!1;$(".FormError",frmgr).hide();var ppos=getCurrPos();if(-1!==ppos[0]&&ppos[1][ppos[0]-1]){$($t).triggerHandler("jqGridAddEditClickPgButtons",["prev",$(frmgr),ppos[1][ppos[0]]]);var pposret;if($.isFunction(p.onclickPgButtons)&&(pposret=p.onclickPgButtons.call($t,"prev",$(frmgr),ppos[1][ppos[0]]),void 0!==pposret&&pposret===!1))return!1;if($("#"+$.jgrid.jqID(ppos[1][ppos[0]-1])).hasClass("ui-state-disabled"))return!1;fillData(ppos[1][ppos[0]-1],$t,frmgr),$($t).jqGrid("setSelection",ppos[1][ppos[0]-1]),$($t).triggerHandler("jqGridAddEditAfterClickPgButtons",["prev",$(frmgr),ppos[1][ppos[0]]]),$.isFunction(p.afterclickPgButtons)&&p.afterclickPgButtons.call($t,"prev",$(frmgr),ppos[1][ppos[0]-1]),updateNav(ppos[0]-1,ppos)}return!1}),$($t).triggerHandler("jqGridAddEditAfterShowForm",[$(frmgr),frmoper]),$.isFunction(rp_ge[$t.p.id].afterShowForm)&&rp_ge[$t.p.id].afterShowForm.call($t,$(frmgr),frmoper);var posInit=getCurrPos();updateNav(posInit[0],posInit)}}})},viewGridRow:function(rowid,p){var regional=$.jgrid.getRegional(this[0],"view");return p=$.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"30%",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,recreateForm:!1,removemodal:!0,form:"view"},regional,p||{}),rp_ge[$(this)[0].p.id]=p,this.each(function(){function focusaref(){(rp_ge[$t.p.id].closeOnEscape===!0||rp_ge[$t.p.id].navkeys[0]===!0)&&setTimeout(function(){$(".ui-jqdialog-titlebar-close","#"+$.jgrid.jqID(IDs.modalhead)).attr("tabindex","-1").focus()},0)}function createData(rowid,obj,tb,maxcols){var nm,hc,trdata,tmp,dc,i,maxw,setme,viewfld,cnt=0,retpos=[],ind=!1,tdtmpl="<td class='CaptionTD form-view-label ui-widget-content' width='"+p.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",tmpl="",tdtmpl2="<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>",fmtnum=["integer","number","currency"],max1=0,max2=0;for(i=1;maxcols>=i;i++)tmpl+=1===i?tdtmpl:tdtmpl2;if($(obj.p.colModel).each(function(){hc=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1,hc||"right"!==this.align||(this.formatter&&-1!==$.inArray(this.formatter,fmtnum)?max1=Math.max(max1,parseInt(this.width,10)):max2=Math.max(max2,parseInt(this.width,10)))}),maxw=0!==max1?max1:0!==max2?max2:0,ind=$(obj).jqGrid("getInd",rowid),$(obj.p.colModel).each(function(i){if(nm=this.name,setme=!1,hc=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1,dc=hc?"style='display:none'":"",viewfld="boolean"!=typeof this.viewable?!0:this.viewable,"cb"!==nm&&"subgrid"!==nm&&"rn"!==nm&&viewfld){tmp=ind===!1?"":nm===obj.p.ExpandColumn&&obj.p.treeGrid===!0?$("td:eq("+i+")",obj.rows[ind]).text():$("td:eq("+i+")",obj.rows[ind]).html(),setme="right"===this.align&&0!==maxw?!0:!1;var frmopt=$.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),rp=parseInt(frmopt.rowpos,10)||cnt+1,cp=parseInt(2*(parseInt(frmopt.colpos,10)||1),10);if(frmopt.rowabove){var newdata=$("<tr><td class='contentinfo' colspan='"+2*maxcols+"'>"+frmopt.rowcontent+"</td></tr>");$(tb).append(newdata),newdata[0].rp=rp}trdata=$(tb).find("tr[rowpos="+rp+"]"),0===trdata.length&&(trdata=$("<tr "+dc+" rowpos='"+rp+"'></tr>").addClass("FormData").attr("id","trv_"+nm),$(trdata).append(tmpl),$(tb).append(trdata),trdata[0].rp=rp),$("td:eq("+(cp-2)+")",trdata[0]).html("<b>"+(void 0===frmopt.label?obj.p.colNames[i]:frmopt.label)+"</b>"),$("td:eq("+(cp-1)+")",trdata[0]).append("<span>"+tmp+"</span>").attr("id","v_"+nm),setme&&$("td:eq("+(cp-1)+") span",trdata[0]).css({"text-align":"right",width:maxw+"px"}),retpos[cnt]=i,cnt++}}),cnt>0){var idrow=$("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*maxcols-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+rowid+"'/></td></tr>");idrow[0].rp=cnt+99,$(tb).append(idrow)}return retpos}function fillData(rowid,obj){var nm,hc,tmp,trv,cnt=0;trv=$(obj).jqGrid("getInd",rowid,!0),trv&&($("td",trv).each(function(i){nm=obj.p.colModel[i].name,hc=obj.p.colModel[i].editrules&&obj.p.colModel[i].editrules.edithidden===!0?!1:obj.p.colModel[i].hidden===!0?!0:!1,"cb"!==nm&&"subgrid"!==nm&&"rn"!==nm&&(tmp=nm===obj.p.ExpandColumn&&obj.p.treeGrid===!0?$(this).text():$(this).html(),nm=$.jgrid.jqID("v_"+nm),$("#"+nm+" span","#"+frmtb).html(tmp),hc&&$("#"+nm,"#"+frmtb).parents("tr:first").hide(),cnt++)}),cnt>0&&$("#id_g","#"+frmtb).val(rowid))}function updateNav(cr,posarr){var totr=posarr[1].length-1;0===cr?$("#pData","#"+frmtb+"_2").addClass("ui-state-disabled"):void 0!==posarr[1][cr-1]&&$("#"+$.jgrid.jqID(posarr[1][cr-1])).hasClass("ui-state-disabled")?$("#pData",frmtb+"_2").addClass("ui-state-disabled"):$("#pData","#"+frmtb+"_2").removeClass("ui-state-disabled"),cr===totr?$("#nData","#"+frmtb+"_2").addClass("ui-state-disabled"):void 0!==posarr[1][cr+1]&&$("#"+$.jgrid.jqID(posarr[1][cr+1])).hasClass("ui-state-disabled")?$("#nData",frmtb+"_2").addClass("ui-state-disabled"):$("#nData","#"+frmtb+"_2").removeClass("ui-state-disabled")}function getCurrPos(){var rowsInGrid=$($t).jqGrid("getDataIDs"),selrow=$("#id_g","#"+frmtb).val(),pos=$.inArray(selrow,rowsInGrid);return[pos,rowsInGrid]}var $t=this;if($t.grid&&rowid){var gID=$t.p.id,frmgr="ViewGrid_"+$.jgrid.jqID(gID),frmtb="ViewTbl_"+$.jgrid.jqID(gID),frmgr_id="ViewGrid_"+gID,frmtb_id="ViewTbl_"+gID,IDs={themodal:"viewmod"+gID,modalhead:"viewhd"+gID,modalcontent:"viewcnt"+gID,scrollelm:frmgr},onBeforeInit=$.isFunction(rp_ge[$t.p.id].beforeInitData)?rp_ge[$t.p.id].beforeInitData:!1,showFrm=!0,maxCols=1,maxRows=0;p.recreateForm||$($t).data("viewProp")&&$.extend(rp_ge[$(this)[0].p.id],$($t).data("viewProp"));var dh=isNaN(rp_ge[$(this)[0].p.id].dataheight)?rp_ge[$(this)[0].p.id].dataheight:rp_ge[$(this)[0].p.id].dataheight+"px",dw=isNaN(rp_ge[$(this)[0].p.id].datawidth)?rp_ge[$(this)[0].p.id].datawidth:rp_ge[$(this)[0].p.id].datawidth+"px",frm=$("<form name='FormPost' id='"+frmgr_id+"' class='FormGrid' style='width:"+dw+";overflow:auto;position:relative;height:"+dh+";'></form>"),tbl=$("<table id='"+frmtb_id+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");if($($t.p.colModel).each(function(){var fmto=this.formoptions;maxCols=Math.max(maxCols,fmto?fmto.colpos||0:0),maxRows=Math.max(maxRows,fmto?fmto.rowpos||0:0)}),$(frm).append(tbl),onBeforeInit&&(showFrm=onBeforeInit.call($t,frm),void 0===showFrm&&(showFrm=!0)),showFrm!==!1){createData(rowid,$t,tbl,maxCols);var rtlb="rtl"===$t.p.direction?!0:!1,bp=rtlb?"nData":"pData",bn=rtlb?"pData":"nData",bP="<a id='"+bp+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",bN="<a id='"+bn+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",bC="<a id='cData' class='fm-button ui-state-default ui-corner-all'>"+p.bClose+"</a>";if(maxRows>0){var sd=[];$.each($(tbl)[0].rows,function(i,r){sd[i]=r}),sd.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0}),$.each(sd,function(index,row){$("tbody",tbl).append(row)})}p.gbox="#gbox_"+$.jgrid.jqID(gID);var bt=$("<div></div>").append(frm).append("<table border='0' class='EditTable' id='"+frmtb+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+p.labelswidth+"'>"+(rtlb?bN+bP:bP+bN)+"</td><td class='EditButton'>"+bC+"</td></tr></tbody></table>");$.jgrid.createModal(IDs,bt,p,"#gview_"+$.jgrid.jqID($t.p.id),$("#gview_"+$.jgrid.jqID($t.p.id))[0]),rtlb&&($("#pData, #nData","#"+frmtb+"_2").css("float","right"),$(".EditButton","#"+frmtb+"_2").css("text-align","left")),p.viewPagerButtons||$("#pData, #nData","#"+frmtb+"_2").hide(),bt=null,$("#"+IDs.themodal).keydown(function(e){if(27===e.which)return rp_ge[$t.p.id].closeOnEscape&&$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:p.gbox,jqm:p.jqModal,onClose:p.onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form}),!1;if(p.navkeys[0]===!0){if(e.which===p.navkeys[1])return $("#pData","#"+frmtb+"_2").trigger("click"),!1;if(e.which===p.navkeys[2])return $("#nData","#"+frmtb+"_2").trigger("click"),!1}}),p.closeicon=$.extend([!0,"left","ui-icon-close"],p.closeicon),p.closeicon[0]===!0&&$("#cData","#"+frmtb+"_2").addClass("right"===p.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+p.closeicon[2]+"'></span>"),$.isFunction(p.beforeShowForm)&&p.beforeShowForm.call($t,$("#"+frmgr)),$.jgrid.viewModal("#"+$.jgrid.jqID(IDs.themodal),{gbox:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,overlay:p.overlay,modal:p.modal,onHide:function(h){$($t).data("viewProp",{top:parseFloat($(h.w).css("top")),left:parseFloat($(h.w).css("left")),width:$(h.w).width(),height:$(h.w).height(),dataheight:$("#"+frmgr).height(),datawidth:$("#"+frmgr).width()}),h.w.remove(),h.o&&h.o.remove()}}),$(".fm-button:not(.ui-state-disabled)","#"+frmtb+"_2").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}),focusaref(),$("#cData","#"+frmtb+"_2").click(function(){return $.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:p.onClose,removemodal:rp_ge[$t.p.id].removemodal,formprop:!rp_ge[$t.p.id].recreateForm,form:rp_ge[$t.p.id].form}),!1}),$("#nData","#"+frmtb+"_2").click(function(){$("#FormError","#"+frmtb).hide();var npos=getCurrPos();return npos[0]=parseInt(npos[0],10),-1!==npos[0]&&npos[1][npos[0]+1]&&($.isFunction(p.onclickPgButtons)&&p.onclickPgButtons.call($t,"next",$("#"+frmgr),npos[1][npos[0]]),fillData(npos[1][npos[0]+1],$t),$($t).jqGrid("setSelection",npos[1][npos[0]+1]),$.isFunction(p.afterclickPgButtons)&&p.afterclickPgButtons.call($t,"next",$("#"+frmgr),npos[1][npos[0]+1]),updateNav(npos[0]+1,npos)),focusaref(),!1}),$("#pData","#"+frmtb+"_2").click(function(){$("#FormError","#"+frmtb).hide();var ppos=getCurrPos();return-1!==ppos[0]&&ppos[1][ppos[0]-1]&&($.isFunction(p.onclickPgButtons)&&p.onclickPgButtons.call($t,"prev",$("#"+frmgr),ppos[1][ppos[0]]),fillData(ppos[1][ppos[0]-1],$t),$($t).jqGrid("setSelection",ppos[1][ppos[0]-1]),$.isFunction(p.afterclickPgButtons)&&p.afterclickPgButtons.call($t,"prev",$("#"+frmgr),ppos[1][ppos[0]-1]),updateNav(ppos[0]-1,ppos)),focusaref(),!1});var posInit=getCurrPos();updateNav(posInit[0],posInit)}}})},delGridRow:function(rowids,p){var regional=$.jgrid.getRegional(this[0],"del");return p=$.extend(!0,{top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},regional,p||{}),rp_ge[$(this)[0].p.id]=p,this.each(function(){var $t=this;if($t.grid&&rowids){var postd,idname,opers,oper,onBeforeShow=$.isFunction(rp_ge[$t.p.id].beforeShowForm),onAfterShow=$.isFunction(rp_ge[$t.p.id].afterShowForm),onBeforeInit=$.isFunction(rp_ge[$t.p.id].beforeInitData)?rp_ge[$t.p.id].beforeInitData:!1,gID=$t.p.id,onCS={},showFrm=!0,dtbl="DelTbl_"+$.jgrid.jqID(gID),dtbl_id="DelTbl_"+gID,IDs={themodal:"delmod"+gID,modalhead:"delhd"+gID,modalcontent:"delcnt"+gID,scrollelm:dtbl};if($.isArray(rowids)&&(rowids=rowids.join()),void 0!==$("#"+$.jgrid.jqID(IDs.themodal))[0]){if(onBeforeInit&&(showFrm=onBeforeInit.call($t,$("#"+dtbl)),void 0===showFrm&&(showFrm=!0)),showFrm===!1)return;$("#DelData>td","#"+dtbl).text(rowids),$("#DelError","#"+dtbl).hide(),rp_ge[$t.p.id].processing===!0&&(rp_ge[$t.p.id].processing=!1,$("#dData","#"+dtbl).removeClass("ui-state-active")),onBeforeShow&&rp_ge[$t.p.id].beforeShowForm.call($t,$("#"+dtbl)),$.jgrid.viewModal("#"+$.jgrid.jqID(IDs.themodal),{gbox:"#gbox_"+$.jgrid.jqID(gID),jqm:rp_ge[$t.p.id].jqModal,jqM:!1,overlay:rp_ge[$t.p.id].overlay,modal:rp_ge[$t.p.id].modal}),onAfterShow&&rp_ge[$t.p.id].afterShowForm.call($t,$("#"+dtbl))}else{var dh=isNaN(rp_ge[$t.p.id].dataheight)?rp_ge[$t.p.id].dataheight:rp_ge[$t.p.id].dataheight+"px",dw=isNaN(p.datawidth)?p.datawidth:p.datawidth+"px",tbl="<div id='"+dtbl_id+"' class='formdata' style='width:"+dw+";overflow:auto;position:relative;height:"+dh+";'>";tbl+="<table class='DelTable'><tbody>",tbl+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>",tbl+="<tr id='DelData' style='display:none'><td >"+rowids+"</td></tr>",tbl+='<tr><td class="delmsg" style="white-space:pre;">'+rp_ge[$t.p.id].msg+"</td></tr><tr><td >&#160;</td></tr>",tbl+="</tbody></table></div>";var bS="<a id='dData' class='fm-button ui-state-default ui-corner-all'>"+p.bSubmit+"</a>",bC="<a id='eData' class='fm-button ui-state-default ui-corner-all'>"+p.bCancel+"</a>";if(tbl+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+dtbl+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton'>"+bS+"&#160;"+bC+"</td></tr></tbody></table>",p.gbox="#gbox_"+$.jgrid.jqID(gID),$.jgrid.createModal(IDs,tbl,p,"#gview_"+$.jgrid.jqID($t.p.id),$("#gview_"+$.jgrid.jqID($t.p.id))[0]),onBeforeInit&&(showFrm=onBeforeInit.call($t,$(tbl)),void 0===showFrm&&(showFrm=!0)),showFrm===!1)return;$(".fm-button","#"+dtbl+"_2").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}),p.delicon=$.extend([!0,"left","ui-icon-scissors"],rp_ge[$t.p.id].delicon),p.cancelicon=$.extend([!0,"left","ui-icon-cancel"],rp_ge[$t.p.id].cancelicon),p.delicon[0]===!0&&$("#dData","#"+dtbl+"_2").addClass("right"===p.delicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+p.delicon[2]+"'></span>"),p.cancelicon[0]===!0&&$("#eData","#"+dtbl+"_2").addClass("right"===p.cancelicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+p.cancelicon[2]+"'></span>"),$("#dData","#"+dtbl+"_2").click(function(){var pk,ret=[!0,""],postdata=$("#DelData>td","#"+dtbl).text();if(onCS={},$.isFunction(rp_ge[$t.p.id].onclickSubmit)&&(onCS=rp_ge[$t.p.id].onclickSubmit.call($t,rp_ge[$t.p.id],postdata)||{}),$.isFunction(rp_ge[$t.p.id].beforeSubmit)&&(ret=rp_ge[$t.p.id].beforeSubmit.call($t,postdata)),ret[0]&&!rp_ge[$t.p.id].processing){if(rp_ge[$t.p.id].processing=!0,opers=$t.p.prmNames,postd=$.extend({},rp_ge[$t.p.id].delData,onCS),oper=opers.oper,postd[oper]=opers.deloper,idname=opers.id,postdata=String(postdata).split(","),!postdata.length)return!1;for(pk in postdata)postdata.hasOwnProperty(pk)&&(postdata[pk]=$.jgrid.stripPref($t.p.idPrefix,postdata[pk]));postd[idname]=postdata.join(),$(this).addClass("ui-state-active");var ajaxOptions=$.extend({url:rp_ge[$t.p.id].url||$($t).jqGrid("getGridParam","editurl"),type:rp_ge[$t.p.id].mtype,data:$.isFunction(rp_ge[$t.p.id].serializeDelData)?rp_ge[$t.p.id].serializeDelData.call($t,postd):postd,complete:function(data,status){var i;if($("#dData","#"+dtbl+"_2").removeClass("ui-state-active"),data.status>=300&&304!==data.status?(ret[0]=!1,$.isFunction(rp_ge[$t.p.id].errorTextFormat)?ret[1]=rp_ge[$t.p.id].errorTextFormat.call($t,data):ret[1]=status+" Status: '"+data.statusText+"'. Error code: "+data.status):$.isFunction(rp_ge[$t.p.id].afterSubmit)&&(ret=rp_ge[$t.p.id].afterSubmit.call($t,data,postd)),ret[0]===!1)$("#DelError>td","#"+dtbl).html(ret[1]),$("#DelError","#"+dtbl).show();else{if(rp_ge[$t.p.id].reloadAfterSubmit&&"local"!==$t.p.datatype)$($t).trigger("reloadGrid");else{if($t.p.treeGrid===!0)try{$($t).jqGrid("delTreeNode",$t.p.idPrefix+postdata[0])}catch(e){}else for(i=0;i<postdata.length;i++)$($t).jqGrid("delRowData",$t.p.idPrefix+postdata[i]);$t.p.selrow=null,$t.p.selarrrow=[]}$.isFunction(rp_ge[$t.p.id].afterComplete)&&setTimeout(function(){rp_ge[$t.p.id].afterComplete.call($t,data,postdata)},500)}rp_ge[$t.p.id].processing=!1,ret[0]&&$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose})}},$.jgrid.ajaxOptions,rp_ge[$t.p.id].ajaxDelOptions);if(ajaxOptions.url||rp_ge[$t.p.id].useDataProxy||$.isFunction($t.p.dataProxy)&&(rp_ge[$t.p.id].useDataProxy=!0),ret[0])if(rp_ge[$t.p.id].useDataProxy){var dpret=$t.p.dataProxy.call($t,ajaxOptions,"del_"+$t.p.id);void 0===dpret&&(dpret=[!0,""]),dpret[0]===!1?(ret[0]=!1,ret[1]=dpret[1]||"Error deleting the selected row!"):$.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:p.jqModal,onClose:rp_ge[$t.p.id].onClose})}else"clientArray"===ajaxOptions.url?(postd=ajaxOptions.data,ajaxOptions.complete({status:200,statusText:""},"")):$.ajax(ajaxOptions)}return ret[0]===!1&&($("#DelError>td","#"+dtbl).html(ret[1]),$("#DelError","#"+dtbl).show()),!1}),$("#eData","#"+dtbl+"_2").click(function(){return $.jgrid.hideModal("#"+$.jgrid.jqID(IDs.themodal),{gb:"#gbox_"+$.jgrid.jqID(gID),jqm:rp_ge[$t.p.id].jqModal,onClose:rp_ge[$t.p.id].onClose}),!1}),onBeforeShow&&rp_ge[$t.p.id].beforeShowForm.call($t,$("#"+dtbl)),$.jgrid.viewModal("#"+$.jgrid.jqID(IDs.themodal),{gbox:"#gbox_"+$.jgrid.jqID(gID),jqm:rp_ge[$t.p.id].jqModal,overlay:rp_ge[$t.p.id].overlay,modal:rp_ge[$t.p.id].modal}),onAfterShow&&rp_ge[$t.p.id].afterShowForm.call($t,$("#"+dtbl))}rp_ge[$t.p.id].closeOnEscape===!0&&setTimeout(function(){$(".ui-jqdialog-titlebar-close","#"+$.jgrid.jqID(IDs.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(elem,p,pEdit,pAdd,pDel,pSearch,pView){var regional=$.jgrid.getRegional(this[0],"nav");return p=$.extend({edit:!0,editicon:"ui-icon-pencil",add:!0,addicon:"ui-icon-plus",del:!0,delicon:"ui-icon-trash",search:!0,searchicon:"ui-icon-search",refresh:!0,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:!1,viewicon:"ui-icon-document",position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,alertwidth:200,alertheight:"auto",alerttop:null,alertleft:null,alertzIndex:null},regional,p||{}),this.each(function(){if(!this.p.navGrid){var twd,tdw,o,alertIDs={themodal:"alertmod_"+this.p.id,modalhead:"alerthd_"+this.p.id,modalcontent:"alertcnt_"+this.p.id},$t=this;if($t.grid&&"string"==typeof elem){$($t).data("navGrid")||$($t).data("navGrid",p),
o=$($t).data("navGrid"),$t.p.force_regional&&(o=$.extend(o,regional)),void 0===$("#"+alertIDs.themodal)[0]&&(o.alerttop||o.alertleft||(void 0!==window.innerWidth?(o.alertleft=window.innerWidth,o.alerttop=window.innerHeight):void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(o.alertleft=document.documentElement.clientWidth,o.alerttop=document.documentElement.clientHeight):(o.alertleft=1024,o.alerttop=768),o.alertleft=o.alertleft/2-parseInt(o.alertwidth,10)/2,o.alerttop=o.alerttop/2-25),$.jgrid.createModal(alertIDs,"<div>"+o.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+$.jgrid.jqID($t.p.id),jqModal:!0,drag:!0,resize:!0,caption:o.alertcap,top:o.alerttop,left:o.alertleft,width:o.alertwidth,height:o.alertheight,closeOnEscape:o.closeOnEscape,zIndex:o.alertzIndex},"#gview_"+$.jgrid.jqID($t.p.id),$("#gbox_"+$.jgrid.jqID($t.p.id))[0],!0));var i,clone=1,onHoverIn=function(){$(this).hasClass("ui-state-disabled")||$(this).addClass("ui-state-hover")},onHoverOut=function(){$(this).removeClass("ui-state-hover")};for(o.cloneToTop&&$t.p.toppager&&(clone=2),i=0;clone>i;i++){var tbd,pgid,elemids,navtbl=$("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),sep="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>";0===i?(pgid=elem,elemids=$t.p.id,pgid===$t.p.toppager&&(elemids+="_top",clone=1)):(pgid=$t.p.toppager,elemids=$t.p.id+"_top"),"rtl"===$t.p.direction&&$(navtbl).attr("dir","rtl").css("float","right"),pAdd=pAdd||{},o.add&&(tbd=$("<td class='ui-pg-button ui-corner-all'></td>"),$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.addicon+"'></span>"+o.addtext+"</div>"),$("tr",navtbl).append(tbd),$(tbd,navtbl).attr({title:o.addtitle||"",id:pAdd.id||"add_"+elemids}).click(function(){return $(this).hasClass("ui-state-disabled")||($.isFunction(o.addfunc)?o.addfunc.call($t):$($t).jqGrid("editGridRow","new",pAdd)),!1}).hover(onHoverIn,onHoverOut),tbd=null),pEdit=pEdit||{},o.edit&&(tbd=$("<td class='ui-pg-button ui-corner-all'></td>"),$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.editicon+"'></span>"+o.edittext+"</div>"),$("tr",navtbl).append(tbd),$(tbd,navtbl).attr({title:o.edittitle||"",id:pEdit.id||"edit_"+elemids}).click(function(){if(!$(this).hasClass("ui-state-disabled")){var sr=$t.p.selrow;sr?$.isFunction(o.editfunc)?o.editfunc.call($t,sr):$($t).jqGrid("editGridRow",sr,pEdit):($.jgrid.viewModal("#"+alertIDs.themodal,{gbox:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:!0}),$("#jqg_alrt").focus())}return!1}).hover(onHoverIn,onHoverOut),tbd=null),pView=pView||{},o.view&&(tbd=$("<td class='ui-pg-button ui-corner-all'></td>"),$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.viewicon+"'></span>"+o.viewtext+"</div>"),$("tr",navtbl).append(tbd),$(tbd,navtbl).attr({title:o.viewtitle||"",id:pView.id||"view_"+elemids}).click(function(){if(!$(this).hasClass("ui-state-disabled")){var sr=$t.p.selrow;sr?$.isFunction(o.viewfunc)?o.viewfunc.call($t,sr):$($t).jqGrid("viewGridRow",sr,pView):($.jgrid.viewModal("#"+alertIDs.themodal,{gbox:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:!0}),$("#jqg_alrt").focus())}return!1}).hover(onHoverIn,onHoverOut),tbd=null),pDel=pDel||{},o.del&&(tbd=$("<td class='ui-pg-button ui-corner-all'></td>"),$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.delicon+"'></span>"+o.deltext+"</div>"),$("tr",navtbl).append(tbd),$(tbd,navtbl).attr({title:o.deltitle||"",id:pDel.id||"del_"+elemids}).click(function(){if(!$(this).hasClass("ui-state-disabled")){var dr;$t.p.multiselect?(dr=$t.p.selarrrow,0===dr.length&&(dr=null)):dr=$t.p.selrow,dr?$.isFunction(o.delfunc)?o.delfunc.call($t,dr):$($t).jqGrid("delGridRow",dr,pDel):($.jgrid.viewModal("#"+alertIDs.themodal,{gbox:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:!0}),$("#jqg_alrt").focus())}return!1}).hover(onHoverIn,onHoverOut),tbd=null),(o.add||o.edit||o.del||o.view)&&$("tr",navtbl).append(sep),pSearch=pSearch||{},o.search&&(tbd=$("<td class='ui-pg-button ui-corner-all'></td>"),$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.searchicon+"'></span>"+o.searchtext+"</div>"),$("tr",navtbl).append(tbd),$(tbd,navtbl).attr({title:o.searchtitle||"",id:pSearch.id||"search_"+elemids}).click(function(){return $(this).hasClass("ui-state-disabled")||($.isFunction(o.searchfunc)?o.searchfunc.call($t,pSearch):$($t).jqGrid("searchGrid",pSearch)),!1}).hover(onHoverIn,onHoverOut),pSearch.showOnLoad&&pSearch.showOnLoad===!0&&$(tbd,navtbl).click(),tbd=null),o.refresh&&(tbd=$("<td class='ui-pg-button ui-corner-all'></td>"),$(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.refreshicon+"'></span>"+o.refreshtext+"</div>"),$("tr",navtbl).append(tbd),$(tbd,navtbl).attr({title:o.refreshtitle||"",id:"refresh_"+elemids}).click(function(){if(!$(this).hasClass("ui-state-disabled")){$.isFunction(o.beforeRefresh)&&o.beforeRefresh.call($t),$t.p.search=!1,$t.p.resetsearch=!0;try{if("currentfilter"!==o.refreshstate){var gID=$t.p.id;$t.p.postData.filters="";try{$("#fbox_"+$.jgrid.jqID(gID)).jqFilter("resetFilter")}catch(ef){}$.isFunction($t.clearToolbar)&&$t.clearToolbar.call($t,!1)}}catch(e){}switch(o.refreshstate){case"firstpage":$($t).trigger("reloadGrid",[{page:1}]);break;case"current":case"currentfilter":$($t).trigger("reloadGrid",[{current:!0}])}$.isFunction(o.afterRefresh)&&o.afterRefresh.call($t)}return!1}).hover(onHoverIn,onHoverOut),tbd=null),tdw=$(".ui-jqgrid").css("font-size")||"11px",$("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+tdw+";visibility:hidden;' ></div>"),twd=$(navtbl).clone().appendTo("#testpg2").width(),$("#testpg2").remove(),$(pgid+"_"+o.position,pgid).append(navtbl),$t.p._nvtd&&(twd>$t.p._nvtd[0]&&($(pgid+"_"+o.position,pgid).width(twd),$t.p._nvtd[0]=twd),$t.p._nvtd[1]=twd),tdw=null,twd=null,navtbl=null,$t.p.navGrid=!0}$t.p.storeNavOptions&&($t.p.navOptions=o,$t.p.editOptions=pEdit,$t.p.addOptions=pAdd,$t.p.delOptions=pDel,$t.p.searchOptions=pSearch,$t.p.viewOptions=pView)}}})},navButtonAdd:function(elem,p){return p=$.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},p||{}),this.each(function(){if(this.grid){"string"==typeof elem&&0!==elem.indexOf("#")&&(elem="#"+$.jgrid.jqID(elem));var findnav=$(".navtable",elem)[0],$t=this;if(findnav){if(p.id&&void 0!==$("#"+$.jgrid.jqID(p.id),findnav)[0])return;var tbd=$("<td></td>");$(tbd).addClass("ui-pg-button ui-corner-all").append("NONE"===p.buttonicon.toString().toUpperCase()?"<div class='ui-pg-div'>"+p.caption+"</div>":"<div class='ui-pg-div'><span class='ui-icon "+p.buttonicon+"'></span>"+p.caption+"</div>"),p.id&&$(tbd).attr("id",p.id),"first"===p.position?0===findnav.rows[0].cells.length?$("tr",findnav).append(tbd):$("tr td:eq(0)",findnav).before(tbd):$("tr",findnav).append(tbd),$(tbd,findnav).attr("title",p.title||"").click(function(e){return $(this).hasClass("ui-state-disabled")||$.isFunction(p.onClickButton)&&p.onClickButton.call($t,e),!1}).hover(function(){$(this).hasClass("ui-state-disabled")||$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")})}}})},navSeparatorAdd:function(elem,p){return p=$.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},p||{}),this.each(function(){if(this.grid){"string"==typeof elem&&0!==elem.indexOf("#")&&(elem="#"+$.jgrid.jqID(elem));var findnav=$(".navtable",elem)[0];if(findnav){var sep="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+p.sepclass+"'></span>"+p.sepcontent+"</td>";"first"===p.position?0===findnav.rows[0].cells.length?$("tr",findnav).append(sep):$("tr td:eq(0)",findnav).before(sep):$("tr",findnav).append(sep)}}})},GridToForm:function(rowid,formid){return this.each(function(){var i,$t=this;if($t.grid){var rowdata=$($t).jqGrid("getRowData",rowid);if(rowdata)for(i in rowdata)rowdata.hasOwnProperty(i)&&($("[name="+$.jgrid.jqID(i)+"]",formid).is("input:radio")||$("[name="+$.jgrid.jqID(i)+"]",formid).is("input:checkbox")?$("[name="+$.jgrid.jqID(i)+"]",formid).each(function(){$(this).val()==rowdata[i]?$(this)[$t.p.useProp?"prop":"attr"]("checked",!0):$(this)[$t.p.useProp?"prop":"attr"]("checked",!1)}):$("[name="+$.jgrid.jqID(i)+"]",formid).val(rowdata[i]))}})},FormToGrid:function(rowid,formid,mode,position){return this.each(function(){var $t=this;if($t.grid){mode||(mode="set"),position||(position="first");var fields=$(formid).serializeArray(),griddata={};$.each(fields,function(i,field){griddata[field.name]=field.value}),"add"===mode?$($t).jqGrid("addRowData",rowid,griddata,position):"set"===mode&&$($t).jqGrid("setRowData",rowid,griddata)}})}}),$.jgrid.extend({groupingSetup:function(){return this.each(function(){var i,j,cml,$t=this,cm=$t.p.colModel,grp=$t.p.groupingView;if(null===grp||"object"!=typeof grp&&!$.isFunction(grp))$t.p.grouping=!1;else if(grp.groupField.length){for(void 0===grp.visibiltyOnNextGrouping&&(grp.visibiltyOnNextGrouping=[]),grp.lastvalues=[],grp._locgr||(grp.groups=[]),grp.counters=[],i=0;i<grp.groupField.length;i++)grp.groupOrder[i]||(grp.groupOrder[i]="asc"),grp.groupText[i]||(grp.groupText[i]="{0}"),"boolean"!=typeof grp.groupColumnShow[i]&&(grp.groupColumnShow[i]=!0),"boolean"!=typeof grp.groupSummary[i]&&(grp.groupSummary[i]=!1),grp.groupSummaryPos[i]||(grp.groupSummaryPos[i]="footer"),grp.groupColumnShow[i]===!0?(grp.visibiltyOnNextGrouping[i]=!0,$($t).jqGrid("showCol",grp.groupField[i])):(grp.visibiltyOnNextGrouping[i]=$("#"+$.jgrid.jqID($t.p.id+"_"+grp.groupField[i])).is(":visible"),$($t).jqGrid("hideCol",grp.groupField[i]));for(grp.summary=[],grp.hideFirstGroupCol&&(grp.formatDisplayField[0]=function(v){return v}),j=0,cml=cm.length;cml>j;j++)grp.hideFirstGroupCol&&(cm[j].hidden||grp.groupField[0]!==cm[j].name||(cm[j].formatter=function(){return""})),cm[j].summaryType&&grp.summary.push(cm[j].summaryDivider?{nm:cm[j].name,st:cm[j].summaryType,v:"",sd:cm[j].summaryDivider,vd:"",sr:cm[j].summaryRound,srt:cm[j].summaryRoundType||"round"}:{nm:cm[j].name,st:cm[j].summaryType,v:"",sr:cm[j].summaryRound,srt:cm[j].summaryRoundType||"round"})}else $t.p.grouping=!1})},groupingPrepare:function(record,irow){return this.each(function(){var i,fieldName,v,displayName,displayValue,grp=this.p.groupingView,$t=this,sumGroups=function(){$.isFunction(this.st)?this.v=this.st.call($t,this.v,this.nm,record):(this.v=$($t).jqGrid("groupingCalculations.handler",this.st,this.v,this.nm,this.sr,this.srt,record),"avg"===this.st.toLowerCase()&&this.sd&&(this.vd=$($t).jqGrid("groupingCalculations.handler",this.st,this.vd,this.sd,this.sr,this.srt,record)))},grlen=grp.groupField.length,changed=0;for(i=0;grlen>i;i++)fieldName=grp.groupField[i],displayName=grp.displayField[i],v=record[fieldName],displayValue=null==displayName?null:record[displayName],null==displayValue&&(displayValue=v),void 0!==v&&(0===irow?(grp.groups.push({idx:i,dataIndex:fieldName,value:v,displayValue:displayValue,startRow:irow,cnt:1,summary:[]}),grp.lastvalues[i]=v,grp.counters[i]={cnt:1,pos:grp.groups.length-1,summary:$.extend(!0,[],grp.summary)},$.each(grp.counters[i].summary,sumGroups),grp.groups[grp.counters[i].pos].summary=grp.counters[i].summary):"object"==typeof v||($.isArray(grp.isInTheSameGroup)&&$.isFunction(grp.isInTheSameGroup[i])?grp.isInTheSameGroup[i].call($t,grp.lastvalues[i],v,i,grp):grp.lastvalues[i]===v)?1===changed?(grp.groups.push({idx:i,dataIndex:fieldName,value:v,displayValue:displayValue,startRow:irow,cnt:1,summary:[]}),grp.lastvalues[i]=v,grp.counters[i]={cnt:1,pos:grp.groups.length-1,summary:$.extend(!0,[],grp.summary)},$.each(grp.counters[i].summary,sumGroups),grp.groups[grp.counters[i].pos].summary=grp.counters[i].summary):(grp.counters[i].cnt+=1,grp.groups[grp.counters[i].pos].cnt=grp.counters[i].cnt,$.each(grp.counters[i].summary,sumGroups),grp.groups[grp.counters[i].pos].summary=grp.counters[i].summary):(grp.groups.push({idx:i,dataIndex:fieldName,value:v,displayValue:displayValue,startRow:irow,cnt:1,summary:[]}),grp.lastvalues[i]=v,changed=1,grp.counters[i]={cnt:1,pos:grp.groups.length-1,summary:$.extend(!0,[],grp.summary)},$.each(grp.counters[i].summary,sumGroups),grp.groups[grp.counters[i].pos].summary=grp.counters[i].summary))}),this},groupingToggle:function(hid){return this.each(function(){var $t=this,grp=$t.p.groupingView,strpos=hid.split("_"),num=parseInt(strpos[strpos.length-2],10);strpos.splice(strpos.length-2,2);var itemGroupingLevel,showData,uid=strpos.join("_"),minus=grp.minusicon,plus=grp.plusicon,tar=$("#"+$.jgrid.jqID(hid)),r=tar.length?tar[0].nextSibling:null,tarspan=$("#"+$.jgrid.jqID(hid)+" span.tree-wrap-"+$t.p.direction),getGroupingLevelFromClass=function(className){var nums=$.map(className.split(" "),function(item){return item.substring(0,uid.length+1)===uid+"_"?parseInt(item.substring(uid.length+1),10):void 0});return nums.length>0?nums[0]:void 0},collapsed=!1,skip=!1,frz=$t.p.frozenColumns?$t.p.id+"_frozen":!1,tar2=frz?$("#"+$.jgrid.jqID(hid),"#"+$.jgrid.jqID(frz)):!1,r2=tar2&&tar2.length?tar2[0].nextSibling:null;if(tarspan.hasClass(minus)){if(grp.showSummaryOnHide){if(r)for(;r&&(itemGroupingLevel=getGroupingLevelFromClass(r.className),!(void 0!==itemGroupingLevel&&num>=itemGroupingLevel));)$(r).hide(),r=r.nextSibling,frz&&($(r2).hide(),r2=r2.nextSibling)}else if(r)for(;r&&(itemGroupingLevel=getGroupingLevelFromClass(r.className),!(void 0!==itemGroupingLevel&&num>=itemGroupingLevel));)$(r).hide(),r=r.nextSibling,frz&&($(r2).hide(),r2=r2.nextSibling);tarspan.removeClass(minus).addClass(plus),collapsed=!0}else{if(r)for(showData=void 0;r;){if(itemGroupingLevel=getGroupingLevelFromClass(r.className),void 0===showData&&(showData=void 0===itemGroupingLevel),skip=$(r).hasClass("ui-subgrid")&&$(r).hasClass("ui-sg-collapsed"),void 0!==itemGroupingLevel){if(num>=itemGroupingLevel)break;itemGroupingLevel===num+1&&(skip||($(r).show().find(">td>span.tree-wrap-"+$t.p.direction).removeClass(minus).addClass(plus),frz&&$(r2).show().find(">td>span.tree-wrap-"+$t.p.direction).removeClass(minus).addClass(plus)))}else showData&&(skip||($(r).show(),frz&&$(r2).show()));r=r.nextSibling,frz&&(r2=r2.nextSibling)}tarspan.removeClass(plus).addClass(minus)}$($t).triggerHandler("jqGridGroupingClickGroup",[hid,collapsed]),$.isFunction($t.p.onClickGroup)&&$t.p.onClickGroup.call($t,hid,collapsed)}),!1},groupingRender:function(grdata,colspans,page,rn){return this.each(function(){function findGroupIdx(ind,offset,grp){var i,ret=!1;if(0===offset)ret=grp[ind];else{var id=grp[ind].idx;if(0===id)ret=grp[ind];else for(i=ind;i>=0;i--)if(grp[i].idx===id-offset){ret=grp[i];break}}return ret}function buildSummaryTd(i,ik,grp,foffset){var vv,k,fdata=findGroupIdx(i,ik,grp),cm=$t.p.colModel,grlen=fdata.cnt,str="";for(k=foffset;colspans>k;k++){var tmpdata="<td "+$t.formatCol(k,1,"")+">&#160;</td>",tplfld="{0}";$.each(fdata.summary,function(){if(this.nm===cm[k].name){cm[k].summaryTpl&&(tplfld=cm[k].summaryTpl),"string"==typeof this.st&&"avg"===this.st.toLowerCase()&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&grlen>0&&(this.v=this.v/grlen));try{this.groupCount=fdata.cnt,this.groupIndex=fdata.dataIndex,this.groupValue=fdata.value,vv=$t.formatter("",this.v,k,this)}catch(ef){vv=this.v}return tmpdata="<td "+$t.formatCol(k,1,"")+">"+$.jgrid.template(tplfld,vv)+"</td>",!1}}),str+=tmpdata}return str}var hid,clid,gv,$t=this,grp=$t.p.groupingView,str="",icon="",pmrtl=grp.groupCollapse?grp.plusicon:grp.minusicon,cp=[],len=grp.groupField.length;pmrtl+=" tree-wrap-"+$t.p.direction,$.each($t.p.colModel,function(i,n){var ii;for(ii=0;len>ii;ii++)if(grp.groupField[ii]===n.name){cp[ii]=i;break}});var mul,toEnd=0,sumreverse=$.makeArray(grp.groupSummary);sumreverse.reverse(),mul=$t.p.multiselect?' colspan="2"':"",$.each(grp.groups,function(i,n){if(grp._locgr&&!(n.startRow+n.cnt>(page-1)*rn&&n.startRow<page*rn))return!0;toEnd++,clid=$t.p.id+"ghead_"+n.idx,hid=clid+"_"+i,icon="<span style='cursor:pointer;' class='ui-icon "+pmrtl+"' onclick=\"jQuery('#"+$.jgrid.jqID($t.p.id)+"').jqGrid('groupingToggle','"+hid+"');return false;\"></span>";try{$.isArray(grp.formatDisplayField)&&$.isFunction(grp.formatDisplayField[n.idx])?(n.displayValue=grp.formatDisplayField[n.idx].call($t,n.displayValue,n.value,$t.p.colModel[cp[n.idx]],n.idx,grp),gv=n.displayValue):gv=$t.formatter(hid,n.displayValue,cp[n.idx],n.value)}catch(egv){gv=n.displayValue}var grpTextStr="";grpTextStr=$.isFunction(grp.groupText[n.idx])?grp.groupText[n.idx].call($t,gv,n.cnt,n.summary):$.jgrid.template(grp.groupText[n.idx],gv,n.cnt,n.summary),"string"!=typeof grpTextStr&&"number"!=typeof grpTextStr&&(grpTextStr=gv),"header"===grp.groupSummaryPos[n.idx]?(str+='<tr id="'+hid+'"'+(grp.groupCollapse&&n.idx>0?' style="display:none;" ':" ")+'role="row" class= "ui-widget-content jqgroup ui-row-'+$t.p.direction+" "+clid+'"><td style="padding-left:'+12*n.idx+'px;"'+mul+">"+icon+grpTextStr+"</td>",str+=buildSummaryTd(i,0,grp.groups,grp.groupColumnShow[n.idx]===!1?""===mul?2:3:""===mul?1:2),str+="</tr>"):str+='<tr id="'+hid+'"'+(grp.groupCollapse&&n.idx>0?' style="display:none;" ':" ")+'role="row" class= "ui-widget-content jqgroup ui-row-'+$t.p.direction+" "+clid+'"><td style="padding-left:'+12*n.idx+'px;" colspan="'+(grp.groupColumnShow[n.idx]===!1?colspans-1:colspans)+'">'+icon+grpTextStr+"</td></tr>";var leaf=len-1===n.idx;if(leaf){var kk,ik,gg=grp.groups[i+1],offset=0,sgr=n.startRow,end=void 0!==gg?gg.startRow:grp.groups[i].startRow+grp.groups[i].cnt;for(grp._locgr&&(offset=(page-1)*rn,offset>n.startRow&&(sgr=offset)),kk=sgr;end>kk&&grdata[kk-offset];kk++)str+=grdata[kk-offset].join("");if("header"!==grp.groupSummaryPos[n.idx]){var jj;if(void 0!==gg){for(jj=0;jj<grp.groupField.length&&gg.dataIndex!==grp.groupField[jj];jj++);toEnd=grp.groupField.length-jj}for(ik=0;toEnd>ik;ik++)if(sumreverse[ik]){var hhdr="";grp.groupCollapse&&!grp.showSummaryOnHide&&(hhdr=' style="display:none;"'),str+="<tr"+hhdr+' jqfootlevel="'+(n.idx-ik)+'" role="row" class="ui-widget-content jqfoot ui-row-'+$t.p.direction+'">',str+=buildSummaryTd(i,ik,grp.groups,0),str+="</tr>"}toEnd=jj}}}),$("#"+$.jgrid.jqID($t.p.id)+" tbody:first").append(str),str=null})},groupingGroupBy:function(name,options){return this.each(function(){var $t=this;"string"==typeof name&&(name=[name]);var grp=$t.p.groupingView;$t.p.grouping=!0,grp._locgr=!1,void 0===grp.visibiltyOnNextGrouping&&(grp.visibiltyOnNextGrouping=[]);var i;for(i=0;i<grp.groupField.length;i++)!grp.groupColumnShow[i]&&grp.visibiltyOnNextGrouping[i]&&$($t).jqGrid("showCol",grp.groupField[i]);for(i=0;i<name.length;i++)grp.visibiltyOnNextGrouping[i]=$("#"+$.jgrid.jqID($t.p.id)+"_"+$.jgrid.jqID(name[i])).is(":visible");$t.p.groupingView=$.extend($t.p.groupingView,options||{}),grp.groupField=name,$($t).trigger("reloadGrid")})},groupingRemove:function(current){return this.each(function(){var $t=this;if(void 0===current&&(current=!0),$t.p.grouping=!1,current===!0){var i,grp=$t.p.groupingView;for(i=0;i<grp.groupField.length;i++)!grp.groupColumnShow[i]&&grp.visibiltyOnNextGrouping[i]&&$($t).jqGrid("showCol",grp.groupField);$("tr.jqgroup, tr.jqfoot","#"+$.jgrid.jqID($t.p.id)+" tbody:first").remove(),$("tr.jqgrow:hidden","#"+$.jgrid.jqID($t.p.id)+" tbody:first").show()}else $($t).trigger("reloadGrid")})},groupingCalculations:{handler:function(fn,v,field,round,roundType,rc){var funcs={sum:function(){return parseFloat(v||0)+parseFloat(rc[field]||0)},min:function(){return""===v?parseFloat(rc[field]||0):Math.min(parseFloat(v),parseFloat(rc[field]||0))},max:function(){return""===v?parseFloat(rc[field]||0):Math.max(parseFloat(v),parseFloat(rc[field]||0))},count:function(){return""===v&&(v=0),rc.hasOwnProperty(field)?v+1:0},avg:function(){return funcs.sum()}};if(!funcs[fn])throw"jqGrid Grouping No such method: "+fn;var res=funcs[fn]();if(null!=round)if("fixed"===roundType)res=res.toFixed(round);else{var mul=Math.pow(10,round);res=Math.round(res*mul)/mul}return res}},setGroupHeaders:function(o){return o=$.extend({useColSpanStyle:!1,groupHeaders:[]},o||{}),this.each(function(){this.p.groupHeader=o;var i,cmi,$tr,$colHeader,th,$th,thStyle,iCol,cghi,numberOfColumns,titleText,cVisibleColumns,$theadInTable,ts=this,skip=0,colModel=ts.p.colModel,cml=colModel.length,ths=ts.grid.headers,$htable=$("table.ui-jqgrid-htable",ts.grid.hDiv),$trLabels=$htable.children("thead").children("tr.ui-jqgrid-labels:last").addClass("jqg-second-row-header"),$thead=$htable.children("thead"),$firstHeaderRow=$htable.find(".jqg-first-row-header");void 0===$firstHeaderRow[0]?$firstHeaderRow=$("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto"):$firstHeaderRow.empty();var $firstRow,inColumnHeader=function(text,columnHeaders){var i,length=columnHeaders.length;for(i=0;length>i;i++)if(columnHeaders[i].startColumnName===text)return i;return-1};for($(ts).prepend($thead),$tr=$("<tr>",{role:"row"}).addClass("ui-jqgrid-labels jqg-third-row-header"),i=0;cml>i;i++)if(th=ths[i].el,$th=$(th),cmi=colModel[i],thStyle={height:"0px",width:ths[i].width+"px",display:cmi.hidden?"none":""},$("<th>",{role:"gridcell"}).css(thStyle).addClass("ui-first-th-"+ts.p.direction).appendTo($firstHeaderRow),th.style.width="",iCol=inColumnHeader(cmi.name,o.groupHeaders),iCol>=0){for(cghi=o.groupHeaders[iCol],numberOfColumns=cghi.numberOfColumns,titleText=cghi.titleText,cVisibleColumns=0,iCol=0;numberOfColumns>iCol&&cml>i+iCol;iCol++)colModel[i+iCol].hidden||cVisibleColumns++;$colHeader=$("<th>").attr({role:"columnheader"}).addClass("ui-state-default ui-th-column-header ui-th-"+ts.p.direction).html(titleText),cVisibleColumns>0&&$colHeader.attr("colspan",String(cVisibleColumns)),ts.p.headertitles&&$colHeader.attr("title",$colHeader.text()),0===cVisibleColumns&&$colHeader.hide(),$th.before($colHeader),$tr.append(th),skip=numberOfColumns-1}else 0===skip?o.useColSpanStyle?$th.attr("rowspan","2"):($("<th>",{role:"columnheader"}).addClass("ui-state-default ui-th-column-header ui-th-"+ts.p.direction).css({display:cmi.hidden?"none":""}).insertBefore($th),$tr.append(th)):($tr.append(th),skip--);$theadInTable=$(ts).children("thead"),$theadInTable.prepend($firstHeaderRow),$tr.insertAfter($trLabels),$htable.append($theadInTable),o.useColSpanStyle&&($htable.find("span.ui-jqgrid-resize").each(function(){var $parent=$(this).parent();$parent.is(":visible")&&(this.style.cssText="height: "+$parent.height()+"px !important; cursor: col-resize;")}),$htable.find("div.ui-jqgrid-sortable").each(function(){var $ts=$(this),$parent=$ts.parent();$parent.is(":visible")&&$parent.is(":has(span.ui-jqgrid-resize)")&&$ts.css("top",($parent.height()-$ts.outerHeight())/2-4+"px")})),$firstRow=$theadInTable.find("tr.jqg-first-row-header"),$(ts).bind("jqGridResizeStop.setGroupHeaders",function(e,nw,idx){$firstRow.find("th").eq(idx).width(nw)})})},destroyGroupHeader:function(nullHeader){return void 0===nullHeader&&(nullHeader=!0),this.each(function(){var $tr,i,l,headers,$th,$resizing,hc,$t=this,grid=$t.grid,thead=$("table.ui-jqgrid-htable thead",grid.hDiv),cm=$t.p.colModel;if(grid){for($(this).unbind(".setGroupHeaders"),$tr=$("<tr>",{role:"row"}).addClass("ui-jqgrid-labels"),headers=grid.headers,i=0,l=headers.length;l>i;i++){hc=cm[i].hidden?"none":"",$th=$(headers[i].el).width(headers[i].width).css("display",hc);try{$th.removeAttr("rowSpan")}catch(rs){$th.attr("rowSpan",1)}$tr.append($th),$resizing=$th.children("span.ui-jqgrid-resize"),$resizing.length>0&&($resizing[0].style.height=""),$th.children("div")[0].style.top=""}$(thead).children("tr.ui-jqgrid-labels").remove(),$(thead).prepend($tr),nullHeader===!0&&$($t).jqGrid("setGridParam",{groupHeader:null})}})}}),$.jgrid=$.jgrid||{},$.extend($.jgrid,{saveState:function(jqGridId,o){if(o=$.extend({useStorage:!0,storageType:"localStorage",beforeSetItem:null,compression:!1,compressionModule:"LZString",compressionMethod:"compressToUTF16"},o||{}),jqGridId){var ret,tmp,gridstate="",data="",$t=$("#"+jqGridId)[0];if($t.grid){if(tmp=$($t).data("inlineNav"),tmp&&$t.p.inlineNav&&$($t).jqGrid("setGridParam",{_iN:tmp}),tmp=$($t).data("filterToolbar"),tmp&&$t.p.filterToolbar&&$($t).jqGrid("setGridParam",{_fT:tmp}),gridstate=$($t).jqGrid("jqGridExport",{exptype:"jsonstring",ident:"",root:""}),$($t.grid.bDiv).find(".ui-jqgrid-btable tr:gt(0)").each(function(i,d){data+=d.outerHTML}),$.isFunction(o.beforeSetItem)&&(ret=o.beforeSetItem.call($t,gridstate),null!=ret&&(gridstate=ret)),o.compression&&o.compressionModule)try{ret=window[o.compressionModule][o.compressionMethod](gridstate),null!=ret&&(gridstate=ret,data=window[o.compressionModule][o.compressionMethod](data))}catch(e){}if(o.useStorage&&$.jgrid.isLocalStorage())try{window[o.storageType].setItem("jqGrid"+$t.p.id,gridstate),window[o.storageType].setItem("jqGrid"+$t.p.id+"_data",data)}catch(e){22===e.code&&alert("Local storage limit is over!")}return gridstate}}},loadState:function(jqGridId,gridstring,o){if(o=$.extend({useStorage:!0,storageType:"localStorage",clearAfterLoad:!1,beforeSetGrid:null,decompression:!1,decompressionModule:"LZString",decompressionMethod:"decompressFromUTF16"},o||{}),jqGridId){var ret,tmp,data,iN,fT,$t=$("#"+jqGridId)[0];if($t.grid&&$.jgrid.gridUnload(jqGridId),o.useStorage)try{gridstring=window[o.storageType].getItem("jqGrid"+$t.id),data=window[o.storageType].getItem("jqGrid"+$t.id+"_data")}catch(e){}if(gridstring){if(o.decompression&&o.decompressionModule)try{ret=window[o.decompressionModule][o.decompressionMethod](gridstring),null!=ret&&(gridstring=ret,data=window[o.decompressionModule][o.decompressionMethod](data))}catch(e){}if(ret=jqGridUtils.parse(gridstring),ret&&"object"===$.type(ret)){$.isFunction(o.beforeSetGrid)&&(tmp=o.beforeSetGrid(ret),tmp&&"object"===$.type(tmp)&&(ret=tmp));var retfunc=function(param){var p;return p=param},prm={reccount:ret.reccount,records:ret.records,lastpage:ret.lastpage,shrinkToFit:retfunc(ret.shrinkToFit),data:retfunc(ret.data),datatype:retfunc(ret.datatype),grouping:retfunc(ret.grouping)};ret.shrinkToFit=!1,ret.data=[],ret.datatype="local",ret.grouping=!1,ret.navGrid=!1,ret.inlineNav&&(iN=retfunc(ret._iN),ret._iN=null,delete ret._iN),ret.filterToolbar&&(fT=retfunc(ret._fT),ret._fT=null,delete ret._fT);var grid=$("#"+jqGridId).jqGrid(ret);grid.append(data),grid.jqGrid("setGridParam",prm),ret.storeNavOptions&&grid.jqGrid("navGrid",ret.pager,ret.navOptions,ret.editOptions,ret.addOptions,ret.delOptions,ret.searchOptions,ret.viewOptions),ret.inlineNav&&iN&&(grid.jqGrid("setGridParam",{inlineNav:!1}),grid.jqGrid("inlineNav",ret.pager,iN)),ret.filterToolbar&&fT&&(grid.jqGrid("setGridParam",{filterToolbar:!1}),grid.jqGrid("filterToolbar",fT)),grid[0].updatepager(!0,!0),o.clearAfterLoad&&(window[o.storageType].removeItem("jqGrid"+$t.id),window[o.storageType].removeItem("jqGrid"+$t.id+"_data"))}else alert("can not convert to object")}}},setRegional:function(jqGridId,options){$.jgrid.saveState(jqGridId,{storageType:"sessionStorage"}),$.jgrid.loadState(jqGridId,null,{storageType:"sessionStorage",beforeSetGrid:function(params){return params.regional=options.regional,params.force_regional=!0,params}});var grid=$("#"+jqGridId)[0],model=$(grid).jqGrid("getGridParam","colModel"),i=-1,nav=$.jgrid.getRegional(grid,"nav");$.each(model,function(k){return this.formatter&&"actions"===this.formatter?(i=k,!1):void 0}),-1!==i&&nav&&$("#"+jqGridId+" tbody tr").each(function(){var td=this.cells[i];$(td).find(".ui-inline-edit").attr("title",nav.edittitle),$(td).find(".ui-inline-del").attr("title",nav.deltitle),$(td).find(".ui-inline-save").attr("title",nav.savetitle),$(td).find(".ui-inline-cancel").attr("title",nav.canceltitle)});try{window.sessionStorage.removeItem("jqGrid"+grid.id),window.sessionStorage.removeItem("jqGrid"+grid.id+"_data")}catch(e){}},jqGridImport:function(jqGridId,o){o=$.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"root>grid",data:"root>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},o||{});var $t=(0===jqGridId.indexOf("#")?"":"#")+$.jgrid.jqID(jqGridId),xmlConvert=function(xml,o){var jstr,jstr1,key,cnfg=$(o.xmlGrid.config,xml)[0],xmldata=$(o.xmlGrid.data,xml)[0];if(jqGridUtils.xmlToJSON){jstr=jqGridUtils.xmlToJSON(cnfg);for(key in jstr)jstr.hasOwnProperty(key)&&(jstr1=jstr[key]);if(xmldata){var svdatatype=jstr.grid.datatype;jstr.grid.datatype="xmlstring",jstr.grid.datastr=xml,$($t).jqGrid(jstr1).jqGrid("setGridParam",{datatype:svdatatype})}else setTimeout(function(){$($t).jqGrid(jstr1)},0)}else alert("xml2json or parse are not present")},jsonConvert=function(jsonstr,o){if(jsonstr&&"string"==typeof jsonstr){var json=jqGridUtils.parse(jsonstr),gprm=json[o.jsonGrid.config],jdata=json[o.jsonGrid.data];if(jdata){var svdatatype=gprm.datatype;gprm.datatype="jsonstring",gprm.datastr=jdata,$($t).jqGrid(gprm).jqGrid("setGridParam",{datatype:svdatatype})}else $($t).jqGrid(gprm)}};switch(o.imptype){case"xml":$.ajax($.extend({url:o.impurl,type:o.mtype,data:o.impData,dataType:"xml",complete:function(xml,stat){"success"===stat&&(xmlConvert(xml.responseXML,o),$($t).triggerHandler("jqGridImportComplete",[xml,o]),$.isFunction(o.importComplete)&&o.importComplete(xml)),xml=null}},o.ajaxOptions));break;case"xmlstring":if(o.impstring&&"string"==typeof o.impstring){var xmld=$.parseXML(o.impstring);xmld&&(xmlConvert(xmld,o),$($t).triggerHandler("jqGridImportComplete",[xmld,o]),$.isFunction(o.importComplete)&&o.importComplete(xmld))}break;case"json":$.ajax($.extend({url:o.impurl,type:o.mtype,data:o.impData,dataType:"json",complete:function(json){try{jsonConvert(json.responseText,o),$($t).triggerHandler("jqGridImportComplete",[json,o]),$.isFunction(o.importComplete)&&o.importComplete(json)}catch(ee){}json=null}},o.ajaxOptions));break;case"jsonstring":o.impstring&&"string"==typeof o.impstring&&(jsonConvert(o.impstring,o),$($t).triggerHandler("jqGridImportComplete",[o.impstring,o]),$.isFunction(o.importComplete)&&o.importComplete(o.impstring))}}}),$.jgrid.extend({jqGridExport:function(o){o=$.extend({exptype:"xmlstring",root:"grid",ident:"	",addOptions:{}},o||{});var ret=null;return this.each(function(){if(this.grid){var key,gprm=$.extend(!0,{},$(this).jqGrid("getGridParam"),o.addOptions);if(gprm.rownumbers&&(gprm.colNames.splice(0,1),gprm.colModel.splice(0,1)),gprm.multiselect&&(gprm.colNames.splice(0,1),gprm.colModel.splice(0,1)),gprm.subGrid&&(gprm.colNames.splice(0,1),gprm.colModel.splice(0,1)),gprm.knv=null,gprm.treeGrid)for(key in gprm.treeReader)gprm.treeReader.hasOwnProperty(key)&&(gprm.colNames.splice(gprm.colNames.length-1),gprm.colModel.splice(gprm.colModel.length-1));switch(o.exptype){case"xmlstring":ret="<"+o.root+">"+jqGridUtils.jsonToXML(gprm,{xmlDecl:""})+"</"+o.root+">";break;case"jsonstring":ret=jqGridUtils.stringify(gprm),o.root&&(ret="{"+o.root+":"+ret+"}")}}}),ret},excelExport:function(o){return o=$.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},o||{}),this.each(function(){if(this.grid){var url;if("remote"===o.exptype){var pdata=$.extend({},this.p.postData);pdata[o.oper]=o.tag;var params=jQuery.param(pdata);url=-1!==o.url.indexOf("?")?o.url+"&"+params:o.url+"?"+params,window.location=url}}})}}),$.jgrid.inlineEdit=$.jgrid.inlineEdit||{},$.jgrid.extend({editRow:function(rowid,keys,oneditfunc,successfunc,url,extraparam,aftersavefunc,errorfunc,afterrestorefunc){var o={},args=$.makeArray(arguments).slice(1);return"object"===$.type(args[0])?o=args[0]:(void 0!==keys&&(o.keys=keys),$.isFunction(oneditfunc)&&(o.oneditfunc=oneditfunc),$.isFunction(successfunc)&&(o.successfunc=successfunc),void 0!==url&&(o.url=url),void 0!==extraparam&&(o.extraparam=extraparam),$.isFunction(aftersavefunc)&&(o.aftersavefunc=aftersavefunc),$.isFunction(errorfunc)&&(o.errorfunc=errorfunc),$.isFunction(afterrestorefunc)&&(o.afterrestorefunc=afterrestorefunc)),o=$.extend(!0,{keys:!1,oneditfunc:null,successfunc:null,url:null,extraparam:{},aftersavefunc:null,
errorfunc:null,afterrestorefunc:null,restoreAfterError:!0,mtype:"POST",focusField:!0},$.jgrid.inlineEdit,o),this.each(function(){var nm,tmp,editable,ind,cm,bfer,$t=this,cnt=0,focus=null,svr={};$t.grid&&(ind=$($t).jqGrid("getInd",rowid,!0),ind!==!1&&(bfer=$.isFunction(o.beforeEditRow)?o.beforeEditRow.call($t,o,rowid):void 0,void 0===bfer&&(bfer=!0),bfer&&(editable=$(ind).attr("editable")||"0","0"!==editable||$(ind).hasClass("not-editable-row")||(cm=$t.p.colModel,$('td[role="gridcell"]',ind).each(function(i){nm=cm[i].name;var treeg=$t.p.treeGrid===!0&&nm===$t.p.ExpandColumn;if(treeg)tmp=$("span:first",this).html();else try{tmp=$.unformat.call($t,this,{rowId:rowid,colModel:cm[i]},i)}catch(_){tmp=cm[i].edittype&&"textarea"===cm[i].edittype?$(this).text():$(this).html()}if("cb"!==nm&&"subgrid"!==nm&&"rn"!==nm&&($t.p.autoencode&&(tmp=$.jgrid.htmlDecode(tmp)),svr[nm]=tmp,cm[i].editable===!0)){null===focus&&(focus=i),treeg?$("span:first",this).html(""):$(this).html("");var opt=$.extend({},cm[i].editoptions||{},{id:rowid+"_"+nm,name:nm,rowId:rowid,oper:"edit"});cm[i].edittype||(cm[i].edittype="text"),("&nbsp;"===tmp||"&#160;"===tmp||1===tmp.length&&160===tmp.charCodeAt(0))&&(tmp="");var elc=$.jgrid.createEl.call($t,cm[i].edittype,opt,tmp,!0,$.extend({},$.jgrid.ajaxOptions,$t.p.ajaxSelectOptions||{}));$(elc).addClass("editable"),treeg?$("span:first",this).append(elc):$(this).append(elc),$.jgrid.bindEv.call($t,elc,opt),"select"===cm[i].edittype&&void 0!==cm[i].editoptions&&cm[i].editoptions.multiple===!0&&void 0===cm[i].editoptions.dataUrl&&$.jgrid.msie&&$(elc).width($(elc).width()),cnt++}}),cnt>0&&(svr.id=rowid,$t.p.savedRow.push(svr),$(ind).attr("editable","1"),o.focusField&&("number"==typeof o.focusField&&parseInt(o.focusField,10)<=cm.length&&(focus=o.focusField),setTimeout(function(){var fe=$("td:eq("+focus+") :input:visible",ind).not(":disabled");fe.length>0&&fe.focus()},0)),o.keys===!0&&$(ind).bind("keydown",function(e){if(27===e.keyCode){if($($t).jqGrid("restoreRow",rowid,o.afterrestorefunc),$t.p.inlineNav)try{$($t).jqGrid("showAddEditButtons")}catch(eer1){}return!1}if(13===e.keyCode){var ta=e.target;if("TEXTAREA"===ta.tagName)return!0;if($($t).jqGrid("saveRow",rowid,o)&&$t.p.inlineNav)try{$($t).jqGrid("showAddEditButtons")}catch(eer2){}return!1}}),$($t).triggerHandler("jqGridInlineEditRow",[rowid,o]),$.isFunction(o.oneditfunc)&&o.oneditfunc.call($t,rowid))))))})},saveRow:function(rowid,successfunc,url,extraparam,aftersavefunc,errorfunc,afterrestorefunc){var args=$.makeArray(arguments).slice(1),o={},$t=this[0];"object"===$.type(args[0])?o=args[0]:($.isFunction(successfunc)&&(o.successfunc=successfunc),void 0!==url&&(o.url=url),void 0!==extraparam&&(o.extraparam=extraparam),$.isFunction(aftersavefunc)&&(o.aftersavefunc=aftersavefunc),$.isFunction(errorfunc)&&(o.errorfunc=errorfunc),$.isFunction(afterrestorefunc)&&(o.afterrestorefunc=afterrestorefunc)),o=$.extend(!0,{successfunc:null,url:null,extraparam:{},aftersavefunc:null,errorfunc:null,afterrestorefunc:null,restoreAfterError:!0,mtype:"POST",saveui:"enable",savetext:$.jgrid.getRegional($t,"defaults.savetext")},$.jgrid.inlineEdit,o);var nm,editable,fr,cv,ind,success=!1,tmp={},tmp2={},tmp3={},nullIfEmpty=!1;if(!$t.grid)return success;if(ind=$($t).jqGrid("getInd",rowid,!0),ind===!1)return success;var errors=$.jgrid.getRegional(this,"errors"),edit=$.jgrid.getRegional(this,"edit"),bfsr=$.isFunction(o.beforeSaveRow)?o.beforeSaveRow.call($t,o,rowid):void 0;if(void 0===bfsr&&(bfsr=!0),bfsr){if(editable=$(ind).attr("editable"),o.url=o.url||$t.p.editurl,"1"===editable){var cm;if($('td[role="gridcell"]',ind).each(function(i){if(cm=$t.p.colModel[i],nm=cm.name,"cb"!==nm&&"subgrid"!==nm&&cm.editable===!0&&"rn"!==nm&&!$(this).hasClass("not-editable-cell")){switch(cm.edittype){case"checkbox":var cbv=["Yes","No"];cm.editoptions&&(cbv=cm.editoptions.value.split(":")),tmp[nm]=$("input",this).is(":checked")?cbv[0]:cbv[1];break;case"text":case"password":case"textarea":case"button":tmp[nm]=$("input, textarea",this).val();break;case"select":if(cm.editoptions.multiple){var sel=$("select",this),selectedText=[];tmp[nm]=$(sel).val(),tmp[nm]?tmp[nm]=tmp[nm].join(","):tmp[nm]="",$("select option:selected",this).each(function(i,selected){selectedText[i]=$(selected).text()}),tmp2[nm]=selectedText.join(",")}else tmp[nm]=$("select option:selected",this).val(),tmp2[nm]=$("select option:selected",this).text();cm.formatter&&"select"===cm.formatter&&(tmp2={});break;case"custom":try{if(!cm.editoptions||!$.isFunction(cm.editoptions.custom_value))throw"e1";if(tmp[nm]=cm.editoptions.custom_value.call($t,$(".customelement",this),"get"),void 0===tmp[nm])throw"e2"}catch(e){"e1"===e&&$.jgrid.info_dialog(errors.errcap,"function 'custom_value' "+edit.msg.nodefined,edit.bClose),"e2"===e?$.jgrid.info_dialog(errors.errcap,"function 'custom_value' "+edit.msg.novalue,edit.bClose):$.jgrid.info_dialog(errors.errcap,e.message,edit.bClose)}}if(cv=$.jgrid.checkValues.call($t,tmp[nm],i),cv[0]===!1)return!1;$t.p.autoencode&&(tmp[nm]=$.jgrid.htmlEncode(tmp[nm])),"clientArray"!==o.url&&cm.editoptions&&cm.editoptions.NullIfEmpty===!0&&""===tmp[nm]&&(tmp3[nm]="null",nullIfEmpty=!0)}}),cv[0]===!1){try{var tr=$($t).jqGrid("getGridRowById",rowid),positions=$.jgrid.findPos(tr);$.jgrid.info_dialog(errors.errcap,cv[1],edit.bClose,{left:positions[0],top:positions[1]+$(tr).outerHeight()})}catch(e){alert(cv[1])}return success}var idname,opers=$t.p.prmNames,oldRowId=rowid;if(idname=$t.p.keyName===!1?opers.id:$t.p.keyName,tmp){if(tmp[opers.oper]=opers.editoper,void 0===tmp[idname]||""===tmp[idname])tmp[idname]=rowid;else if(ind.id!==$t.p.idPrefix+tmp[idname]){var oldid=$.jgrid.stripPref($t.p.idPrefix,rowid);if(void 0!==$t.p._index[oldid]&&($t.p._index[tmp[idname]]=$t.p._index[oldid],delete $t.p._index[oldid]),rowid=$t.p.idPrefix+tmp[idname],$(ind).attr("id",rowid),$t.p.selrow===oldRowId&&($t.p.selrow=rowid),$.isArray($t.p.selarrrow)){var i=$.inArray(oldRowId,$t.p.selarrrow);i>=0&&($t.p.selarrrow[i]=rowid)}if($t.p.multiselect){var newCboxId="jqg_"+$t.p.id+"_"+rowid;$("input.cbox",ind).attr("id",newCboxId).attr("name",newCboxId)}}void 0===$t.p.inlineData&&($t.p.inlineData={}),tmp=$.extend({},tmp,$t.p.inlineData,o.extraparam)}if("clientArray"===o.url){tmp=$.extend({},tmp,tmp2),$t.p.autoencode&&$.each(tmp,function(n,v){tmp[n]=$.jgrid.htmlDecode(v)});var k,resp=$($t).jqGrid("setRowData",rowid,tmp);for($(ind).attr("editable","0"),k=0;k<$t.p.savedRow.length;k++)if(String($t.p.savedRow[k].id)===String(oldRowId)){fr=k;break}fr>=0&&$t.p.savedRow.splice(fr,1),$($t).triggerHandler("jqGridInlineAfterSaveRow",[rowid,resp,tmp,o]),$.isFunction(o.aftersavefunc)&&o.aftersavefunc.call($t,rowid,resp,tmp,o),success=!0,$(ind).removeClass("jqgrid-new-row").unbind("keydown")}else $($t).jqGrid("progressBar",{method:"show",loadtype:o.saveui,htmlcontent:o.savetext}),tmp3=$.extend({},tmp,tmp3),tmp3[idname]=$.jgrid.stripPref($t.p.idPrefix,tmp3[idname]),$.ajax($.extend({url:o.url,data:$.isFunction($t.p.serializeRowData)?$t.p.serializeRowData.call($t,tmp3):tmp3,type:o.mtype,async:!1,complete:function(res,stat){if($($t).jqGrid("progressBar",{method:"hide",loadtype:o.saveui,htmlcontent:o.savetext}),"success"===stat){var sucret,k,ret=!0;if(sucret=$($t).triggerHandler("jqGridInlineSuccessSaveRow",[res,rowid,o]),$.isArray(sucret)||(sucret=[!0,tmp3]),sucret[0]&&$.isFunction(o.successfunc)&&(sucret=o.successfunc.call($t,res)),$.isArray(sucret)?(ret=sucret[0],tmp=sucret[1]||tmp):ret=sucret,ret===!0){for($t.p.autoencode&&$.each(tmp,function(n,v){tmp[n]=$.jgrid.htmlDecode(v)}),nullIfEmpty&&$.each(tmp,function(n){"null"===tmp[n]&&(tmp[n]="")}),tmp=$.extend({},tmp,tmp2),$($t).jqGrid("setRowData",rowid,tmp),$(ind).attr("editable","0"),k=0;k<$t.p.savedRow.length;k++)if(String($t.p.savedRow[k].id)===String(rowid)){fr=k;break}fr>=0&&$t.p.savedRow.splice(fr,1),$($t).triggerHandler("jqGridInlineAfterSaveRow",[rowid,res,tmp,o]),$.isFunction(o.aftersavefunc)&&o.aftersavefunc.call($t,rowid,res,tmp,o),success=!0,$(ind).removeClass("jqgrid-new-row").unbind("keydown")}else $($t).triggerHandler("jqGridInlineErrorSaveRow",[rowid,res,stat,null,o]),$.isFunction(o.errorfunc)&&o.errorfunc.call($t,rowid,res,stat,null),o.restoreAfterError===!0&&$($t).jqGrid("restoreRow",rowid,o.afterrestorefunc)}},error:function(res,stat,err){if($("#lui_"+$.jgrid.jqID($t.p.id)).hide(),$($t).triggerHandler("jqGridInlineErrorSaveRow",[rowid,res,stat,err,o]),$.isFunction(o.errorfunc))o.errorfunc.call($t,rowid,res,stat,err);else{var rT=res.responseText||res.statusText;try{$.jgrid.info_dialog(errors.errcap,'<div class="ui-state-error">'+rT+"</div>",edit.bClose,{buttonalign:"right"})}catch(e){alert(rT)}}o.restoreAfterError===!0&&$($t).jqGrid("restoreRow",rowid,o.afterrestorefunc)}},$.jgrid.ajaxOptions,$t.p.ajaxRowOptions||{}))}return success}},restoreRow:function(rowid,afterrestorefunc){var args=$.makeArray(arguments).slice(1),o={};return"object"===$.type(args[0])?o=args[0]:$.isFunction(afterrestorefunc)&&(o.afterrestorefunc=afterrestorefunc),o=$.extend(!0,{},$.jgrid.inlineEdit,o),this.each(function(){var ind,k,$t=this,fr=-1,ares={};if($t.grid&&(ind=$($t).jqGrid("getInd",rowid,!0),ind!==!1)){var bfcr=$.isFunction(o.beforeCancelRow)?o.beforeCancelRow.call($t,o,rowid):void 0;if(void 0===bfcr&&(bfcr=!0),bfcr){for(k=0;k<$t.p.savedRow.length;k++)if(String($t.p.savedRow[k].id)===String(rowid)){fr=k;break}if(fr>=0){if($.isFunction($.fn.datepicker))try{$("input.hasDatepicker","#"+$.jgrid.jqID(ind.id)).datepicker("hide")}catch(e){}$.each($t.p.colModel,function(){this.editable===!0&&$t.p.savedRow[fr].hasOwnProperty(this.name)&&(ares[this.name]=$t.p.savedRow[fr][this.name])}),$($t).jqGrid("setRowData",rowid,ares),$(ind).attr("editable","0").unbind("keydown"),$t.p.savedRow.splice(fr,1),$("#"+$.jgrid.jqID(rowid),"#"+$.jgrid.jqID($t.p.id)).hasClass("jqgrid-new-row")&&setTimeout(function(){$($t).jqGrid("delRowData",rowid),$($t).jqGrid("showAddEditButtons")},0)}$($t).triggerHandler("jqGridInlineAfterRestoreRow",[rowid]),$.isFunction(o.afterrestorefunc)&&o.afterrestorefunc.call($t,rowid)}}})},addRow:function(p){return p=$.extend(!0,{rowID:null,initdata:{},position:"first",useDefValues:!0,useFormatter:!1,addRowParams:{extraparam:{}}},p||{}),this.each(function(){if(this.grid){var $t=this,bfar=$.isFunction(p.beforeAddRow)?p.beforeAddRow.call($t,p.addRowParams):void 0;if(void 0===bfar&&(bfar=!0),bfar)if(p.rowID=$.isFunction(p.rowID)?p.rowID.call($t,p):null!=p.rowID?p.rowID:$.jgrid.randId(),p.useDefValues===!0&&$($t.p.colModel).each(function(){if(this.editoptions&&this.editoptions.defaultValue){var opt=this.editoptions.defaultValue,tmp=$.isFunction(opt)?opt.call($t):opt;p.initdata[this.name]=tmp}}),$($t).jqGrid("addRowData",p.rowID,p.initdata,p.position),p.rowID=$t.p.idPrefix+p.rowID,$("#"+$.jgrid.jqID(p.rowID),"#"+$.jgrid.jqID($t.p.id)).addClass("jqgrid-new-row"),p.useFormatter)$("#"+$.jgrid.jqID(p.rowID)+" .ui-inline-edit","#"+$.jgrid.jqID($t.p.id)).click();else{var opers=$t.p.prmNames,oper=opers.oper;p.addRowParams.extraparam[oper]=opers.addoper,$($t).jqGrid("editRow",p.rowID,p.addRowParams),$($t).jqGrid("setSelection",p.rowID)}}})},inlineNav:function(elem,o){var regional=$.jgrid.getRegional(this[0],"nav");return o=$.extend(!0,{edit:!0,editicon:"ui-icon-pencil",add:!0,addicon:"ui-icon-plus",save:!0,saveicon:"ui-icon-disk",cancel:!0,cancelicon:"ui-icon-cancel",addParams:{addRowParams:{extraparam:{}}},editParams:{},restoreAfterSelect:!0},regional,o||{}),this.each(function(){if(this.grid&&!this.p.inlineNav){var $t=this,gID=$.jgrid.jqID($t.p.id);if($t.p.navGrid||$($t).jqGrid("navGrid",elem,{refresh:!1,edit:!1,add:!1,del:!1,search:!1,view:!1}),$($t).data("inlineNav")||$($t).data("inlineNav",o),$t.p.force_regional&&(o=$.extend(o,regional)),$t.p.inlineNav=!0,o.addParams.useFormatter===!0){var i,cm=$t.p.colModel;for(i=0;i<cm.length;i++)if(cm[i].formatter&&"actions"===cm[i].formatter){if(cm[i].formatoptions){var defaults={keys:!1,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{},url:null},ap=$.extend(defaults,cm[i].formatoptions);o.addParams.addRowParams={keys:ap.keys,oneditfunc:ap.onEdit,successfunc:ap.onSuccess,url:ap.url,extraparam:ap.extraparam,aftersavefunc:ap.afterSave,errorfunc:ap.onError,afterrestorefunc:ap.afterRestore}}break}}o.add&&$($t).jqGrid("navButtonAdd",elem,{caption:o.addtext,title:o.addtitle,buttonicon:o.addicon,id:$t.p.id+"_iladd",onClickButton:function(){$($t).jqGrid("addRow",o.addParams),o.addParams.useFormatter||($("#"+gID+"_ilsave").removeClass("ui-state-disabled"),$("#"+gID+"_ilcancel").removeClass("ui-state-disabled"),$("#"+gID+"_iladd").addClass("ui-state-disabled"),$("#"+gID+"_iledit").addClass("ui-state-disabled"))}}),o.edit&&$($t).jqGrid("navButtonAdd",elem,{caption:o.edittext,title:o.edittitle,buttonicon:o.editicon,id:$t.p.id+"_iledit",onClickButton:function(){var sr=$($t).jqGrid("getGridParam","selrow");sr?($($t).jqGrid("editRow",sr,o.editParams),$("#"+gID+"_ilsave").removeClass("ui-state-disabled"),$("#"+gID+"_ilcancel").removeClass("ui-state-disabled"),$("#"+gID+"_iladd").addClass("ui-state-disabled"),$("#"+gID+"_iledit").addClass("ui-state-disabled")):($.jgrid.viewModal("#alertmod_"+gID,{gbox:"#gbox_"+gID,jqm:!0}),$("#jqg_alrt").focus())}}),o.save&&($($t).jqGrid("navButtonAdd",elem,{caption:o.savetext||"",title:o.savetitle||"Save row",buttonicon:o.saveicon,id:$t.p.id+"_ilsave",onClickButton:function(){var sr=$t.p.savedRow[0].id;if(sr){var opers=$t.p.prmNames,oper=opers.oper,tmpParams=o.editParams;$("#"+$.jgrid.jqID(sr),"#"+gID).hasClass("jqgrid-new-row")?(o.addParams.addRowParams.extraparam[oper]=opers.addoper,tmpParams=o.addParams.addRowParams):(o.editParams.extraparam||(o.editParams.extraparam={}),o.editParams.extraparam[oper]=opers.editoper),$($t).jqGrid("saveRow",sr,tmpParams)&&$($t).jqGrid("showAddEditButtons")}else $.jgrid.viewModal("#alertmod_"+gID,{gbox:"#gbox_"+gID,jqm:!0}),$("#jqg_alrt").focus()}}),$("#"+gID+"_ilsave").addClass("ui-state-disabled")),o.cancel&&($($t).jqGrid("navButtonAdd",elem,{caption:o.canceltext||"",title:o.canceltitle||"Cancel row editing",buttonicon:o.cancelicon,id:$t.p.id+"_ilcancel",onClickButton:function(){var sr=$t.p.savedRow[0].id,cancelPrm=o.editParams;sr?($("#"+$.jgrid.jqID(sr),"#"+gID).hasClass("jqgrid-new-row")&&(cancelPrm=o.addParams.addRowParams),$($t).jqGrid("restoreRow",sr,cancelPrm),$($t).jqGrid("showAddEditButtons")):($.jgrid.viewModal("#alertmod",{gbox:"#gbox_"+gID,jqm:!0}),$("#jqg_alrt").focus())}}),$("#"+gID+"_ilcancel").addClass("ui-state-disabled")),o.restoreAfterSelect===!0&&$($t).bind("jqGridBeforeSelectRow.inlineNav",function(event,id){$t.p.savedRow.length>0&&$t.p.inlineNav===!0&&id!==$t.p.selrow&&null!==$t.p.selrow&&($t.p.selrow===o.addParams.rowID?$($t).jqGrid("delRowData",$t.p.selrow):$($t).jqGrid("restoreRow",$t.p.selrow,o.editParams),$($t).jqGrid("showAddEditButtons"))})}})},showAddEditButtons:function(){return this.each(function(){if(this.grid){var gID=$.jgrid.jqID(this.p.id);$("#"+gID+"_ilsave").addClass("ui-state-disabled"),$("#"+gID+"_ilcancel").addClass("ui-state-disabled"),$("#"+gID+"_iladd").removeClass("ui-state-disabled"),$("#"+gID+"_iledit").removeClass("ui-state-disabled")}})}}),$.jgrid.msie&&8===$.jgrid.msiever()&&($.expr[":"].hidden=function(elem){return 0===elem.offsetWidth||0===elem.offsetHeight||"none"===elem.style.display}),$.jgrid._multiselect=!1,$.ui&&$.ui.multiselect){if($.ui.multiselect.prototype._setSelected){var setSelected=$.ui.multiselect.prototype._setSelected;$.ui.multiselect.prototype._setSelected=function(item,selected){var ret=setSelected.call(this,item,selected);if(selected&&this.selectedList){var elt=this.element;this.selectedList.find("li").each(function(){$(this).data("optionLink")&&$(this).data("optionLink").remove().appendTo(elt)})}return ret}}$.ui.multiselect.prototype.destroy&&($.ui.multiselect.prototype.destroy=function(){this.element.show(),this.container.remove(),void 0===$.Widget?$.widget.prototype.destroy.apply(this,arguments):$.Widget.prototype.destroy.apply(this,arguments)}),$.jgrid._multiselect=!0}$.jgrid.extend({sortableColumns:function(tblrow){return this.each(function(){function start(){ts.p.disableClick=!0}var ts=this,tid=$.jgrid.jqID(ts.p.id),sortable_opts={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+tid+"_cb,#jqgh_"+tid+"_rn,#jqgh_"+tid+"_subgrid),:hidden)",placeholder:{element:function(item){var el=$(document.createElement(item[0].nodeName)).addClass(item[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0];return el},update:function(self,p){p.height(self.currentItem.innerHeight()-parseInt(self.currentItem.css("paddingTop")||0,10)-parseInt(self.currentItem.css("paddingBottom")||0,10)),p.width(self.currentItem.innerWidth()-parseInt(self.currentItem.css("paddingLeft")||0,10)-parseInt(self.currentItem.css("paddingRight")||0,10))}},update:function(event,ui){var p=$(ui.item).parent(),th=$(">th",p),colModel=ts.p.colModel,cmMap={},tid=ts.p.id+"_";$.each(colModel,function(i){cmMap[this.name]=i});var permutation=[];th.each(function(){var id=$(">div",this).get(0).id.replace(/^jqgh_/,"").replace(tid,"");cmMap.hasOwnProperty(id)&&permutation.push(cmMap[id])}),$(ts).jqGrid("remapColumns",permutation,!0,!0),$.isFunction(ts.p.sortable.update)&&ts.p.sortable.update(permutation),setTimeout(function(){ts.p.disableClick=!1},50)}};if(ts.p.sortable.options?$.extend(sortable_opts,ts.p.sortable.options):$.isFunction(ts.p.sortable)&&(ts.p.sortable={update:ts.p.sortable}),sortable_opts.start){var s=sortable_opts.start;sortable_opts.start=function(e,ui){start(),s.call(this,e,ui)}}else sortable_opts.start=start;ts.p.sortable.exclude&&(sortable_opts.items+=":not("+ts.p.sortable.exclude+")");var $e=tblrow.sortable(sortable_opts),dataObj=$e.data("sortable")||$e.data("uiSortable");null!=dataObj&&(dataObj.data("sortable").floating=!0)})},columnChooser:function(opts){function insert(perm,i,v){var a,b;return i>=0?(a=perm.slice(),b=a.splice(i,Math.max(perm.length-i,i)),i>perm.length&&(i=perm.length),a[i]=v,a.concat(b)):perm}function call(fn,obj){fn&&("string"==typeof fn?$.fn[fn]&&$.fn[fn].apply(obj,$.makeArray(arguments).slice(2)):$.isFunction(fn)&&fn.apply(obj,$.makeArray(arguments).slice(2)))}var selector,select,dopts,mopts,$dialogContent,multiselectData,listHeight,self=this,colMap={},fixedCols=[],colModel=self.jqGrid("getGridParam","colModel"),colNames=self.jqGrid("getGridParam","colNames"),getMultiselectWidgetData=function($elem){return $.ui.multiselect.prototype&&$elem.data($.ui.multiselect.prototype.widgetFullName||$.ui.multiselect.prototype.widgetName)||$elem.data("ui-multiselect")||$elem.data("multiselect")},regional=$.jgrid.getRegional(this[0],"col");if(!$("#colchooser_"+$.jgrid.jqID(self[0].p.id)).length){if(selector=$('<div id="colchooser_'+self[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>'),select=$("select",selector),opts=$.extend({width:400,height:240,classname:null,done:function(perm){perm&&self.jqGrid("remapColumns",perm,!0)},msel:"multiselect",dlog:"dialog",dialog_opts:{minWidth:470,dialogClass:"ui-jqdialog"},dlog_opts:function(options){var buttons={};return buttons[options.bSubmit]=function(){options.apply_perm(),options.cleanup(!1)},buttons[options.bCancel]=function(){options.cleanup(!0)},$.extend(!0,{buttons:buttons,close:function(){options.cleanup(!0)},modal:options.modal||!1,resizable:options.resizable||!0,width:options.width+70,resize:function(){var widgetData=getMultiselectWidgetData(select),$thisDialogContent=widgetData.container.closest(".ui-dialog-content");$thisDialogContent.length>0&&"object"==typeof $thisDialogContent[0].style?$thisDialogContent[0].style.width="":$thisDialogContent.css("width",""),widgetData.selectedList.height(Math.max(widgetData.selectedContainer.height()-widgetData.selectedActions.outerHeight()-1,1)),widgetData.availableList.height(Math.max(widgetData.availableContainer.height()-widgetData.availableActions.outerHeight()-1,1))}},options.dialog_opts||{})},apply_perm:function(){var perm=[];$("option",select).each(function(){$(this).is("[selected]")?self.jqGrid("showCol",colModel[this.value].name):self.jqGrid("hideCol",colModel[this.value].name)}),$("option[selected]",select).each(function(){perm.push(parseInt(this.value,10))}),$.each(perm,function(){delete colMap[colModel[parseInt(this,10)].name]}),$.each(colMap,function(){var ti=parseInt(this,10);perm=insert(perm,ti,ti)}),opts.done&&opts.done.call(self,perm),self.jqGrid("setGridWidth",self[0].p.tblwidth,self[0].p.shrinkToFit)},cleanup:function(calldone){call(opts.dlog,selector,"destroy"),call(opts.msel,select,"destroy"),selector.remove(),calldone&&opts.done&&opts.done.call(self)},msel_opts:{}},regional,opts||{}),$.ui&&$.ui.multiselect&&$.ui.multiselect.defaults){if(!$.jgrid._multiselect)return void alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");opts.msel_opts=$.extend($.ui.multiselect.defaults,opts.msel_opts)}opts.caption&&selector.attr("title",opts.caption),opts.classname&&(selector.addClass(opts.classname),select.addClass(opts.classname)),opts.width&&($(">div",selector).css({width:opts.width,margin:"0 auto"}),select.css("width",opts.width)),opts.height&&($(">div",selector).css("height",opts.height),select.css("height",opts.height-10)),select.empty(),$.each(colModel,function(i){return colMap[this.name]=i,this.hidedlg?void(this.hidden||fixedCols.push(i)):void select.append("<option value='"+i+"' "+(this.hidden?"":"selected='selected'")+">"+$.jgrid.stripHtml(colNames[i])+"</option>")}),dopts=$.isFunction(opts.dlog_opts)?opts.dlog_opts.call(self,opts):opts.dlog_opts,call(opts.dlog,selector,dopts),mopts=$.isFunction(opts.msel_opts)?opts.msel_opts.call(self,opts):opts.msel_opts,call(opts.msel,select,mopts),$dialogContent=$("#colchooser_"+$.jgrid.jqID(self[0].p.id)),$dialogContent.css({margin:"auto"}),$dialogContent.find(">div").css({width:"100%",height:"100%",margin:"auto"}),multiselectData=getMultiselectWidgetData(select),multiselectData.container.css({width:"100%",height:"100%",margin:"auto"}),multiselectData.selectedContainer.css({width:100*multiselectData.options.dividerLocation+"%",height:"100%",margin:"auto",boxSizing:"border-box"}),multiselectData.availableContainer.css({width:100-100*multiselectData.options.dividerLocation+"%",height:"100%",margin:"auto",boxSizing:"border-box"}),multiselectData.selectedList.css("height","auto"),multiselectData.availableList.css("height","auto"),listHeight=Math.max(multiselectData.selectedList.height(),multiselectData.availableList.height()),listHeight=Math.min(listHeight,$(window).height()),multiselectData.selectedList.css("height",listHeight),multiselectData.availableList.css("height",listHeight)}},sortableRows:function(opts){return this.each(function(){var $t=this;$t.grid&&($t.p.treeGrid||$.fn.sortable&&(opts=$.extend({cursor:"move",axis:"y",items:" > .jqgrow"},opts||{}),opts.start&&$.isFunction(opts.start)?(opts._start_=opts.start,delete opts.start):opts._start_=!1,opts.update&&$.isFunction(opts.update)?(opts._update_=opts.update,delete opts.update):opts._update_=!1,opts.start=function(ev,ui){if($(ui.item).css("border-width","0"),$("td",ui.item).each(function(i){this.style.width=$t.grid.cols[i].style.width}),$t.p.subGrid){var subgid=$(ui.item).attr("id");try{$($t).jqGrid("collapseSubGridRow",subgid)}catch(e){}}opts._start_&&opts._start_.apply(this,[ev,ui])},opts.update=function(ev,ui){$(ui.item).css("border-width",""),$t.p.rownumbers===!0&&$("td.jqgrid-rownum",$t.rows).each(function(i){$(this).html(i+1+(parseInt($t.p.page,10)-1)*parseInt($t.p.rowNum,10))}),opts._update_&&opts._update_.apply(this,[ev,ui])},$("tbody:first",$t).sortable(opts),$("tbody:first > .jqgrow",$t).disableSelection()))})},gridDnD:function(opts){return this.each(function(){function updateDnD(){var datadnd=$.data($t,"dnd");$("tr.jqgrow:not(.ui-draggable)",$t).draggable($.isFunction(datadnd.drag)?datadnd.drag.call($($t),datadnd):datadnd.drag)}var i,cn,$t=this;if($t.grid&&!$t.p.treeGrid&&$.fn.draggable&&$.fn.droppable){var appender="<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>";if(void 0===$("#jqgrid_dnd")[0]&&$("body").append(appender),"string"==typeof opts&&"updateDnD"===opts&&$t.p.jqgdnd===!0)return void updateDnD();if(opts=$.extend({drag:function(opts){return $.extend({start:function(ev,ui){var i,subgid;if($t.p.subGrid){subgid=$(ui.helper).attr("id");try{$($t).jqGrid("collapseSubGridRow",subgid)}catch(e){}}for(i=0;i<$.data($t,"dnd").connectWith.length;i++)0===$($.data($t,"dnd").connectWith[i]).jqGrid("getGridParam","reccount")&&$($.data($t,"dnd").connectWith[i]).jqGrid("addRowData","jqg_empty_row",{});ui.helper.addClass("ui-state-highlight"),$("td",ui.helper).each(function(i){this.style.width=$t.grid.headers[i].width+"px"}),opts.onstart&&$.isFunction(opts.onstart)&&opts.onstart.call($($t),ev,ui)},stop:function(ev,ui){var i,ids;for(ui.helper.dropped&&!opts.dragcopy&&(ids=$(ui.helper).attr("id"),void 0===ids&&(ids=$(this).attr("id")),$($t).jqGrid("delRowData",ids)),i=0;i<$.data($t,"dnd").connectWith.length;i++)$($.data($t,"dnd").connectWith[i]).jqGrid("delRowData","jqg_empty_row");opts.onstop&&$.isFunction(opts.onstop)&&opts.onstop.call($($t),ev,ui)}},opts.drag_opts||{})},drop:function(opts){return $.extend({accept:function(d){if(!$(d).hasClass("jqgrow"))return d;var tid=$(d).closest("table.ui-jqgrid-btable");if(tid.length>0&&void 0!==$.data(tid[0],"dnd")){var cn=$.data(tid[0],"dnd").connectWith;return-1!==$.inArray("#"+$.jgrid.jqID(this.id),cn)?!0:!1}return!1},drop:function(ev,ui){if($(ui.draggable).hasClass("jqgrow")){var accept=$(ui.draggable).attr("id"),getdata=ui.draggable.parent().parent().jqGrid("getRowData",accept);if(!opts.dropbyname){var nm,key,j=0,tmpdata={},dropmodel=$("#"+$.jgrid.jqID(this.id)).jqGrid("getGridParam","colModel");try{for(key in getdata)getdata.hasOwnProperty(key)&&(nm=dropmodel[j].name,"cb"!==nm&&"rn"!==nm&&"subgrid"!==nm&&getdata.hasOwnProperty(key)&&dropmodel[j]&&(tmpdata[nm]=getdata[key]),j++);getdata=tmpdata}catch(e){}}if(ui.helper.dropped=!0,opts.beforedrop&&$.isFunction(opts.beforedrop)){var datatoinsert=opts.beforedrop.call(this,ev,ui,getdata,$("#"+$.jgrid.jqID($t.p.id)),$(this));void 0!==datatoinsert&&null!==datatoinsert&&"object"==typeof datatoinsert&&(getdata=datatoinsert)}if(ui.helper.dropped){var grid;opts.autoid&&($.isFunction(opts.autoid)?grid=opts.autoid.call(this,getdata):(grid=Math.ceil(1e3*Math.random()),grid=opts.autoidprefix+grid)),$("#"+$.jgrid.jqID(this.id)).jqGrid("addRowData",grid,getdata,opts.droppos)}opts.ondrop&&$.isFunction(opts.ondrop)&&opts.ondrop.call(this,ev,ui,getdata)}}},opts.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5e3},dragcopy:!1,dropbyname:!1,droppos:"first",autoid:!0,autoidprefix:"dnd_"},opts||{}),opts.connectWith)for(opts.connectWith=opts.connectWith.split(","),opts.connectWith=$.map(opts.connectWith,function(n){return $.trim(n)}),$.data($t,"dnd",opts),0===$t.p.reccount||$t.p.jqgdnd||updateDnD(),$t.p.jqgdnd=!0,i=0;i<opts.connectWith.length;i++)cn=opts.connectWith[i],$(cn).droppable($.isFunction(opts.drop)?opts.drop.call($($t),opts):opts.drop)}})},gridResize:function(opts){return this.each(function(){var $t=this,gID=$.jgrid.jqID($t.p.id);if($t.grid&&$.fn.resizable){if(opts=$.extend({},opts||{}),opts.alsoResize?(opts._alsoResize_=opts.alsoResize,delete opts.alsoResize):opts._alsoResize_=!1,opts.stop&&$.isFunction(opts.stop)?(opts._stop_=opts.stop,delete opts.stop):opts._stop_=!1,opts.stop=function(ev,ui){$($t).jqGrid("setGridParam",{height:$("#gview_"+gID+" .ui-jqgrid-bdiv").height()}),$($t).jqGrid("setGridWidth",ui.size.width,opts.shrinkToFit),opts._stop_&&opts._stop_.call($t,ev,ui)},opts._alsoResize_){var optstest="{'#gview_"+gID+" .ui-jqgrid-bdiv':true,'"+opts._alsoResize_+"':true}";opts.alsoResize=eval("("+optstest+")")}else opts.alsoResize=$(".ui-jqgrid-bdiv","#gview_"+gID);delete opts._alsoResize_,$("#gbox_"+gID).resizable(opts)}})}}),$.assocArraySize=function(obj){var key,size=0;for(key in obj)obj.hasOwnProperty(key)&&size++;return size},$.jgrid.extend({pivotSetup:function(data,options){var columns=[],pivotrows=[],summaries=[],member=[],labels=[],groupOptions={grouping:!0,groupingView:{groupField:[],groupSummary:[],groupSummaryPos:[]}},headers=[],o=$.extend({rowTotals:!1,rowTotalsText:"Total",colTotals:!1,groupSummary:!0,groupSummaryPos:"header",frozenStaticCols:!1},options||{});return this.each(function(){function find(ar,fun,extra){var res;return res=_pivotfilter.call(ar,fun,extra),res.length>0?res[0]:null}function findGroup(item,index){var i,j=0,ret=!0;for(i in item){if(item.hasOwnProperty(i)&&item[i]!=this[j]){ret=!1;break}if(j++,j>=this.length)break}return ret&&(rowindex=index),ret}function calculation(oper,v,field,rc){var ret;switch(oper){case"sum":ret=parseFloat(v||0)+parseFloat(rc[field]||0);break;case"count":(""===v||null==v)&&(v=0),ret=rc.hasOwnProperty(field)?v+1:0;break;case"min":ret=""===v||null==v?parseFloat(rc[field]||0):Math.min(parseFloat(v),parseFloat(rc[field]||0));break;case"max":ret=""===v||null==v?parseFloat(rc[field]||0):Math.max(parseFloat(v),parseFloat(rc[field]||0))}return ret}function agregateFunc(row,aggr,value,curr){var i,label,j,jv,arrln=aggr.length,mainval="",swapvals=[];for($.isArray(value)?(jv=value.length,swapvals=value):(jv=1,swapvals[0]=value),member=[],labels=[],member.root=0,j=0;jv>j;j++){var vl,tmpmember=[];for(i=0;arrln>i;i++){if(null==value)label=$.trim(aggr[i].member)+"_"+aggr[i].aggregator,vl=label,swapvals[0]=vl;else{vl=value[j].replace(/\s+/g,"");try{label=1===arrln?mainval+vl:mainval+vl+"_"+aggr[i].aggregator+"_"+String(i)}catch(e){}}label=isNaN(parseInt(label,10))?label:label+" ",curr[label]=tmpmember[label]=calculation(aggr[i].aggregator,curr[label],aggr[i].member,row),1>=j&&"_r_Totals"!==vl&&""===mainval&&(mainval=vl)}member[label]=tmpmember,labels[label]=swapvals[j]}return curr}function list(items){var l,j,key,k,col;for(key in items)if(items.hasOwnProperty(key)){if("object"!=typeof items[key]){if("level"===key){if(void 0===lastval[items.level]&&(lastval[items.level]="",items.level>0&&"_r_Totals"!==items.text&&(headers[items.level-1]={useColSpanStyle:!1,groupHeaders:[]})),lastval[items.level]!==items.text&&items.children.length&&"_r_Totals"!==items.text&&items.level>0){headers[items.level-1].groupHeaders.push({titleText:items.label,numberOfColumns:0});var collen=headers[items.level-1].groupHeaders.length-1,colpos=0===collen?swaplen:initColLen+aggrlen;if(items.level-1===(o.rowTotals?1:0)&&collen>0){var l1=headers[items.level-1].groupHeaders[collen-1].numberOfColumns;l1&&(colpos=l1+1+o.aggregates.length)}headers[items.level-1].groupHeaders[collen].startColumnName=columns[colpos].name,headers[items.level-1].groupHeaders[collen].numberOfColumns=columns.length-colpos,initColLen=columns.length}lastval[items.level]=items.text}if(items.level===ylen&&"level"===key&&ylen>0)if(aggrlen>1){var ll=1;for(l in items.fields)items.fields.hasOwnProperty(l)&&1===ll&&headers[ylen-1].groupHeaders.push({startColumnName:l,numberOfColumns:1,titleText:items.text}),ll++;headers[ylen-1].groupHeaders[headers[ylen-1].groupHeaders.length-1].numberOfColumns=ll-1}else headers.splice(ylen-1,1)}if(null!=items[key]&&"object"==typeof items[key]&&list(items[key]),"level"===key&&items.level>0){j=0;for(l in items.fields)if(items.fields.hasOwnProperty(l)){col={};for(k in o.aggregates[j])if(o.aggregates[j].hasOwnProperty(k))switch(k){case"member":case"label":case"aggregator":break;default:col[k]=o.aggregates[j][k]}aggrlen>1?(col.name=l,col.label=o.aggregates[j].label||items.label):(col.name=items.text,col.label="_r_Totals"===items.text?o.rowTotalsText:items.label),columns.push(col),j++}}}}var row,rowindex,i,xlen,ylen,aggrlen,tmp,newObj,rowlen=data.length,r=0;if(o.rowTotals&&o.yDimension.length>0){var dn=o.yDimension[0].dataName;

o.yDimension.splice(0,0,{dataName:dn}),o.yDimension[0].converter=function(){return"_r_Totals"}}if(xlen=$.isArray(o.xDimension)?o.xDimension.length:0,ylen=o.yDimension.length,aggrlen=$.isArray(o.aggregates)?o.aggregates.length:0,0===xlen||0===aggrlen)throw"xDimension or aggregates optiona are not set!";var colc;for(i=0;xlen>i;i++)colc={name:o.xDimension[i].dataName,frozen:o.frozenStaticCols},null==o.xDimension[i].isGroupField&&(o.xDimension[i].isGroupField=!0),colc=$.extend(!0,colc,o.xDimension[i]),columns.push(colc);for(var groupfields=xlen-1,tree={};rowlen>r;){row=data[r];var xValue=[],yValue=[];tmp={},i=0;do xValue[i]=$.trim(row[o.xDimension[i].dataName]),tmp[o.xDimension[i].dataName]=xValue[i],i++;while(xlen>i);var k=0;if(rowindex=-1,newObj=find(pivotrows,findGroup,xValue)){if(rowindex>=0){if(k=0,ylen>=1){for(k=0;ylen>k;k++)yValue[k]=$.trim(row[o.yDimension[k].dataName]),o.yDimension[k].converter&&$.isFunction(o.yDimension[k].converter)&&(yValue[k]=o.yDimension[k].converter.call(this,yValue[k],xValue,yValue));newObj=agregateFunc(row,o.aggregates,yValue,newObj)}else 0===ylen&&(newObj=agregateFunc(row,o.aggregates,null,newObj));pivotrows[rowindex]=newObj}}else{if(k=0,ylen>=1){for(k=0;ylen>k;k++)yValue[k]=$.trim(row[o.yDimension[k].dataName]),o.yDimension[k].converter&&$.isFunction(o.yDimension[k].converter)&&(yValue[k]=o.yDimension[k].converter.call(this,yValue[k],xValue,yValue));tmp=agregateFunc(row,o.aggregates,yValue,tmp)}else 0===ylen&&(tmp=agregateFunc(row,o.aggregates,null,tmp));pivotrows.push(tmp)}var kk,kj=0,current=null,existing=null;for(kk in member)if(member.hasOwnProperty(kk)){if(0===kj)tree.children&&void 0!==tree.children||(tree={text:kk,level:0,children:[],label:kk}),current=tree.children;else{for(existing=null,i=0;i<current.length;i++)if(current[i].text===kk){existing=current[i];break}existing?current=existing.children:(current.push({children:[],text:kk,level:kj,fields:member[kk],label:labels[kk]}),current=current[current.length-1].children)}kj++}r++}var lastval=[],initColLen=columns.length,swaplen=initColLen;ylen>0&&(headers[ylen-1]={useColSpanStyle:!1,groupHeaders:[]}),list(tree);var nm;if(o.colTotals)for(var plen=pivotrows.length;plen--;)for(i=xlen;i<columns.length;i++)nm=columns[i].name,summaries[nm]?summaries[nm]+=parseFloat(pivotrows[plen][nm]||0):summaries[nm]=parseFloat(pivotrows[plen][nm]||0);if(groupfields>0)for(i=0;groupfields>i;i++)columns[i].isGroupField&&(groupOptions.groupingView.groupField.push(columns[i].name),groupOptions.groupingView.groupSummary.push(o.groupSummary),groupOptions.groupingView.groupSummaryPos.push(o.groupSummaryPos));else groupOptions.grouping=!1;groupOptions.sortname=columns[groupfields].name,groupOptions.groupingView.hideFirstGroupCol=!0}),{colModel:columns,rows:pivotrows,groupOptions:groupOptions,groupHeaders:headers,summary:summaries}},jqPivot:function(data,pivotOpt,gridOpt,ajaxOpt){return this.each(function(){function pivot(data){var i,pivotGrid=jQuery($t).jqGrid("pivotSetup",data,pivotOpt),footerrow=$.assocArraySize(pivotGrid.summary)>0?!0:!1,query=$.jgrid.from.call($t,pivotGrid.rows);for(i=0;i<pivotGrid.groupOptions.groupingView.groupField.length;i++)query.orderBy(pivotGrid.groupOptions.groupingView.groupField[i],"a","text","");jQuery($t).jqGrid($.extend(!0,{datastr:$.extend(query.select(),footerrow?{userdata:pivotGrid.summary}:{}),datatype:"jsonstring",footerrow:footerrow,userDataOnFooter:footerrow,colModel:pivotGrid.colModel,viewrecords:!0,sortname:pivotOpt.xDimension[0].dataName},pivotGrid.groupOptions,gridOpt||{}));var gHead=pivotGrid.groupHeaders;if(gHead.length)for(i=0;i<gHead.length;i++)gHead[i]&&gHead[i].groupHeaders.length&&jQuery($t).jqGrid("setGroupHeaders",gHead[i]);pivotOpt.frozenStaticCols&&jQuery($t).jqGrid("setFrozenColumns")}var $t=this;"string"==typeof data?$.ajax($.extend({url:data,dataType:"json",success:function(response){pivot($.jgrid.getAccessor(response,ajaxOpt&&ajaxOpt.reader?ajaxOpt.reader:"rows"))}},ajaxOpt||{})):pivot(data)})}}),$.jgrid.extend({setSubGrid:function(){return this.each(function(){var cm,i,$t=this,suboptions={plusicon:"ui-icon-plus",minusicon:"ui-icon-minus",openicon:"ui-icon-carat-1-sw",expandOnLoad:!1,delayOnLoad:50,selectOnExpand:!1,selectOnCollapse:!1,reloadOnExpand:!0};if($t.p.subGridOptions=$.extend(suboptions,$t.p.subGridOptions||{}),$t.p.colNames.unshift(""),$t.p.colModel.unshift({name:"subgrid",width:$.jgrid.cell_width?$t.p.subGridWidth+$t.p.cellLayout:$t.p.subGridWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,fixed:!0}),cm=$t.p.subGridModel,cm[0])for(cm[0].align=$.extend([],cm[0].align||[]),i=0;i<cm[0].name.length;i++)cm[0].align[i]=cm[0].align[i]||"left"})},addSubGridCell:function(pos,iRow){var ic,sid,prp="";return this.each(function(){prp=this.formatCol(pos,iRow),sid=this.p.id,ic=this.p.subGridOptions.plusicon}),'<td role="gridcell" aria-describedby="'+sid+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+prp+"><a style='cursor:pointer;'><span class='ui-icon "+ic+"'></span></a></td>"},addSubGrid:function(pos,sind){return this.each(function(){var ts=this;if(ts.grid){var _id,pID,atd,bfsc,$r,subGridCell=function(trdiv,cell,pos){var tddiv=$("<td align='"+ts.p.subGridModel[0].align[pos]+"'></td>").html(cell);$(trdiv).append(tddiv)},subGridXml=function(sjxml,sbid){var tddiv,i,sgmap,dummy=$("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),trdiv=$("<tr></tr>");for(i=0;i<ts.p.subGridModel[0].name.length;i++)tddiv=$("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+ts.p.direction+"'></th>"),$(tddiv).html(ts.p.subGridModel[0].name[i]),$(tddiv).width(ts.p.subGridModel[0].width[i]),$(trdiv).append(tddiv);$(dummy).append(trdiv),sjxml&&(sgmap=ts.p.xmlReader.subgrid,$(sgmap.root+" "+sgmap.row,sjxml).each(function(){if(trdiv=$("<tr class='ui-widget-content ui-subtblcell'></tr>"),sgmap.repeatitems===!0)$(sgmap.cell,this).each(function(i){subGridCell(trdiv,$(this).text()||"&#160;",i)});else{var f=ts.p.subGridModel[0].mapping||ts.p.subGridModel[0].name;if(f)for(i=0;i<f.length;i++)subGridCell(trdiv,$(f[i],this).text()||"&#160;",i)}$(dummy).append(trdiv)}));var pID=$("table:first",ts.grid.bDiv).attr("id")+"_";return $("#"+$.jgrid.jqID(pID+sbid)).append(dummy),ts.grid.hDiv.loading=!1,$("#load_"+$.jgrid.jqID(ts.p.id)).hide(),!1},subGridJson=function(sjxml,sbid){var tddiv,result,i,cur,sgmap,j,dummy=$("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),trdiv=$("<tr></tr>");for(i=0;i<ts.p.subGridModel[0].name.length;i++)tddiv=$("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+ts.p.direction+"'></th>"),$(tddiv).html(ts.p.subGridModel[0].name[i]),$(tddiv).width(ts.p.subGridModel[0].width[i]),$(trdiv).append(tddiv);if($(dummy).append(trdiv),sjxml&&(sgmap=ts.p.jsonReader.subgrid,result=$.jgrid.getAccessor(sjxml,sgmap.root),void 0!==result))for(i=0;i<result.length;i++){if(cur=result[i],trdiv=$("<tr class='ui-widget-content ui-subtblcell'></tr>"),sgmap.repeatitems===!0)for(sgmap.cell&&(cur=cur[sgmap.cell]),j=0;j<cur.length;j++)subGridCell(trdiv,cur[j]||"&#160;",j);else{var f=ts.p.subGridModel[0].mapping||ts.p.subGridModel[0].name;if(f.length)for(j=0;j<f.length;j++)subGridCell(trdiv,cur[f[j]]||"&#160;",j)}$(dummy).append(trdiv)}var pID=$("table:first",ts.grid.bDiv).attr("id")+"_";return $("#"+$.jgrid.jqID(pID+sbid)).append(dummy),ts.grid.hDiv.loading=!1,$("#load_"+$.jgrid.jqID(ts.p.id)).hide(),!1},populatesubgrid=function(rd){var sid,dp,i,j;if(sid=$(rd).attr("id"),dp={nd_:(new Date).getTime()},dp[ts.p.prmNames.subgridid]=sid,!ts.p.subGridModel[0])return!1;if(ts.p.subGridModel[0].params)for(j=0;j<ts.p.subGridModel[0].params.length;j++)for(i=0;i<ts.p.colModel.length;i++)ts.p.colModel[i].name===ts.p.subGridModel[0].params[j]&&(dp[ts.p.colModel[i].name]=$("td:eq("+i+")",rd).text().replace(/\&#160\;/gi,""));if(!ts.grid.hDiv.loading)switch(ts.grid.hDiv.loading=!0,$("#load_"+$.jgrid.jqID(ts.p.id)).show(),ts.p.subgridtype||(ts.p.subgridtype=ts.p.datatype),$.isFunction(ts.p.subgridtype)?ts.p.subgridtype.call(ts,dp):ts.p.subgridtype=ts.p.subgridtype.toLowerCase(),ts.p.subgridtype){case"xml":case"json":$.ajax($.extend({type:ts.p.mtype,url:$.isFunction(ts.p.subGridUrl)?ts.p.subGridUrl.call(ts,dp):ts.p.subGridUrl,dataType:ts.p.subgridtype,data:$.isFunction(ts.p.serializeSubGridData)?ts.p.serializeSubGridData.call(ts,dp):dp,complete:function(sxml){"xml"===ts.p.subgridtype?subGridXml(sxml.responseXML,sid):subGridJson($.jgrid.parse(sxml.responseText),sid),sxml=null}},$.jgrid.ajaxOptions,ts.p.ajaxSubgridOptions||{}))}return!1},nhc=0;$.each(ts.p.colModel,function(){(this.hidden===!0||"rn"===this.name||"cb"===this.name)&&nhc++});var len=ts.rows.length,i=1;for(void 0!==sind&&sind>0&&(i=sind,len=sind+1);len>i;)$(ts.rows[i]).hasClass("jqgrow")&&(ts.p.scroll&&$(ts.rows[i].cells[pos]).unbind("click"),$(ts.rows[i].cells[pos]).bind("click",function(){var tr=$(this).parent("tr")[0];if(pID=ts.p.id,_id=tr.id,$r=$("#"+pID+"_"+_id+"_expandedContent"),$(this).hasClass("sgcollapsed")){if(bfsc=$(ts).triggerHandler("jqGridSubGridBeforeExpand",[pID+"_"+_id,_id]),bfsc=bfsc===!1||"stop"===bfsc?!1:!0,bfsc&&$.isFunction(ts.p.subGridBeforeExpand)&&(bfsc=ts.p.subGridBeforeExpand.call(ts,pID+"_"+_id,_id)),bfsc===!1)return!1;ts.p.subGridOptions.reloadOnExpand===!0||ts.p.subGridOptions.reloadOnExpand===!1&&!$r.hasClass("ui-subgrid")?(atd=pos>=1?"<td colspan='"+pos+"'>&#160;</td>":"",$(tr).after("<tr role='row' id='"+pID+"_"+_id+"_expandedContent' class='ui-subgrid ui-sg-expanded'>"+atd+"<td class='ui-widget-content subgrid-cell'><span class='ui-icon "+ts.p.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(ts.p.colNames.length-1-nhc,10)+"' class='ui-widget-content subgrid-data'><div id="+pID+"_"+_id+" class='tablediv'></div></td></tr>"),$(ts).triggerHandler("jqGridSubGridRowExpanded",[pID+"_"+_id,_id]),$.isFunction(ts.p.subGridRowExpanded)?ts.p.subGridRowExpanded.call(ts,pID+"_"+_id,_id):populatesubgrid(tr)):$r.show().removeClass("ui-sg-collapsed").addClass("ui-sg-expanded"),$(this).html("<a style='cursor:pointer;'><span class='ui-icon "+ts.p.subGridOptions.minusicon+"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded"),ts.p.subGridOptions.selectOnExpand&&$(ts).jqGrid("setSelection",_id)}else if($(this).hasClass("sgexpanded")){if(bfsc=$(ts).triggerHandler("jqGridSubGridRowColapsed",[pID+"_"+_id,_id]),bfsc=bfsc===!1||"stop"===bfsc?!1:!0,bfsc&&$.isFunction(ts.p.subGridRowColapsed)&&(bfsc=ts.p.subGridRowColapsed.call(ts,pID+"_"+_id,_id)),bfsc===!1)return!1;ts.p.subGridOptions.reloadOnExpand===!0?$r.remove(".ui-subgrid"):$r.hasClass("ui-subgrid")&&$r.hide().addClass("ui-sg-collapsed").removeClass("ui-sg-expanded"),$(this).html("<a style='cursor:pointer;'><span class='ui-icon "+ts.p.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed"),ts.p.subGridOptions.selectOnCollapse&&$(ts).jqGrid("setSelection",_id)}return!1})),i++;ts.p.subGridOptions.expandOnLoad===!0&&$(ts.rows).filter(".jqgrow").each(function(index,row){$(row.cells[0]).click()}),ts.subGridXml=function(xml,sid){subGridXml(xml,sid)},ts.subGridJson=function(json,sid){subGridJson(json,sid)}}})},expandSubGridRow:function(rowid){return this.each(function(){var $t=this;if(($t.grid||rowid)&&$t.p.subGrid===!0){var rc=$(this).jqGrid("getInd",rowid,!0);if(rc){var sgc=$("td.sgcollapsed",rc)[0];sgc&&$(sgc).trigger("click")}}})},collapseSubGridRow:function(rowid){return this.each(function(){var $t=this;if(($t.grid||rowid)&&$t.p.subGrid===!0){var rc=$(this).jqGrid("getInd",rowid,!0);if(rc){var sgc=$("td.sgexpanded",rc)[0];sgc&&$(sgc).trigger("click")}}})},toggleSubGridRow:function(rowid){return this.each(function(){var $t=this;if(($t.grid||rowid)&&$t.p.subGrid===!0){var rc=$(this).jqGrid("getInd",rowid,!0);if(rc){var sgc=$("td.sgcollapsed",rc)[0];sgc?$(sgc).trigger("click"):(sgc=$("td.sgexpanded",rc)[0],sgc&&$(sgc).trigger("click"))}}})}}),$.jgrid.extend({setTreeNode:function(i,len){return this.each(function(){var $t=this;if($t.grid&&$t.p.treeGrid)for(var lft,rgt,curLevel,ident,lftpos,twrap,ldat,lf,expCol=$t.p.expColInd,expanded=$t.p.treeReader.expanded_field,isLeaf=$t.p.treeReader.leaf_field,level=$t.p.treeReader.level_field,icon=$t.p.treeReader.icon_field,icon_show=$t.p.treeReader.icon_display,loaded=$t.p.treeReader.loaded;len>i;){var expan,ind=$.jgrid.stripPref($t.p.idPrefix,$t.rows[i].id),dind=$t.p._index[ind];ldat=$t.p.data[dind],"nested"===$t.p.treeGridModel&&(ldat[isLeaf]||(lft=parseInt(ldat[$t.p.treeReader.left_field],10),rgt=parseInt(ldat[$t.p.treeReader.right_field],10),ldat[isLeaf]=rgt===lft+1?"true":"false",$t.rows[i].cells[$t.p._treeleafpos].innerHTML=ldat[isLeaf])),curLevel=parseInt(ldat[level],10),0===$t.p.tree_root_level?(ident=curLevel+1,lftpos=curLevel):(ident=curLevel,lftpos=curLevel-1),twrap="<div class='tree-wrap tree-wrap-"+$t.p.direction+"' style='width:"+18*ident+"px;'>",ldat[icon_show]!==!1?(twrap+="<div style='"+("rtl"===$t.p.direction?"right:":"left:")+18*lftpos+"px;' class='ui-icon ",void 0!==ldat[loaded]&&("true"===ldat[loaded]||ldat[loaded]===!0?ldat[loaded]=!0:ldat[loaded]=!1),"true"===ldat[isLeaf]||ldat[isLeaf]===!0?(twrap+=(void 0!==ldat[icon]&&""!==ldat[icon]?ldat[icon]:$t.p.treeIcons.leaf)+" tree-leaf treeclick",ldat[isLeaf]=!0,lf="leaf"):(ldat[isLeaf]=!1,lf=""),ldat[expanded]=("true"===ldat[expanded]||ldat[expanded]===!0?!0:!1)&&(ldat[loaded]||void 0===ldat[loaded]),twrap+=ldat[expanded]===!1?ldat[isLeaf]===!0?"'":$t.p.treeIcons.plus+" tree-plus treeclick'":ldat[isLeaf]===!0?"'":$t.p.treeIcons.minus+" tree-minus treeclick'",twrap+="></div></div>"):twrap+="</div>",$($t.rows[i].cells[expCol]).wrapInner("<span class='cell-wrapper"+lf+"'></span>").prepend(twrap),curLevel!==parseInt($t.p.tree_root_level,10)&&(expan=$($t).jqGrid("isVisibleNode",ldat),expan||$($t.rows[i]).css("display","none")),$($t.rows[i].cells[expCol]).find("div.treeclick").bind("click",function(e){var target=e.target||e.srcElement,ind2=$.jgrid.stripPref($t.p.idPrefix,$(target,$t.rows).closest("tr.jqgrow")[0].id),pos=$t.p._index[ind2];return $t.p.data[pos][isLeaf]||($t.p.data[pos][expanded]?($($t).jqGrid("collapseRow",$t.p.data[pos]),$($t).jqGrid("collapseNode",$t.p.data[pos])):($($t).jqGrid("expandRow",$t.p.data[pos]),$($t).jqGrid("expandNode",$t.p.data[pos]))),!1}),$t.p.ExpandColClick===!0&&$($t.rows[i].cells[expCol]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(e){var target=e.target||e.srcElement,ind2=$.jgrid.stripPref($t.p.idPrefix,$(target,$t.rows).closest("tr.jqgrow")[0].id),pos=$t.p._index[ind2];return $t.p.data[pos][isLeaf]||($t.p.data[pos][expanded]?($($t).jqGrid("collapseRow",$t.p.data[pos]),$($t).jqGrid("collapseNode",$t.p.data[pos])):($($t).jqGrid("expandRow",$t.p.data[pos]),$($t).jqGrid("expandNode",$t.p.data[pos]))),$($t).jqGrid("setSelection",ind2),!1}),i++}})},setTreeGrid:function(){return this.each(function(){var pico,nm,key,tkey,$t=this,i=0,ecol=!1,dupcols=[];if($t.p.treeGrid){$t.p.treedatatype||$.extend($t.p,{treedatatype:$t.p.datatype}),$t.p.loadonce&&($t.p.treedatatype="local"),$t.p.subGrid=!1,$t.p.altRows=!1,$t.p.gridview=!0,$t.p.multiselect=!0,$t.p.rowList=[],$t.p.expColInd=0,pico="ui-icon-triangle-1-"+("rtl"===$t.p.direction?"w":"e"),$t.p.treeIcons=$.extend({plus:pico,minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},$t.p.treeIcons||{}),"nested"===$t.p.treeGridModel?$t.p.treeReader=$.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},$t.p.treeReader):"adjacency"===$t.p.treeGridModel&&($t.p.treeReader=$.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon",icon_display:"icon_show"},$t.p.treeReader));for(key in $t.p.colModel)if($t.p.colModel.hasOwnProperty(key)){nm=$t.p.colModel[key].name,nm!==$t.p.ExpandColumn||ecol||(ecol=!0,$t.p.expColInd=i),i++;for(tkey in $t.p.treeReader)$t.p.treeReader.hasOwnProperty(tkey)&&$t.p.treeReader[tkey]===nm&&dupcols.push(nm)}$.each($t.p.treeReader,function(j,n){n&&-1===$.inArray(n,dupcols)&&("leaf_field"===j&&($t.p._treeleafpos=i),i++,$t.p.colNames.push(n),$t.p.colModel.push({name:n,width:1,hidden:!0,sortable:!1,resizable:!1,hidedlg:!0,editable:!0,search:!1}))})}})},expandRow:function(record){this.each(function(){var $t=this;if($t.grid&&$t.p.treeGrid){var childern=$($t).jqGrid("getNodeChildren",record),expanded=$t.p.treeReader.expanded_field;$(childern).each(function(){var id=$t.p.idPrefix+$.jgrid.getAccessor(this,$t.p.localReader.id);$($($t).jqGrid("getGridRowById",id)).css("display",""),this[expanded]&&$($t).jqGrid("expandRow",this)})}})},collapseRow:function(record){this.each(function(){var $t=this;if($t.grid&&$t.p.treeGrid){var childern=$($t).jqGrid("getNodeChildren",record),expanded=$t.p.treeReader.expanded_field;$(childern).each(function(){var id=$t.p.idPrefix+$.jgrid.getAccessor(this,$t.p.localReader.id);$($($t).jqGrid("getGridRowById",id)).css("display","none"),this[expanded]&&$($t).jqGrid("collapseRow",this)})}})},getRootNodes:function(currentview){var result=[];return this.each(function(){var level,parent_id,view,$t=this;if($t.grid&&$t.p.treeGrid)switch("boolean"!=typeof currentview&&(currentview=!1),view=currentview?$($t).jqGrid("getRowData",null,!0):$t.p.data,$t.p.treeGridModel){case"nested":level=$t.p.treeReader.level_field,$(view).each(function(){parseInt(this[level],10)===parseInt($t.p.tree_root_level,10)&&result.push(currentview?$t.p.data[$t.p._index[this[$t.p.keyName]]]:this)});break;case"adjacency":parent_id=$t.p.treeReader.parent_id_field,$(view).each(function(){(null===this[parent_id]||"null"===String(this[parent_id]).toLowerCase())&&result.push(currentview?$t.p.data[$t.p._index[this[$t.p.keyName]]]:this)})}}),result},getNodeDepth:function(rc){var ret=null;return this.each(function(){if(this.grid&&this.p.treeGrid){var $t=this;switch($t.p.treeGridModel){case"nested":var level=$t.p.treeReader.level_field;ret=parseInt(rc[level],10)-parseInt($t.p.tree_root_level,10);break;case"adjacency":ret=$($t).jqGrid("getNodeAncestors",rc).length}}}),ret},getNodeParent:function(rc){var result=null;return this.each(function(){var $t=this;if($t.grid&&$t.p.treeGrid)switch($t.p.treeGridModel){case"nested":var lftc=$t.p.treeReader.left_field,rgtc=$t.p.treeReader.right_field,levelc=$t.p.treeReader.level_field,lft=parseInt(rc[lftc],10),rgt=parseInt(rc[rgtc],10),level=parseInt(rc[levelc],10);$(this.p.data).each(function(){return parseInt(this[levelc],10)===level-1&&parseInt(this[lftc],10)<lft&&parseInt(this[rgtc],10)>rgt?(result=this,!1):void 0});break;case"adjacency":for(var parent_id=$t.p.treeReader.parent_id_field,dtid=$t.p.localReader.id,ind=rc[dtid],pos=$t.p._index[ind];pos--;)if($t.p.data[pos][dtid]===$.jgrid.stripPref($t.p.idPrefix,rc[parent_id])){result=$t.p.data[pos];break}}}),result},getNodeChildren:function(rc){var result=[];return this.each(function(){var $t=this;if($t.grid&&$t.p.treeGrid)switch($t.p.treeGridModel){case"nested":var lftc=$t.p.treeReader.left_field,rgtc=$t.p.treeReader.right_field,levelc=$t.p.treeReader.level_field,lft=parseInt(rc[lftc],10),rgt=parseInt(rc[rgtc],10),level=parseInt(rc[levelc],10);$(this.p.data).each(function(){parseInt(this[levelc],10)===level+1&&parseInt(this[lftc],10)>lft&&parseInt(this[rgtc],10)<rgt&&result.push(this)});break;case"adjacency":var parent_id=$t.p.treeReader.parent_id_field,dtid=$t.p.localReader.id;$(this.p.data).each(function(){this[parent_id]==$.jgrid.stripPref($t.p.idPrefix,rc[dtid])&&result.push(this)})}}),result},getFullTreeNode:function(rc,expand){var result=[];return this.each(function(){var len,$t=this,expanded=$t.p.treeReader.expanded_field;if($t.grid&&$t.p.treeGrid)switch((null==expand||"boolean"!=typeof expand)&&(expand=!1),$t.p.treeGridModel){case"nested":var lftc=$t.p.treeReader.left_field,rgtc=$t.p.treeReader.right_field,levelc=$t.p.treeReader.level_field,lft=parseInt(rc[lftc],10),rgt=parseInt(rc[rgtc],10),level=parseInt(rc[levelc],10);$(this.p.data).each(function(){parseInt(this[levelc],10)>=level&&parseInt(this[lftc],10)>=lft&&parseInt(this[lftc],10)<=rgt&&(expand&&(this[expanded]=!0),result.push(this))});break;case"adjacency":if(rc){result.push(rc);var parent_id=$t.p.treeReader.parent_id_field,dtid=$t.p.localReader.id;$(this.p.data).each(function(i){for(len=result.length,i=0;len>i;i++)if($.jgrid.stripPref($t.p.idPrefix,result[i][dtid])===this[parent_id]){expand&&(this[expanded]=!0),result.push(this);break}})}}}),result},getNodeAncestors:function(rc){var ancestors=[];return this.each(function(){if(this.grid&&this.p.treeGrid)for(var parent=$(this).jqGrid("getNodeParent",rc);parent;)ancestors.push(parent),parent=$(this).jqGrid("getNodeParent",parent)}),ancestors},isVisibleNode:function(rc){var result=!0;return this.each(function(){var $t=this;if($t.grid&&$t.p.treeGrid){var ancestors=$($t).jqGrid("getNodeAncestors",rc),expanded=$t.p.treeReader.expanded_field;$(ancestors).each(function(){return result=result&&this[expanded],result?void 0:!1})}}),result},isNodeLoaded:function(rc){var result;return this.each(function(){var $t=this;if($t.grid&&$t.p.treeGrid){var isLeaf=$t.p.treeReader.leaf_field,loaded=$t.p.treeReader.loaded;result=void 0!==rc?void 0!==rc[loaded]?rc[loaded]:rc[isLeaf]||$($t).jqGrid("getNodeChildren",rc).length>0?!0:!1:!1}}),result},expandNode:function(rc){return this.each(function(){if(this.grid&&this.p.treeGrid){var expanded=this.p.treeReader.expanded_field,parent=this.p.treeReader.parent_id_field,loaded=this.p.treeReader.loaded,level=this.p.treeReader.level_field,lft=this.p.treeReader.left_field,rgt=this.p.treeReader.right_field;if(!rc[expanded]){var id=$.jgrid.getAccessor(rc,this.p.localReader.id),rc1=$("#"+this.p.idPrefix+$.jgrid.jqID(id),this.grid.bDiv)[0],position=this.p._index[id];$(this).jqGrid("isNodeLoaded",this.p.data[position])?(rc[expanded]=!0,$("div.treeclick",rc1).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")):this.grid.hDiv.loading||(rc[expanded]=!0,$("div.treeclick",rc1).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus"),this.p.treeANode=rc1.rowIndex,this.p.datatype=this.p.treedatatype,"nested"===this.p.treeGridModel?$(this).jqGrid("setGridParam",{postData:{nodeid:id,n_left:rc[lft],n_right:rc[rgt],n_level:rc[level]}}):$(this).jqGrid("setGridParam",{postData:{nodeid:id,parentid:rc[parent],n_level:rc[level]}}),$(this).trigger("reloadGrid"),rc[loaded]=!0,"nested"===this.p.treeGridModel?$(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}}):$(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}}))}}})},collapseNode:function(rc){return this.each(function(){if(this.grid&&this.p.treeGrid){var expanded=this.p.treeReader.expanded_field;if(rc[expanded]){rc[expanded]=!1;var id=$.jgrid.getAccessor(rc,this.p.localReader.id),rc1=$("#"+this.p.idPrefix+$.jgrid.jqID(id),this.grid.bDiv)[0];$("div.treeclick",rc1).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus")}}})},SortTree:function(sortname,newDir,st,datefmt){return this.each(function(){if(this.grid&&this.p.treeGrid){var i,len,rec,query,roots,records=[],$t=this,rt=$(this).jqGrid("getRootNodes",$t.p.search);for(query=$.jgrid.from.call(this,rt),query.orderBy(sortname,newDir,st,datefmt),roots=query.select(),i=0,len=roots.length;len>i;i++)rec=roots[i],records.push(rec),$(this).jqGrid("collectChildrenSortTree",records,rec,sortname,newDir,st,datefmt);$.each(records,function(index){var id=$.jgrid.getAccessor(this,$t.p.localReader.id);$("#"+$.jgrid.jqID($t.p.id)+" tbody tr:eq("+index+")").after($("tr#"+$.jgrid.jqID(id),$t.grid.bDiv))}),query=null,roots=null,records=null}})},searchTree:function(recs){var i,lid,tid,len=recs.length||0,res=[],roots=[],result=[];return this.each(function(){if(this.grid&&this.p.treeGrid&&len)for(lid=this.p.localReader.id,i=0;len>i;i++)res=$(this).jqGrid("getNodeAncestors",recs[i]),res.length||res.push(recs[i]),tid=res[res.length-1][lid],-1===$.inArray(tid,roots)&&(roots.push(tid),res=$(this).jqGrid("getFullTreeNode",res[res.length-1],!0),result=result.concat(res))}),result},collectChildrenSortTree:function(records,rec,sortname,newDir,st,datefmt){return this.each(function(){if(this.grid&&this.p.treeGrid){var i,len,child,ch,query,children;for(ch=$(this).jqGrid("getNodeChildren",rec),query=$.jgrid.from.call(this,ch),query.orderBy(sortname,newDir,st,datefmt),children=query.select(),i=0,len=children.length;len>i;i++)child=children[i],records.push(child),$(this).jqGrid("collectChildrenSortTree",records,child,sortname,newDir,st,datefmt)}})},setTreeRow:function(rowid,data){var success=!1;return this.each(function(){var t=this;t.grid&&t.p.treeGrid&&(success=$(t).jqGrid("setRowData",rowid,data))}),success},delTreeNode:function(rowid){return this.each(function(){var i,myright,width,res,key,$t=this,rid=$t.p.localReader.id,left=$t.p.treeReader.left_field,right=$t.p.treeReader.right_field;if($t.grid&&$t.p.treeGrid){var rc=$t.p._index[rowid];if(void 0!==rc){myright=parseInt($t.p.data[rc][right],10),width=myright-parseInt($t.p.data[rc][left],10)+1;var dr=$($t).jqGrid("getFullTreeNode",$t.p.data[rc]);if(dr.length>0)for(i=0;i<dr.length;i++)$($t).jqGrid("delRowData",dr[i][rid]);if("nested"===$t.p.treeGridModel){if(res=$.jgrid.from.call($t,$t.p.data).greater(left,myright,{stype:"integer"}).select(),res.length)for(key in res)res.hasOwnProperty(key)&&(res[key][left]=parseInt(res[key][left],10)-width);if(res=$.jgrid.from.call($t,$t.p.data).greater(right,myright,{stype:"integer"}).select(),res.length)for(key in res)res.hasOwnProperty(key)&&(res[key][right]=parseInt(res[key][right],10)-width)}}}})},addChildNode:function(nodeid,parentid,data,expandData){var $t=this[0];if(data){var method,parentindex,parentdata,parentlevel,i,len,leaf,maxright,expanded=$t.p.treeReader.expanded_field,isLeaf=$t.p.treeReader.leaf_field,level=$t.p.treeReader.level_field,parent=$t.p.treeReader.parent_id_field,left=$t.p.treeReader.left_field,right=$t.p.treeReader.right_field,loaded=$t.p.treeReader.loaded,max=0,rowind=parentid;if(void 0===expandData&&(expandData=!1),null==nodeid){if(i=$t.p.data.length-1,i>=0)for(;i>=0;)max=Math.max(max,parseInt($t.p.data[i][$t.p.localReader.id],10)),i--;nodeid=max+1}var prow=$($t).jqGrid("getInd",parentid);if(leaf=!1,void 0===parentid||null===parentid||""===parentid)parentid=null,rowind=null,method="last",parentlevel=$t.p.tree_root_level,i=$t.p.data.length+1;else{method="after",parentindex=$t.p._index[parentid],parentdata=$t.p.data[parentindex],parentid=parentdata[$t.p.localReader.id],parentlevel=parseInt(parentdata[level],10)+1;var childs=$($t).jqGrid("getFullTreeNode",parentdata);childs.length?(i=childs[childs.length-1][$t.p.localReader.id],rowind=i,i=$($t).jqGrid("getInd",rowind)+1):i=$($t).jqGrid("getInd",parentid)+1,parentdata[isLeaf]&&(leaf=!0,parentdata[expanded]=!0,$($t.rows[prow]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass($t.p.treeIcons.leaf+" tree-leaf").addClass($t.p.treeIcons.minus+" tree-minus"),$t.p.data[parentindex][isLeaf]=!1,parentdata[loaded]=!0)}if(len=i+1,void 0===data[expanded]&&(data[expanded]=!1),void 0===data[loaded]&&(data[loaded]=!1),data[level]=parentlevel,void 0===data[isLeaf]&&(data[isLeaf]=!0),"adjacency"===$t.p.treeGridModel&&(data[parent]=parentid),"nested"===$t.p.treeGridModel){var query,res,key;if(null!==parentid){if(maxright=parseInt(parentdata[right],10),query=$.jgrid.from.call($t,$t.p.data),query=query.greaterOrEquals(right,maxright,{stype:"integer"}),res=query.select(),res.length)for(key in res)res.hasOwnProperty(key)&&(res[key][left]=res[key][left]>maxright?parseInt(res[key][left],10)+2:res[key][left],res[key][right]=res[key][right]>=maxright?parseInt(res[key][right],10)+2:res[key][right]);data[left]=maxright,data[right]=maxright+1}else{if(maxright=parseInt($($t).jqGrid("getCol",right,!1,"max"),10),res=$.jgrid.from.call($t,$t.p.data).greater(left,maxright,{stype:"integer"}).select(),res.length)for(key in res)res.hasOwnProperty(key)&&(res[key][left]=parseInt(res[key][left],10)+2);if(res=$.jgrid.from.call($t,$t.p.data).greater(right,maxright,{stype:"integer"}).select(),res.length)for(key in res)res.hasOwnProperty(key)&&(res[key][right]=parseInt(res[key][right],10)+2);data[left]=maxright+1,data[right]=maxright+2}}(null===parentid||$($t).jqGrid("isNodeLoaded",parentdata)||leaf)&&($($t).jqGrid("addRowData",nodeid,data,method,rowind),$($t).jqGrid("setTreeNode",i,len)),parentdata&&!parentdata[expanded]&&expandData&&$($t.rows[prow]).find("div.treeclick").click()}}}),$.fn.jqDrag=function(h){return i(this,h,"d")},$.fn.jqResize=function(h,ar){return i(this,h,"r",ar)},$.jqDnR={dnr:{},e:0,drag:function(v){return"d"==M.k?E.css({left:M.X+v.pageX-M.pX,top:M.Y+v.pageY-M.pY}):(E.css({width:Math.max(v.pageX-M.pX+M.W,0),height:Math.max(v.pageY-M.pY+M.H,0)}),M1&&E1.css({width:Math.max(v.pageX-M1.pX+M1.W,0),height:Math.max(v.pageY-M1.pY+M1.H,0)})),!1},stop:function(){$(document).unbind("mousemove",J.drag).unbind("mouseup",J.stop)}};var J=$.jqDnR,M=J.dnr,E=J.e,E1,M1,i=function(e,h,k,aR){return e.each(function(){h=h?$(h,e):e,h.bind("mousedown",{e:e,k:k},function(v){var d=v.data,p={};if(E=d.e,E1=aR?$(aR):!1,"relative"!=E.css("position"))try{E.position(p)}catch(e){}if(M={X:p.left||f("left")||0,Y:p.top||f("top")||0,W:f("width")||E[0].scrollWidth||0,H:f("height")||E[0].scrollHeight||0,pX:v.pageX,pY:v.pageY,k:d.k},M1=E1&&"d"!=d.k?{X:p.left||f1("left")||0,Y:p.top||f1("top")||0,W:E1[0].offsetWidth||f1("width")||0,H:E1[0].offsetHeight||f1("height")||0,pX:v.pageX,pY:v.pageY,k:d.k}:!1,$("input.hasDatepicker",E[0])[0])try{$("input.hasDatepicker",E[0]).datepicker("hide")}catch(dpe){}return $(document).mousemove($.jqDnR.drag).mouseup($.jqDnR.stop),!1})})},f=function(k){return parseInt(E.css(k),10)||!1},f1=function(k){return parseInt(E1.css(k),10)||!1};$.fn.jqm=function(o){var p={overlay:50,closeoverlay:!0,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:F,ajaxText:"",target:F,modal:F,toTop:F,onShow:F,onHide:F,onLoad:F};return this.each(function(){return this._jqm?H[this._jqm].c=$.extend({},H[this._jqm].c,o):(s++,this._jqm=s,H[s]={c:$.extend(p,$.jqm.params,o),a:F,w:$(this).addClass("jqmID"+s),s:s},void(p.trigger&&$(this).jqmAddTrigger(p.trigger)))})},$.fn.jqmAddClose=function(e){return hs(this,e,"jqmHide")},$.fn.jqmAddTrigger=function(e){return hs(this,e,"jqmShow")},$.fn.jqmShow=function(t){return this.each(function(){$.jqm.open(this._jqm,t)})},$.fn.jqmHide=function(t){return this.each(function(){$.jqm.close(this._jqm,t)})},$.jqm={hash:{},open:function(s,t){var h=H[s],c=h.c,cc="."+c.closeClass,z=parseInt(h.w.css("z-index"));z=z>0?z:3e3;var o=$("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":z-1,opacity:c.overlay/100});if(h.a)return F;if(h.t=t,h.a=!0,h.w.css("z-index",z),c.modal?(A[0]||setTimeout(function(){new L("bind")},1),A.push(s)):c.overlay>0?c.closeoverlay&&h.w.jqmAddClose(o):o=F,h.o=o?o.addClass(c.overlayClass).prependTo("body"):F,c.ajax){var r=c.target||h.w,u=c.ajax;r="string"==typeof r?$(r,h.w):$(r),u="@"===u.substr(0,1)?$(t).attr(u.substring(1)):u,r.html(c.ajaxText).load(u,function(){c.onLoad&&c.onLoad.call(this,h),cc&&h.w.jqmAddClose($(cc,h.w)),e(h)})}else cc&&h.w.jqmAddClose($(cc,h.w));return c.toTop&&h.o&&h.w.before('<span id="jqmP'+h.w[0]._jqm+'"></span>').insertAfter(h.o),c.onShow?c.onShow(h):h.w.show(),e(h),F},close:function(s){var h=H[s];return h.a?(h.a=F,A[0]&&(A.pop(),A[0]||new L("unbind")),h.c.toTop&&h.o&&$("#jqmP"+h.w[0]._jqm).after(h.w).remove(),h.c.onHide?h.c.onHide(h):(h.w.hide(),h.o&&h.o.remove()),F):F},params:{}};var s=0,H=$.jqm.hash,A=[],F=!1,e=function(h){f(h)},f=function(h){try{$(":input:visible",h.w)[0].focus()}catch(_){}},L=function(t){$(document)[t]("keypress",m)[t]("keydown",m)[t]("mousedown",m)},m=function(e){var h=H[A[A.length-1]],r=!$(e.target).parents(".jqmID"+h.s)[0];return r&&($(".jqmID"+h.s).each(function(){var $self=$(this),offset=$self.offset();

return offset.top<=e.pageY&&e.pageY<=offset.top+$self.height()&&offset.left<=e.pageX&&e.pageX<=offset.left+$self.width()?(r=!1,!1):void 0}),f(h)),!r},hs=function(w,t,c){return w.each(function(){var s=this._jqm;$(t).each(function(){this[c]||(this[c]=[],$(this).click(function(){for(var i in{jqmShow:1,jqmHide:1})for(var s in this[i])H[this[i][s]]&&H[this[i][s]].w[i](this);return F})),this[c].push(s)})})};$.fmatter={},$.extend($.fmatter,{isBoolean:function(o){return"boolean"==typeof o},isObject:function(o){return o&&("object"==typeof o||$.isFunction(o))||!1},isString:function(o){return"string"==typeof o},isNumber:function(o){return"number"==typeof o&&isFinite(o)},isValue:function(o){return this.isObject(o)||this.isString(o)||this.isNumber(o)||this.isBoolean(o)},isEmpty:function(o){return!this.isString(o)&&this.isValue(o)?!1:this.isValue(o)?(o=$.trim(o).replace(/\&nbsp\;/gi,"").replace(/\&#160\;/gi,""),""===o):!0}}),$.fn.fmatter=function(formatType,cellval,opts,rwd,act){var v=cellval;opts=$.extend({},$.jgrid.getRegional(this,"formatter"),opts);try{v=$.fn.fmatter[formatType].call(this,cellval,opts,rwd,act)}catch(fe){}return v},$.fmatter.util={NumberFormat:function(nData,opts){if($.fmatter.isNumber(nData)||(nData*=1),$.fmatter.isNumber(nData)){var nDotIndex,bNegative=0>nData,sOutput=String(nData),sDecimalSeparator=opts.decimalSeparator||".";if($.fmatter.isNumber(opts.decimalPlaces)){var nDecimalPlaces=opts.decimalPlaces,nDecimal=Math.pow(10,nDecimalPlaces);if(sOutput=String(Math.round(nData*nDecimal)/nDecimal),nDotIndex=sOutput.lastIndexOf("."),nDecimalPlaces>0)for(0>nDotIndex?(sOutput+=sDecimalSeparator,nDotIndex=sOutput.length-1):"."!==sDecimalSeparator&&(sOutput=sOutput.replace(".",sDecimalSeparator));sOutput.length-1-nDotIndex<nDecimalPlaces;)sOutput+="0"}if(opts.thousandsSeparator){var sThousandsSeparator=opts.thousandsSeparator;nDotIndex=sOutput.lastIndexOf(sDecimalSeparator),nDotIndex=nDotIndex>-1?nDotIndex:sOutput.length;var i,sNewOutput=sOutput.substring(nDotIndex),nCount=-1;for(i=nDotIndex;i>0;i--)nCount++,nCount%3===0&&i!==nDotIndex&&(!bNegative||i>1)&&(sNewOutput=sThousandsSeparator+sNewOutput),sNewOutput=sOutput.charAt(i-1)+sNewOutput;sOutput=sNewOutput}return sOutput=opts.prefix?opts.prefix+sOutput:sOutput,sOutput=opts.suffix?sOutput+opts.suffix:sOutput}return nData}},$.fn.fmatter.defaultFormat=function(cellval,opts){return $.fmatter.isValue(cellval)&&""!==cellval?cellval:opts.defaultValue||"&#160;"},$.fn.fmatter.email=function(cellval,opts){return $.fmatter.isEmpty(cellval)?$.fn.fmatter.defaultFormat(cellval,opts):'<a href="mailto:'+cellval+'">'+cellval+"</a>"},$.fn.fmatter.checkbox=function(cval,opts){var ds,op=$.extend({},opts.checkbox);void 0!==opts.colModel&&void 0!==opts.colModel.formatoptions&&(op=$.extend({},op,opts.colModel.formatoptions)),ds=op.disabled===!0?'disabled="disabled"':"",($.fmatter.isEmpty(cval)||void 0===cval)&&(cval=$.fn.fmatter.defaultFormat(cval,op)),cval=String(cval),cval=(cval+"").toLowerCase();var bchk=cval.search(/(false|f|0|no|n|off|undefined)/i)<0?" checked='checked' ":"";return'<input type="checkbox" '+bchk+' value="'+cval+'" offval="no" '+ds+"/>"},$.fn.fmatter.link=function(cellval,opts){var op={target:opts.target},target="";return void 0!==opts.colModel&&void 0!==opts.colModel.formatoptions&&(op=$.extend({},op,opts.colModel.formatoptions)),op.target&&(target="target="+op.target),$.fmatter.isEmpty(cellval)?$.fn.fmatter.defaultFormat(cellval,opts):"<a "+target+' href="'+cellval+'">'+cellval+"</a>"},$.fn.fmatter.showlink=function(cellval,opts){var idUrl,op={baseLinkUrl:opts.baseLinkUrl,showAction:opts.showAction,addParam:opts.addParam||"",target:opts.target,idName:opts.idName},target="";return void 0!==opts.colModel&&void 0!==opts.colModel.formatoptions&&(op=$.extend({},op,opts.colModel.formatoptions)),op.target&&(target="target="+op.target),idUrl=op.baseLinkUrl+op.showAction+"?"+op.idName+"="+opts.rowId+op.addParam,$.fmatter.isString(cellval)||$.fmatter.isNumber(cellval)?"<a "+target+' href="'+idUrl+'">'+cellval+"</a>":$.fn.fmatter.defaultFormat(cellval,opts)},$.fn.fmatter.integer=function(cellval,opts){var op=$.extend({},opts.integer);return void 0!==opts.colModel&&void 0!==opts.colModel.formatoptions&&(op=$.extend({},op,opts.colModel.formatoptions)),$.fmatter.isEmpty(cellval)?op.defaultValue:$.fmatter.util.NumberFormat(cellval,op)},$.fn.fmatter.number=function(cellval,opts){var op=$.extend({},opts.number);return void 0!==opts.colModel&&void 0!==opts.colModel.formatoptions&&(op=$.extend({},op,opts.colModel.formatoptions)),$.fmatter.isEmpty(cellval)?op.defaultValue:$.fmatter.util.NumberFormat(cellval,op)},$.fn.fmatter.currency=function(cellval,opts){var op=$.extend({},opts.currency);return void 0!==opts.colModel&&void 0!==opts.colModel.formatoptions&&(op=$.extend({},op,opts.colModel.formatoptions)),$.fmatter.isEmpty(cellval)?op.defaultValue:$.fmatter.util.NumberFormat(cellval,op)},$.fn.fmatter.date=function(cellval,opts,rwd,act){var op=$.extend({},opts.date);return void 0!==opts.colModel&&void 0!==opts.colModel.formatoptions&&(op=$.extend({},op,opts.colModel.formatoptions)),op.reformatAfterEdit||"edit"!==act?$.fmatter.isEmpty(cellval)?$.fn.fmatter.defaultFormat(cellval,opts):$.jgrid.parseDate.call(this,op.srcformat,cellval,op.newformat,op):$.fn.fmatter.defaultFormat(cellval,opts)},$.fn.fmatter.select=function(cellval,opts){cellval=String(cellval);var sep,delim,oSelect=!1,ret=[];if(void 0!==opts.colModel.formatoptions?(oSelect=opts.colModel.formatoptions.value,sep=void 0===opts.colModel.formatoptions.separator?":":opts.colModel.formatoptions.separator,delim=void 0===opts.colModel.formatoptions.delimiter?";":opts.colModel.formatoptions.delimiter):void 0!==opts.colModel.editoptions&&(oSelect=opts.colModel.editoptions.value,sep=void 0===opts.colModel.editoptions.separator?":":opts.colModel.editoptions.separator,delim=void 0===opts.colModel.editoptions.delimiter?";":opts.colModel.editoptions.delimiter),oSelect){var sv,msl=(null!=opts.colModel.editoptions&&opts.colModel.editoptions.multiple===!0)==!0?!0:!1,scell=[];if(msl&&(scell=cellval.split(","),scell=$.map(scell,function(n){return $.trim(n)})),$.fmatter.isString(oSelect)){var i,so=oSelect.split(delim),j=0;for(i=0;i<so.length;i++)if(sv=so[i].split(sep),sv.length>2&&(sv[1]=$.map(sv,function(n,i){return i>0?n:void 0}).join(sep)),msl)$.inArray(sv[0],scell)>-1&&(ret[j]=sv[1],j++);else if($.trim(sv[0])===$.trim(cellval)){ret[0]=sv[1];break}}else $.fmatter.isObject(oSelect)&&(msl?ret=$.map(scell,function(n){return oSelect[n]}):ret[0]=oSelect[cellval]||"")}return cellval=ret.join(", "),""===cellval?$.fn.fmatter.defaultFormat(cellval,opts):cellval},$.fn.fmatter.rowactions=function(act){var $tr=$(this).closest("tr.jqgrow"),rid=$tr.attr("id"),$id=$(this).closest("table.ui-jqgrid-btable").attr("id").replace(/_frozen([^_]*)$/,"$1"),$grid=$("#"+$id),$t=$grid[0],p=$t.p,cm=p.colModel[$.jgrid.getCellIndex(this)],$actionsDiv=cm.frozen?$("tr#"+rid+" td:eq("+$.jgrid.getCellIndex(this)+") > div",$grid):$(this).parent(),op={extraparam:{}},saverow=function(rowid,res){$.isFunction(op.afterSave)&&op.afterSave.call($t,rowid,res),$actionsDiv.find("div.ui-inline-edit,div.ui-inline-del").show(),$actionsDiv.find("div.ui-inline-save,div.ui-inline-cancel").hide()},restorerow=function(rowid){$.isFunction(op.afterRestore)&&op.afterRestore.call($t,rowid),$actionsDiv.find("div.ui-inline-edit,div.ui-inline-del").show(),$actionsDiv.find("div.ui-inline-save,div.ui-inline-cancel").hide()};void 0!==cm.formatoptions&&(op=$.extend(op,cm.formatoptions)),void 0!==p.editOptions&&(op.editOptions=p.editOptions),void 0!==p.delOptions&&(op.delOptions=p.delOptions),$tr.hasClass("jqgrid-new-row")&&(op.extraparam[p.prmNames.oper]=p.prmNames.addoper);var actop={keys:op.keys,oneditfunc:op.onEdit,successfunc:op.onSuccess,url:op.url,extraparam:op.extraparam,aftersavefunc:saverow,errorfunc:op.onError,afterrestorefunc:restorerow,restoreAfterError:op.restoreAfterError,mtype:op.mtype};switch(act){case"edit":$grid.jqGrid("editRow",rid,actop),$actionsDiv.find("div.ui-inline-edit,div.ui-inline-del").hide(),$actionsDiv.find("div.ui-inline-save,div.ui-inline-cancel").show(),$grid.triggerHandler("jqGridAfterGridComplete");break;case"save":$grid.jqGrid("saveRow",rid,actop)&&($actionsDiv.find("div.ui-inline-edit,div.ui-inline-del").show(),$actionsDiv.find("div.ui-inline-save,div.ui-inline-cancel").hide(),$grid.triggerHandler("jqGridAfterGridComplete"));break;case"cancel":$grid.jqGrid("restoreRow",rid,restorerow),$actionsDiv.find("div.ui-inline-edit,div.ui-inline-del").show(),$actionsDiv.find("div.ui-inline-save,div.ui-inline-cancel").hide(),$grid.triggerHandler("jqGridAfterGridComplete");break;case"del":$grid.jqGrid("delGridRow",rid,op.delOptions);break;case"formedit":$grid.jqGrid("setSelection",rid),$grid.jqGrid("editGridRow",rid,op.editOptions)}},$.fn.fmatter.actions=function(cellval,opts){var ocl,op={keys:!1,editbutton:!0,delbutton:!0,editformbutton:!1},rowid=opts.rowId,str="",nav=$.jgrid.getRegional(this,"nav");return void 0!==opts.colModel.formatoptions&&(op=$.extend(op,opts.colModel.formatoptions)),void 0===rowid||$.fmatter.isEmpty(rowid)?"":(op.editformbutton?(ocl="id='jEditButton_"+rowid+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'formedit'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ",str+="<div title='"+nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+ocl+"><span class='ui-icon ui-icon-pencil'></span></div>"):op.editbutton&&(ocl="id='jEditButton_"+rowid+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'edit'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ",str+="<div title='"+nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+ocl+"><span class='ui-icon ui-icon-pencil'></span></div>"),op.delbutton&&(ocl="id='jDeleteButton_"+rowid+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'del'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ",str+="<div title='"+nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+ocl+"><span class='ui-icon ui-icon-trash'></span></div>"),ocl="id='jSaveButton_"+rowid+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'save'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ",str+="<div title='"+nav.savetitle+"' style='float:left;display:none' class='ui-pg-div ui-inline-save' "+ocl+"><span class='ui-icon ui-icon-disk'></span></div>",ocl="id='jCancelButton_"+rowid+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'cancel'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ",str+="<div title='"+nav.canceltitle+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel' "+ocl+"><span class='ui-icon ui-icon-cancel'></span></div>","<div style='margin-left:8px;'>"+str+"</div>")},$.unformat=function(cellval,options,pos,cnt){var ret,sep,formatType=options.colModel.formatter,op=options.colModel.formatoptions||{},re=/([\.\*\_\'\(\)\{\}\+\?\\])/g,unformatFunc=options.colModel.unformat||$.fn.fmatter[formatType]&&$.fn.fmatter[formatType].unformat;if(void 0!==unformatFunc&&$.isFunction(unformatFunc))ret=unformatFunc.call(this,$(cellval).text(),options,cellval);else if(void 0!==formatType&&$.fmatter.isString(formatType)){var stripTag,opts=$.jgrid.getRegional(this,"formatter")||{};switch(formatType){case"integer":op=$.extend({},opts.integer,op),sep=op.thousandsSeparator.replace(re,"\\$1"),stripTag=new RegExp(sep,"g"),ret=$(cellval).text().replace(stripTag,"");break;case"number":op=$.extend({},opts.number,op),sep=op.thousandsSeparator.replace(re,"\\$1"),stripTag=new RegExp(sep,"g"),ret=$(cellval).text().replace(stripTag,"").replace(op.decimalSeparator,".");break;case"currency":op=$.extend({},opts.currency,op),sep=op.thousandsSeparator.replace(re,"\\$1"),stripTag=new RegExp(sep,"g"),ret=$(cellval).text(),op.prefix&&op.prefix.length&&(ret=ret.substr(op.prefix.length)),op.suffix&&op.suffix.length&&(ret=ret.substr(0,ret.length-op.suffix.length)),ret=ret.replace(stripTag,"").replace(op.decimalSeparator,".");break;case"checkbox":var cbv=options.colModel.editoptions?options.colModel.editoptions.value.split(":"):["Yes","No"];ret=$("input",cellval).is(":checked")?cbv[0]:cbv[1];break;case"select":ret=$.unformat.select(cellval,options,pos,cnt);break;case"actions":return"";default:ret=$(cellval).text()}}return void 0!==ret?ret:cnt===!0?$(cellval).text():$.jgrid.htmlDecode($(cellval).html())},$.unformat.select=function(cellval,options,pos,cnt){var ret=[],cell=$(cellval).text();if(cnt===!0)return cell;var op=$.extend({},void 0!==options.colModel.formatoptions?options.colModel.formatoptions:options.colModel.editoptions),sep=void 0===op.separator?":":op.separator,delim=void 0===op.delimiter?";":op.delimiter;if(op.value){var sv,oSelect=op.value,msl=op.multiple===!0?!0:!1,scell=[];if(msl&&(scell=cell.split(","),scell=$.map(scell,function(n){return $.trim(n)})),$.fmatter.isString(oSelect)){var i,so=oSelect.split(delim),j=0;for(i=0;i<so.length;i++)if(sv=so[i].split(sep),sv.length>2&&(sv[1]=$.map(sv,function(n,i){return i>0?n:void 0}).join(sep)),msl)$.inArray($.trim(sv[1]),scell)>-1&&(ret[j]=sv[0],j++);else if($.trim(sv[1])===$.trim(cell)){ret[0]=sv[0];break}}else($.fmatter.isObject(oSelect)||$.isArray(oSelect))&&(msl||(scell[0]=cell),ret=$.map(scell,function(n){var rv;return $.each(oSelect,function(i,val){return val===n?(rv=i,!1):void 0}),void 0!==rv?rv:void 0}));return ret.join(", ")}return cell||""},$.unformat.date=function(cellval,opts){var op=$.jgrid.getRegional(this,"formatter.date")||{};return void 0!==opts.formatoptions&&(op=$.extend({},op,opts.formatoptions)),$.fmatter.isEmpty(cellval)?$.fn.fmatter.defaultFormat(cellval,opts):$.jgrid.parseDate.call(this,op.newformat,cellval,op.srcformat,op)},window.jqGridUtils={stringify:function(obj){return JSON.stringify(obj,function(key,value){return"function"==typeof value?value.toString():value})},parse:function(str){return JSON.parse(str,function(key,value){return"string"==typeof value&&-1!==value.indexOf("function")?eval("("+value+")"):value})},encode:function(text){return String(text).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},jsonToXML:function(tree,options){var o=$.extend({xmlDecl:'<?xml version="1.0" encoding="UTF-8" ?>\n',attr_prefix:"-",encode:!0},options||{}),that=this,scalarToxml=function(name,text){return"#text"===name?o.encode?that.encode(text):text:"function"==typeof text?"<"+name+"><![CDATA["+text+"]]></"+name+">\n":""===text?"<"+name+">__EMPTY_STRING_</"+name+">\n":"<"+name+">"+(o.encode?that.encode(text):text)+"</"+name+">\n"},arrayToxml=function(name,array){for(var out=[],i=0;i<array.length;i++){var val=array[i];"undefined"==typeof val||null==val?out[out.length]="<"+name+" />":"object"==typeof val&&val.constructor==Array?out[out.length]=arrayToxml(name,val):"object"==typeof val?out[out.length]=hashToxml(name,val):out[out.length]=scalarToxml(name,val)}return out.length||(out[0]="<"+name+">__EMPTY_ARRAY_</"+name+">\n"),out.join("")},hashToxml=function(name,tree){var elem=[],attr=[];for(var key in tree)if(tree.hasOwnProperty(key)){var val=tree[key];key.charAt(0)!==o.attr_prefix?null==val?elem[elem.length]="<"+key+" />":"object"==typeof val&&val.constructor===Array?elem[elem.length]=arrayToxml(key,val):"object"==typeof val?elem[elem.length]=hashToxml(key,val):elem[elem.length]=scalarToxml(key,val):attr[attr.length]=" "+key.substring(1)+'="'+(o.encode?that.encode(val):val)+'"'}var jattr=attr.join(""),jelem=elem.join("");return null==name||(jelem=elem.length>0?jelem.match(/\n/)?"<"+name+jattr+">\n"+jelem+"</"+name+">\n":"<"+name+jattr+">"+jelem+"</"+name+">\n":"<"+name+jattr+" />\n"),jelem},xml=hashToxml(null,tree);return o.xmlDecl+xml},xmlToJSON:function(root,options){var o=$.extend({force_array:[],attr_prefix:"-"},options||{});if(root){var __force_array={};if(o.force_array)for(var i=0;i<o.force_array.length;i++)__force_array[o.force_array[i]]=1;"string"==typeof root&&(root=$.parseXML(root)),root.documentElement&&(root=root.documentElement);var addNode=function(hash,key,cnts,val){if("string"==typeof val)if(-1!==val.indexOf("function"))val=eval("("+val+")");else switch(val){case"__EMPTY_ARRAY_":val=[];break;case"__EMPTY_STRING_":val="";break;case"false":val=!1;break;case"true":val=!0}__force_array[key]?(1===cnts&&(hash[key]=[]),hash[key][hash[key].length]=val):1===cnts?hash[key]=val:2===cnts?hash[key]=[hash[key],val]:hash[key][hash[key].length]=val},parseElement=function(elem){if(7!==elem.nodeType){if(3===elem.nodeType||4===elem.nodeType){var bool=elem.nodeValue.match(/[^\x00-\x20]/);if(null==bool)return;return elem.nodeValue}var retval,i,key,val,cnt={};if(elem.attributes&&elem.attributes.length)for(retval={},i=0;i<elem.attributes.length;i++)key=elem.attributes[i].nodeName,"string"==typeof key&&(val=elem.attributes[i].nodeValue,val&&(key=o.attr_prefix+key,"undefined"==typeof cnt[key]&&(cnt[key]=0),cnt[key]++,addNode(retval,key,cnt[key],val)));if(elem.childNodes&&elem.childNodes.length){var textonly=!0;for(retval&&(textonly=!1),i=0;i<elem.childNodes.length&&textonly;i++){var ntype=elem.childNodes[i].nodeType;3!==ntype&&4!==ntype&&(textonly=!1)}if(textonly)for(retval||(retval=""),i=0;i<elem.childNodes.length;i++)retval+=elem.childNodes[i].nodeValue;else for(retval||(retval={}),i=0;i<elem.childNodes.length;i++)key=elem.childNodes[i].nodeName,"string"==typeof key&&(val=parseElement(elem.childNodes[i]),val&&("undefined"==typeof cnt[key]&&(cnt[key]=0),cnt[key]++,addNode(retval,key,cnt[key],val)))}return retval}},json=parseElement(root);if(__force_array[root.nodeName]&&(json=[json]),11!==root.nodeType){var tmp={};tmp[root.nodeName]=json,json=tmp}return json}}}});